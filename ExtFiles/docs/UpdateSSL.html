<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>1С:Библиотека стандартных подсистем, редакция 3.1. Новое в версиях</title>
  <style>
    /*! normalize.css v2.1.3 | MIT License | git.io/normalize */

    /* ==========================================================================
       HTML5 display definitions
       ========================================================================== */

    /**
     * Correct `block` display not defined in IE 8/9.
     */

    article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary {
        display: block;
    }

    /**
     * Correct `inline-block` display not defined in IE 8/9.
     */

    audio, canvas, video {
        display: inline-block;
    }

    /**
     * Prevent modern browsers from displaying `audio` without controls.
     * Remove excess height in iOS 5 devices.
     */

    audio:not([controls]) {
        display: none;
        height: 0;
    }

    /**
     * Address `[hidden]` styling not present in IE 8/9.
     * Hide the `template` element in IE, Safari, and Firefox < 22.
     */

    [hidden], template {
        display: none;
    }

    /* ==========================================================================
       Base
       ========================================================================== */

    /**
     * 1. Set default font family to sans-serif.
     * 2. Prevent iOS text size adjust after orientation change, without disabling
     *    user zoom.
     */

    html {
        font-family: sans-serif;
        /* 1 */
        -ms-text-size-adjust: 100%;
        /* 2 */
        -webkit-text-size-adjust: 100%;
        /* 2 */
    }

    /**
     * Remove default margin.
     */

    body {
        margin: 0;
    }

    /* ==========================================================================
       Links
       ========================================================================== */

    /**
     * Remove the gray background color from active links in IE 10.
     */

    a {
        background: transparent;
    }

    /**
     * Address `outline` inconsistency between Chrome and other browsers.
     */

    a:focus {
        outline: thin dotted;
    }

    /**
     * Improve readability when focused and also mouse hovered in all browsers.
     */

    a:active, a:hover {
        outline: 0;
    }

    /* ==========================================================================
       Typography
       ========================================================================== */

    /**
     * Address variable `h1` font-size and margin within `section` and `article`
     * contexts in Firefox 4+, Safari 5, and Chrome.
     */

    h1 {
        font-size: 2em;
        margin: 0.67em 0;
    }

    /**
     * Address styling not present in IE 8/9, Safari 5, and Chrome.
     */

    abbr[title] {
        border-bottom: 1px dotted;
    }

    /**
     * Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome.
     */

    b, strong {
        font-weight: bold;
    }

    /**
     * Address styling not present in Safari 5 and Chrome.
     */

    dfn {
        font-style: italic;
    }

    /**
     * Address differences between Firefox and other browsers.
     */

    hr {
        -moz-box-sizing: content-box;
        box-sizing: content-box;
        height: 0;
    }

    /**
     * Address styling not present in IE 8/9.
     */

    mark {
        background: #ff0;
        color: #000;
    }

    /**
     * Correct font family set oddly in Safari 5 and Chrome.
     */

    code, kbd, pre, samp {
        font-family: monospace, serif;
        font-size: 1em;
    }

    /**
     * Improve readability of pre-formatted text in all browsers.
     */

    pre {
        white-space: pre-wrap;
    }

    /**
     * Set consistent quote types.
     */

    q {
        quotes: "\201C" "\201D" "\2018" "\2019";
    }

    /**
     * Address inconsistent and variable font size in all browsers.
     */

    small {
        font-size: 80%;
    }

    /**
     * Prevent `sub` and `sup` affecting `line-height` in all browsers.
     */

    sub, sup {
        font-size: 75%;
        line-height: 0;
        position: relative;
        vertical-align: baseline;
    }

    sup {
        top: -0.5em;
    }

    sub {
        bottom: -0.25em;
    }

    /* ==========================================================================
       Embedded content
       ========================================================================== */

    /**
     * Remove border when inside `a` element in IE 8/9.
     */

    img {
        border: 0;
    }

    /**
     * Correct overflow displayed oddly in IE 9.
     */

    svg:not(:root) {
        overflow: hidden;
    }

    /* ==========================================================================
       Figures
       ========================================================================== */

    /**
     * Address margin not present in IE 8/9 and Safari 5.
     */

    figure {
        margin: 0;
    }

    /* ==========================================================================
       Forms
       ========================================================================== */

    /**
     * Define consistent border, margin, and padding.
     */

    fieldset {
        border: 1px solid #c0c0c0;
        margin: 0 2px;
        padding: 0.35em 0.625em 0.75em;
    }

    /**
     * 1. Correct `color` not being inherited in IE 8/9.
     * 2. Remove padding so people aren't caught out if they zero out fieldsets.
     */

    legend {
        border: 0;
        /* 1 */
        padding: 0;
        /* 2 */
    }

    /**
     * 1. Correct font family not being inherited in all browsers.
     * 2. Correct font size not being inherited in all browsers.
     * 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome.
     */

    button, input, select, textarea {
        font-family: inherit;
        /* 1 */
        font-size: 100%;
        /* 2 */
        margin: 0;
        /* 3 */
    }

    /**
     * Address Firefox 4+ setting `line-height` on `input` using `!important` in
     * the UA stylesheet.
     */

    button, input {
        line-height: normal;
    }

    /**
     * Address inconsistent `text-transform` inheritance for `button` and `select`.
     * All other form control elements do not inherit `text-transform` values.
     * Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+.
     * Correct `select` style inheritance in Firefox 4+ and Opera.
     */

    button, select {
        text-transform: none;
    }

    /**
     * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
     *    and `video` controls.
     * 2. Correct inability to style clickable `input` types in iOS.
     * 3. Improve usability and consistency of cursor style between image-type
     *    `input` and others.
     */

    button, html input[type="button"],
    /* 1 */

    input[type="reset"], input[type="submit"] {
        -webkit-appearance: button;
        /* 2 */
        cursor: pointer;
        /* 3 */
    }

    /**
     * Re-set default cursor for disabled elements.
     */

    button[disabled], html input[disabled] {
        cursor: default;
    }

    /**
     * 1. Address box sizing set to `content-box` in IE 8/9/10.
     * 2. Remove excess padding in IE 8/9/10.
     */

    input[type="checkbox"], input[type="radio"] {
        box-sizing: border-box;
        /* 1 */
        padding: 0;
        /* 2 */
    }

    /**
     * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
     * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
     *    (include `-moz` to future-proof).
     */

    input[type="search"] {
        -webkit-appearance: textfield;
        /* 1 */
        -moz-box-sizing: content-box;
        -webkit-box-sizing: content-box;
        /* 2 */
        box-sizing: content-box;
    }

    /**
     * Remove inner padding and search cancel button in Safari 5 and Chrome
     * on OS X.
     */

    input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration {
        -webkit-appearance: none;
    }

    /**
     * Remove inner padding and border in Firefox 4+.
     */

    button::-moz-focus-inner, input::-moz-focus-inner {
        border: 0;
        padding: 0;
    }

    /**
     * 1. Remove default vertical scrollbar in IE 8/9.
     * 2. Improve readability and alignment in all browsers.
     */

    textarea {
        overflow: auto;
        /* 1 */
        vertical-align: top;
        /* 2 */
    }

    /* ==========================================================================
       Tables
       ========================================================================== */

    /**
     * Remove most spacing between table cells.
     */

    table {
        border-collapse: collapse;
        border-spacing: 0;
    }

    .go-top {
        position: fixed;
        bottom: 2em;
        right: 2em;
        text-decoration: none;
        background-color: #E0E0E0;
        font-size: 12px;
        padding: 1em;
        display: inline;
    }

    /* Github css */

    html, body {
        margin: auto;
        padding-right: 1em;
        padding-left: 1em;
        max-width: 100%;
        color: black;
    }

    *:not('#mkdbuttons') {
        margin: 0;
        padding: 0
    }

    body {
        font: 13.34px helvetica, arial, freesans, clean, sans-serif;
        -webkit-font-smoothing: subpixel-antialiased;
        line-height: 1.4;
        padding: 3px;
        background: #fff;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px
    }

    p {
        margin: 1em 0
    }

    a {
        color: #4183c4;
        text-decoration: none
    }

    body {
        background-color: #fff;
        padding: 30px;
        margin: 15px;
        font-size: 14px;
        line-height: 1.6
    }

    body>*:first-child {
        margin-top: 0!important
    }

    body>*:last-child {
        margin-bottom: 0!important
    }


    h1, h2, h3, h4, h5, h6 {
        margin: 20px 0 10px;
        padding: 0;
        font-weight: bold;
        -webkit-font-smoothing: subpixel-antialiased;
        cursor: text
    }

    h1 {
        font-size: 28px;
        color: #000
    }

    h2 {
        font-size: 24px;
        border-bottom: 1px solid #ccc;
        color: #000
    }

    h3 {
        font-size: 18px;
        color: #333
    }

    h4 {
        font-size: 16px;
        color: #333
    }

    h5 {
        font-size: 14px;
        color: #333
    }

    h6 {
        color: #777;
        font-size: 14px
    }

    p, blockquote, table, pre {
        margin: 15px 0
    }

    ul {
        padding-left: 30px
    }

    ol {
        padding-left: 30px
    }

    ol li ul:first-of-type {
        margin-top: 0
    }

    hr {
        background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
        border: 0 none;
        color: #ccc;
        height: 4px;
        padding: 0
    }

    body>h2:first-child {
        margin-top: 0;
        padding-top: 0
    }

    body>h1:first-child {
        margin-top: 0;
        padding-top: 0
    }

    body>h1:first-child+h2 {
        margin-top: 0;
        padding-top: 0
    }

    body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
        margin-top: 0;
        padding-top: 0
    }

    a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
        margin-top: 0;
        padding-top: 0
    }

    h1+p, h2+p, h3+p, h4+p, h5+p, h6+p, ul li>:first-child, ol li>:first-child {
        margin-top: 0
    }

    dl {
        padding: 0
    }

    dl dt {
        font-size: 14px;
        font-weight: bold;
        font-style: italic;
        padding: 0;
        margin: 15px 0 5px
    }

    dl dt:first-child {
        padding: 0
    }

    dl dt>:first-child {
        margin-top: 0
    }

    dl dt>:last-child {
        margin-bottom: 0
    }

    dl dd {
        margin: 0 0 15px;
        padding: 0 15px
    }

    dl dd>:first-child {
        margin-top: 0
    }

    dl dd>:last-child {
        margin-bottom: 0
    }

    blockquote {
        border-left: 4px solid #DDD;
        padding: 0 15px;
        color: #777
    }

    blockquote>:first-child {
        margin-top: 0
    }

    blockquote>:last-child {
        margin-bottom: 0
    }

    table {
        border-collapse: collapse;
        border-spacing: 0;
        font-size: 100%;
        font: inherit
    }

    table th {
        font-weight: bold;
        border: 1px solid #ccc;
        padding: 6px 13px
    }

    table td {
        border: 1px solid #ccc;
        padding: 6px 13px
    }

    table tr {
        border-top: 1px solid #ccc;
        background-color: #fff
    }

    table tr:nth-child(2n) {
        background-color: #f8f8f8
    }

    img {
        max-width: 100%
    }

    code, tt {
        margin: 0 2px;
        padding: 0 5px;
        white-space: nowrap;
        border: 1px solid #eaeaea;
        background-color: #f8f8f8;
        border-radius: 3px;
        font-family: Consolas, 'Liberation Mono', Courier, monospace;
        font-size: 12px;
        color: #333
    }

    pre>code {
        margin: 0;
        padding: 0;
        white-space: pre;
        border: 0;
        background: transparent
    }

    .highlight pre {
        background-color: #f8f8f8;
        border: 1px solid #ccc;
        font-size: 13px;
        line-height: 19px;
        overflow: auto;
        padding: 6px 10px;
        border-radius: 3px
    }

    pre {
        background-color: #f8f8f8;
        border: 1px solid #ccc;
        font-size: 13px;
        line-height: 19px;
        overflow: auto;
        padding: 6px 10px;
        border-radius: 3px
    }

    pre code, pre tt {
        background-color: transparent;
        border: 0
    }

    .poetry pre {
        font-family: Georgia, Garamond, serif!important;
        font-style: italic;
        font-size: 110%!important;
        line-height: 1.6em;
        display: block;
        margin-left: 1em
    }

    .poetry pre code {
        font-family: Georgia, Garamond, serif!important;
        word-break: break-all;
        word-break: break-word;
        -webkit-hyphens: auto;
        -moz-hyphens: auto;
        hyphens: auto;
        white-space: pre-wrap
    }

    sup, sub, a.footnote {
        font-size: 1.4ex;
        height: 0;
        line-height: 1;
        vertical-align: super;
        position: relative
    }

    sub {
        vertical-align: sub;
        top: -1px
    }

    @media print {
        body {
            background: #fff
        }
        img, pre, blockquote, table, figure {
            page-break-inside: avoid
        }
        body {
            background: #fff;
            border: 0
        }
        code {
            background-color: #fff;
            color: #333!important;
            padding: 0 .2em;
            border: 1px solid #dedede
        }
        pre {
            background: #fff
        }
        pre code {
            background-color: white!important;
            overflow: visible
        }
    }

    @media screen {
        body.inverted {
            color: #eee!important;
            border-color: #555;
            box-shadow: none
        }
        .inverted body, .inverted hr .inverted p, .inverted td, .inverted li, .inverted h1, .inverted h2, .inverted h3, .inverted h4, .inverted h5, .inverted h6, .inverted th, .inverted .math, .inverted caption, .inverted dd, .inverted dt, .inverted blockquote {
            color: #eee!important;
            border-color: #555;
            box-shadow: none
        }
        .inverted td, .inverted th {
            background: #333
        }
        .inverted h2 {
            border-color: #555
        }
        .inverted hr {
            border-color: #777;
            border-width: 1px!important
        }
        ::selection {
            background: rgba(157, 193, 200, 0.5)
        }
        h1::selection {
            background-color: rgba(45, 156, 208, 0.3)
        }
        h2::selection {
            background-color: rgba(90, 182, 224, 0.3)
        }
        h3::selection, h4::selection, h5::selection, h6::selection, li::selection, ol::selection {
            background-color: rgba(133, 201, 232, 0.3)
        }
        code::selection {
            background-color: rgba(0, 0, 0, 0.7);
            color: #eee
        }
        code span::selection {
            background-color: rgba(0, 0, 0, 0.7)!important;
            color: #eee!important
        }
        a::selection {
            background-color: rgba(255, 230, 102, 0.2)
        }
        .inverted a::selection {
            background-color: rgba(255, 230, 102, 0.6)
        }
        td::selection, th::selection, caption::selection {
            background-color: rgba(180, 237, 95, 0.5)
        }
        .inverted {
            background: #0b2531;
            background: #252a2a
        }
        .inverted body {
            background: #252a2a
        }
        .inverted a {
            color: #acd1d5
        }
    }

    .highlight .c {
        color: #998;
        font-style: italic
    }

    .highlight .err {
        color: #a61717;
        background-color: #e3d2d2
    }

    .highlight .k, .highlight .o {
        font-weight: bold
    }

    .highlight .cm {
        color: #998;
        font-style: italic
    }

    .highlight .cp {
        color: #999;
        font-weight: bold
    }

    .highlight .c1 {
        color: #998;
        font-style: italic
    }

    .highlight .cs {
        color: #999;
        font-weight: bold;
        font-style: italic
    }

    .highlight .gd {
        color: #000;
        background-color: #fdd
    }

    .highlight .gd .x {
        color: #000;
        background-color: #faa
    }

    .highlight .ge {
        font-style: italic
    }

    .highlight .gr {
        color: #a00
    }

    .highlight .gh {
        color: #999
    }

    .highlight .gi {
        color: #000;
        background-color: #dfd
    }

    .highlight .gi .x {
        color: #000;
        background-color: #afa
    }

    .highlight .go {
        color: #888
    }

    .highlight .gp {
        color: #555
    }

    .highlight .gs {
        font-weight: bold
    }

    .highlight .gu {
        color: #800080;
        font-weight: bold
    }

    .highlight .gt {
        color: #a00
    }

    .highlight .kc, .highlight .kd, .highlight .kn, .highlight .kp, .highlight .kr {
        font-weight: bold
    }

    .highlight .kt {
        color: #458;
        font-weight: bold
    }

    .highlight .m {
        color: #099
    }

    .highlight .s {
        color: #d14
    }

    .highlight .na {
        color: #008080
    }

    .highlight .nb {
        color: #0086b3
    }

    .highlight .nc {
        color: #458;
        font-weight: bold
    }

    .highlight .no {
        color: #008080
    }

    .highlight .ni {
        color: #800080
    }

    .highlight .ne, .highlight .nf {
        color: #900;
        font-weight: bold
    }

    .highlight .nn {
        color: #555
    }

    .highlight .nt {
        color: #000080
    }

    .highlight .nv {
        color: #008080
    }

    .highlight .ow {
        font-weight: bold
    }

    .highlight .w {
        color: #bbb
    }

    .highlight .mf, .highlight .mh, .highlight .mi, .highlight .mo {
        color: #099
    }

    .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .se, .highlight .sh, .highlight .si, .highlight .sx {
        color: #d14
    }

    .highlight .sr {
        color: #009926
    }

    .highlight .s1 {
        color: #d14
    }

    .highlight .ss {
        color: #990073
    }

    .highlight .bp {
        color: #999
    }

    .highlight .vc, .highlight .vg, .highlight .vi {
        color: #008080
    }

    .highlight .il {
        color: #099
    }

    .highlight .gc {
        color: #999;
        background-color: #eaf2f5
    }

    .type-csharp .highlight .k, .type-csharp .highlight .kt {
        color: #00F
    }

    .type-csharp .highlight .nf {
        color: #000;
        font-weight: normal
    }

    .type-csharp .highlight .nc {
        color: #2b91af
    }

    .type-csharp .highlight .nn {
        color: #000
    }

    .type-csharp .highlight .s, .type-csharp .highlight .sc {
        color: #a31515
    }  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">1С:Библиотека стандартных подсистем, редакция 3.1. Новое в версиях</h1>
</header>
<!--ОглавлениеНачало-->
<p><a href="#версия-3.1.7">Версия 3.1.7</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.7">Новые возможности и изменения в версии 3.1.7</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.7">Новые возможности для разработчиков в версии 3.1.7</a></li>
<li><a href="#переход-на-версию-3.1.7-с-версии-3.1.6">Переход на версию 3.1.7 с версии 3.1.6</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.7">Особенности обновления с ранних версий на версию 3.1.7</a></li>
<li><a href="#переход-на-исправительные-релизы-3.1.7">Переход на исправительные релизы 3.1.7</a></li>
</ul>
<p><a href="#версия-3.1.6">Версия 3.1.6</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.6">Новые возможности и изменения в версии 3.1.6</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.6">Новые возможности для разработчиков в версии 3.1.6</a></li>
<li><a href="#переход-на-версию-3.1.6-с-версии-3.1.5">Переход на версию 3.1.6 с версии 3.1.5</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.6">Особенности обновления с ранних версий на версию 3.1.6</a></li>
<li><a href="#переход-на-исправительные-релизы-3.1.6">Переход на исправительные релизы 3.1.6</a></li>
</ul>
<p><a href="#версия-3.1.5">Версия 3.1.5</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.5">Новые возможности и изменения в версии 3.1.5</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.5">Новые возможности для разработчиков в версии 3.1.5</a></li>
<li><a href="#переход-на-версию-3.1.5-с-версии-3.1.4">Переход на версию 3.1.5 с версии 3.1.4</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.5">Особенности обновления с ранних версий на версию 3.1.5</a></li>
</ul>
<p><a href="#версия-3.1.4">Версия 3.1.4</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.4">Новые возможности и изменения в версии 3.1.4</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.4">Новые возможности для разработчиков в версии 3.1.4</a></li>
<li><a href="#переход-на-версию-3.1.4-с-версии-3.1.3">Переход на версию 3.1.4 с версии 3.1.3</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.4">Особенности обновления с ранних версий на версию 3.1.4</a></li>
</ul>
<p><a href="#версия-3.1.3">Версия 3.1.3</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.3">Новые возможности и изменения в версии 3.1.3</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.3">Новые возможности для разработчиков в версии 3.1.3</a></li>
<li><a href="#переход-на-версию-3.1.3-с-версии-3.1.2">Переход на версию 3.1.3 с версии 3.1.2</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.3">Особенности обновления с ранних версий на версию 3.1.3</a></li>
</ul>
<p><a href="#версия-3.1.2">Версия 3.1.2</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.2">Новые возможности и изменения в версии 3.1.2</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.2">Новые возможности для разработчиков в версии 3.1.2</a></li>
<li><a href="#переход-на-версию-3.1.2-с-версии-3.1.1">Переход на версию 3.1.2 с версии 3.1.1</a></li>
<li><a href="#переход-на-исправительные-релизы-3.1.2">Переход на исправительные релизы 3.1.2</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.2">Особенности обновления с ранних версий на версию 3.1.3</a></li>
</ul>
<p><a href="#версия-311">Версия 3.1.1</a></p>
<ul>
<li><a href="#новые-возможности-и-изменения-в-версии-3.1.1">Новые возможности и изменения в версии 3.1.1</a></li>
<li><a href="#новые-возможности-для-разработчиков-в-версии-3.1.1">Новые возможности для разработчиков в версии 3.1.1</a></li>
<li><a href="#переход-на-версию-3.1.1-с-версии-3.0.3">Переход на версию 3.1.1 с версии 3.0.3</a></li>
<li><a href="#переход-на-исправительные-релизы-3.1.1">Переход на исправительные релизы 3.1.1</a></li>
<li><a href="#особенности-обновления-с-ранних-версий-на-версию-3.1.1">Особенности обновления с ранних версий на версию 3.1.1</a></li>
</ul>
<!--ОглавлениеКонец-->
<h2 id="версия-3.1.7">Версия 3.1.7</h2>
<p>Версия 3.1.7 предназначена для разработки на платформе <strong>1С:Предприятие</strong> 8.3.17 и выше. Доступны режимы совместимости с <code>Версия 8.3.14</code> по <code>Версия 8.3.21</code> включительно.</p>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.7</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.7">Новые возможности и изменения в версии 3.1.7</h3>
<h4 id="базовая-функциональность">Базовая функциональность</h4>
<ul>
<li>Теперь любые длительные операции завершаются оперативнее, а программа становится более отзывчивой при подключенных обсуждениях (система взаимодействий). Например, это заметно при формировании отчетов, загрузке или выгрузке данных и т.п.</li>
</ul>
<h4 id="пользователи">Пользователи</h4>
<ul>
<li>При изменении прав доступа выводится оповещение с предложением перезапустить программу, чтобы эти изменения вступили в силу.</li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.7">Новые возможности для разработчиков в версии 3.1.7</h3>
<h4 id="базовая-функциональность-1">Базовая функциональность</h4>
<ul>
<li>Для сокращения количества периодических серверных вызовов вместо обработчиков ожидания рекомендуется использовать механизмы серверных оповещений и длительных операций. В клиент-серверном режиме работы это позволяет существенно разгрузить сервер <strong>1С:Предприятия</strong> он нагрузки, создаваемой периодическими клиентскими обработчиками ожидания, которые запрашивают данные с сервера или отправляют их на сервер. В случае если в информационной базе подключены обсуждения (система взаимодействий), то клиентские сеансы получают события с сервера незамедлительно без дополнительных серверных вызовов. Если обсуждения отключены, то балансировка нагрузки на сервер выполняется с помощью единого глобального обработчика ожидания.
<ul>
<li>Для обработки на клиенте серверных оповещений необходимо зарегистрировать свое серверное оповещение в процедуре <code>ПриДобавленииСерверныхОповещений</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code> и реализовать обработчики его отправки и получения. См. примеры в демонстрационной конфигурации.</li>
<li>Для периодической отправки данных с клиента на сервер реализовать отправку в процедуре <code>ПередПериодическойОтправкойДанныхКлиентаНаСервер</code> общего модуля <code>ОбщегоНазначенияКлиентПереопределяемый</code> и их обработку в процедурах <code>ПриПериодическомПолученииДанныхКлиентаНаСервере</code> или <code>ПослеПериодическогоПолученияДанныхКлиентаНаСервере</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>. См. примеры в демонстрационной конфигурации.</li>
<li>Кроме того, рекомендуется заменить собственные обработчики ожидания проверки длительных операций на процедуру <code>ОжидатьЗавершение</code> общего модуля <code>ДлительныеОперацииКлиент</code>, а также заменить объект платформы <code>СообщениеПользователю</code> в процедурах длительных операций на процедуру <code>СообщитьПользователю</code> общего модуля <code>ОбщегоНазначения</code>. В случае если в информационной базе подключены обсуждения (система взаимодействий), то с их помощью можно более оперативно доставлять на клиент информацию о прогрессе и сообщения, которые отправляются из фонового задания.</li>
</ul></li>
<li>Больше не требуется фильтровать сообщения пользователя из фоновых заданий длительных операций от служебного текста прогресса с помощью функции <code>СообщенияПользователю</code> общего модуля <code>ДлительныеОперации</code>. Процедура <code>СообщитьПрогресс</code> общего модуля <code>ДлительныеОперации</code> больше не отправляет прогресс через сообщения пользователю, а переведена на механизм серверных оповещений.</li>
</ul>
<h3 id="переход-на-версию-3.1.7-с-версии-3.1.6">Переход на версию 3.1.7 с версии 3.1.6</h3>
<h4 id="обязательные-действия-по-переходу">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения (см. <a href="https://its.1c.ru/db/bspdoc">главу 2 Инструкция по внедрению библиотеки</a>).</p>
<p>Для обновления следующих переопределяемых общих модулей требуется перенести из поставки библиотеки новые экспортные процедуры, удалить отсутствующие и убедиться, что комментарии, количество и имена параметров у процедур совпадают с поставкой библиотеки:</p>
<ul>
<li><code>ОбщегоНазначенияКлиентПереопределяемый</code>,</li>
<li><code>ОбщегоНазначенияПереопределяемый</code>,</li>
<li><code>РассылкаОтчетовПереопределяемый</code>,</li>
<li><code>ТекущиеДелаПереопределяемый</code>.</li>
</ul>
<p>Рекомендации по задействованию новых возможностей переопределяемых общих модулей приведены выше в разделе <strong>Новые возможности для разработчиков</strong>.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки. В исключительных (редких) случаях, когда такая совместимость не обеспечена, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки, в этом разделе приведены необходимые инструкции. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h5 id="базовая-функциональность-2">Базовая функциональность</h5>
<ul>
<li>Константу <code>СостояниеОтправкиСерверныхОповещений</code> и регистры сведений <code>ОтправленныеСерверныеОповещения</code> и <code>ПериодическиеСерверныеОповещения</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
<li>Константу <code>ДоставлятьСерверныеОповещенияБезСистемыВзаимодействия</code> не следует включать в состав любых планов обмена.</li>
<li>В редких случаях процедура <code>СообщитьПрогресс</code> общего модуля <code>ДлительныеОперации</code> могла использоваться не только для информирования о прогрессе длительной операции, но и для управления прикладной логикой. Такие места необходимо пересмотреть, например, перенести логику в обработчик завершения длительной операции. Это связано с тем, что для оптимизации производительности отправленные оповещения прогресса теперь доставляются на клиент не чаще одного раза в три секунды.</li>
</ul>
<h4 id="необязательные-действия-по-переходу">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="базовая-функциональность-3">Базовая функциональность</h5>
<ul>
<li>Для сокращения количества периодических серверных вызовов вместо обработчиков ожидания рекомендуется использовать механизмы серверных оповещений и длительных операций, заменив на них собственные аналоги. Подробнее см. выше в разделе <strong>Новые возможности для разработчиков в версии 3.1.7</strong> - <strong>Базовая функциональность</strong>.</li>
</ul>
<h5 id="дополнительные-отчеты-и-обработки">Дополнительные отчеты и обработки</h5>
<ul>
<li>Функция <code>ИмяФормыДлительнойОперации</code> общего модуля <code>ДополнительныеОтчетыИОбработкиКлиент</code> отмечена, как устаревшая. Вместо неё рекомендуется использовать оповещение, передаваемое в параметр <code>Обработчик</code> процедуры <code>ВыполнитьКомандуВФоне</code> того же общего модуля.</li>
</ul>
<h5 id="текущие-дела">Текущие дела</h5>
<ul>
<li>Удалены неиспользуемые процедуры <code>ПередЗагрузкойДанныхИзНастроекНаСервере</code> и <code>ПриСозданииНаСервере</code> общего модуля <code>ТекущиеДелаПереопределяемый</code>. Если данные процедуры используются для переопределения поведения в подключенных к текущим делам объектах, рекомендуется перенести их в модули конфигурации и заменить места вызова.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.7">Особенности обновления с ранних версий на версию 3.1.7</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.7) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <strong>Переход на версию А с версии Б</strong> для каждой пропущенной версии.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.7">Переход на исправительные релизы 3.1.7</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.7.<strong>1</strong>, 3.1.7.<strong>20</strong>, 3.1.7.<strong>300</strong> из т.п. Для обновления на исправительные релизы предназначена внешняя обработка <strong>ОбновлениеНаИсправительнуюВерсиюБСП.epf</strong> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <strong>Обновить на исправительную версию</strong>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <strong>Сформировать файл настроек</strong> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <strong>ПроверкаВнедренияБСП.erf</strong>.</p>
<h4 id="с-версии-3.1.7.137-и-меньше">С версии 3.1.7.137 и меньше</h4>
<h5 id="свойства">Свойства</h5>
<ul>
<li>Если набор свойств задавался предопределенным элементом справочника <code>НаборыДополнительныхРеквизитовИСведений</code> и его описание было перенесено в процедуру <code>ПриПолученииПредопределенныхНаборовСвойств</code> общего модуля <code>УправлениеСвойствамиПереопределяемый</code>, то в этом случае в формах объектов со свойствами могут быть утеряны пользовательские настройки внешнего вида форм (например, размер окна и расположение полей). Для того чтобы не потерять эти настройки, требуется добавить обработчик обновления, в котором вызвать процедуру <code>УправлениеСвойствами.ВосстановитьНастройкиФормСДополнительнымиРеквизитами</code>.</li>
</ul>
<!--Локализация-->
<h4 id="с-версии-3.1.7.96-и-меньше">С версии 3.1.7.96 и меньше</h4>
<h5 id="электронная-подпись">Электронная подпись</h5>
<ul>
<li>Константу <code>РазрешенныеНеаккредитованныеУЦ</code> рекомендуется включать в состав планов обмена РИБ и автономного рабочего места (АРМ). <!--Конец локализация--></li>
</ul>
<h4 id="с-версии-3.1.7.79-и-меньше">С версии 3.1.7.79 и меньше</h4>
<h5 id="обмен-данными">Обмен данными</h5>
<ul>
<li>В версии 1.11.5 универсального формата обмена <code>Enterprise Data</code> реализованы следующие возможности:
<ul>
<li>Начиная с версии ФФД 1.2, коды маркировки по некоторым товарным группам (духи, АТП (сигары)) могут быть переданы в ККТ с дополнительными параметрами, указывающими, какая часть маркируемой единицы подлежит выбытию;</li>
<li>теперь в правилах конвертации можно передать признак договора <strong>Организация выступает в качестве налогового агента по уплате НДС</strong>;</li>
<li>добавлены свойства, которые позволяют в правилах конвертации обмениваться информацией о <strong>Резервах по оплате труда</strong>;</li>
<li>расширили значения перечислений <strong>Виды продукции ИС</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ ИсполнительныйЛист</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ УдержанныйНДФЛ</strong>. Документ может использоваться при передаче сведений об Едином Налоговом Платеже (ЕНП);</li>
<li>свойства справочника <code>Договоры</code> расширено полем <code>ИдентификаторГосКонтракта</code>, что позволяет синхронизировать информацию о государственных контрактах между приложениями;</li>
<li>для ФСС в объект формата <strong>Справочник номенклатура</strong> добавлено необязательное свойство <code>КодТРУ</code>, дополнительно формат расширен новым перечислением <code>ТипыПлатежнойСистемыККТ</code>;</li>
<li>свойства объекта формата <strong>Справочник Организации</strong> расширены необязательным полем <strong>Валюта регламентированного учета</strong>;</li>
<li>в объекте формата <strong>Справочник Патенты</strong> поля <code>КБК</code> и <code>ПотенциальноВозможныйГодовойДоход</code> стали необязательными. Это расширяет возможность конвертации справочника из программ, где патенты учитываются в урезанном виде;</li>
<li>исправлены выявленные ошибки.</li>
</ul></li>
</ul>
<h2 id="версия-3.1.6">Версия 3.1.6</h2>
<p>Версия 3.1.6 предназначена для разработки на платформе <strong>1С:Предприятие</strong> 8.3.17 и выше. Доступны режимы совместимости с <code>Версия 8.3.14</code> по <code>Версия 8.3.21</code> включительно.</p>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.6</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.6">Новые возможности и изменения в версии 3.1.6</h3>
<p>В состав библиотеки включена новая подсистема <strong>Конструктор формул</strong>, предоставляющая удобную форму редактирования формул, в которой выводятся доступные операнды и операторы. При наличии подсистемы <strong>Мультиязычность</strong> операнды и операторы формулы отображаются на текущем языке интерфейса.</p>
<h4 id="базовая-функциональность-4">Базовая функциональность</h4>
<ul>
<li>Теперь в клиент-серверном варианте работы программы можно ускорить некоторые длительные операции, настроив их выполнение в несколько потоков: например, загрузку адресного классификатора. Для этого в разделе <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Производительность</strong> установить максимальное количество одновременно работающих потоков. Параметр следует устанавливать исходя из технических возможностей сервера, и его значение не должно превышать количество ядер процессора на сервере.</li>
<li>В клиент-серверном варианте работы программы при использовании кластера серверов для корректной работы отдельных функций программы в разделе <strong>Администрирование</strong> - <strong>Общие настройки</strong> необходимо ввести общий сетевой путь к каталогу временных файлов. Тем самым, это обеспечит доступ со всех серверов кластера к этому каталогу, например, для многопоточной загрузки адресного классификатора.</li>
<li>Улучшено обновление расширений (см. список <strong>Расширения</strong> в разделе <strong>Администрирование</strong> - <strong>Печатные формы, отчеты и обработки</strong>). Теперь если обновить расширение на новую версию, в которой изменено его имя, то все прежние настройки этого расширения будут сохранены, например, созданные варианты отчетов. Кроме того, при случайном удалении и повторном добавлении этого же расширения в программу через короткий промежуток времени также возможно продолжить работу без потери его настроек.</li>
</ul>
<h4 id="варианты-отчетов">Варианты отчетов</h4>
<ul>
<li>Из контекстного меню отчета можно перейти к расшифровке отчета по детальным записям. В структуре такого отчета имеется только один элемент <strong><Детальные записи></strong>.</li>
<li>В командной панели отчета размещены кнопки отмены и повтора действий. При активной настройке отчета с их помощью удобно отменять одно или несколько последних настроечных действий, выполненных из контекстного меню или в форме настроек: добавление фильтров, группировок, перемещение колонок, изменение сортировки и т.п. Также можно сбросить до стандартных настроек. Раньше в отчетах имелась возможность только сброса до стандартных настроек.</li>
<li>С помощью кнопки <strong>Изменить состав быстрых настроек</strong> справа в шапке отчета можно включать или отключать вывод заголовков полей шапки. В большинстве случаев поля в шапке отчетов вполне понятны без заголовков: по их содержимому, подсказке ввода или всплывающей подсказке при наведении курсором. Тем самым, шапка отчета занимает меньше места по ширине экрана.</li>
<li>При сохранении результата отчета в формат Excel из шапки отчета скрываются картинки-индикаторы сортировки.</li>
<li>В форме настройки отчета, в расширенном режиме, теперь можно добавлять отборы не только с помощью выбора полей из списка, но и вводом по первым буквам.</li>
</ul>
<h4 id="взаимодействия">Взаимодействия</h4>
<ul>
<li>Улучшена диагностика проблем, возникающих при получении и отправке почты. Помимо технологических сообщений почтовых серверов выводятся краткие пояснения по возможным причинам и способам их устранения. См. также на ИТС: <a href="https://its.1c.ru/bmk/bsp_email_account">Рекомендации по решению типовых проблем</a>.</li>
</ul>
<h4 id="обмен-данными-1">Обмен данными</h4>
<ul>
<li>Для возможности применения расширений и быстрой отладки правил регистрации можно включить <strong>Менеджер регистрации</strong> (см. форму загрузки правил регистрации, которая расположена в параметрах синхронизации данных). В этом случае правила регистарации хранятся в общем модуле конфигурации.</li>
</ul>
<h4 id="обновление-версии-иб">Обновление версии ИБ</h4>
<ul>
<li>Если отложенный обработчик обновления завершился с ошибкой, то теперь его можно “точечно” перезапустить, повторно зарегистрировав для него данные для обновления. Для этого после исправления ошибки в обработчике или установки исправления (патча) необходимо перейти в раздел <strong>Администрирование</strong> - <strong>Обслуживание</strong> - <strong>Результаты обновления и дополнительная обработка данных</strong> и в подменю <strong>Ещё</strong> нажать <strong>Перезапустить отложенное обновление</strong>.</li>
<li>При длительном отложенном обновлении программы можно разрешить редактирование еще не обновленного документа с помощью команды в подменю <strong>Еще</strong> - <strong>Разблокировать объект для редактирования</strong>. Данную возможность следует использовать в крайних случаях, например, для исправления ошибки в документе, из-за которой он не может быть обновлен.</li>
<li>Окно с результатами обновления программы (раздел <strong>Администрирование</strong> - <strong>Обслуживание</strong> - <strong>Результаты обновления и дополнительная обработка данных</strong>) теперь более информативно сообщает о различных проблемах в процессе обновления:
<ul>
<li>о включенной блокировке регламентных заданий в клиент-серверном режиме работы;</li>
<li>проблемы с обработчиками обновления, когда регистрируются ошибки при обработке данных;</li>
<li>проблемы с данными, когда это приводит к невозможности их обработки.
<ul>
<li>при этом доступен переход к отчету, который покажет проблемные объекты и рекомендации по исправлению.</li>
</ul></li>
</ul></li>
<li>Отчет по прогрессу отложенного обновления выводит больше диагностической информации:
<ul>
<li>количество обработанных данных за выбранный период;</li>
<li>наличие проблем в обработчиках обновления и данных, а также возможность перехода к ним.</li>
</ul></li>
</ul>
<h4 id="печать">Печать</h4>
<ul>
<li>В списке макетов печатных форм (раздел <strong>Администрирование</strong> - <strong>Печатные формы, отчеты и обработки</strong> - <strong>Макеты печатных форм</strong>) добавлена возможность создания новых макетов печатных форм. Для новых макетов автоматически добавляются команды печати в подменю <strong>Печать</strong> соответствующих документов. Это позволяет создать свою печатную форму без использования конфигуратора.</li>
<li>В редакторе макета печатной формы доступен список полей документа, выводимого на печать. В списке полей показывается образец заполнения по каждому полю, предусмотрена настройка формата. Поля из этого списка можно перетаскивать прямо в макет. На любом этапе редактирования можно посмотреть образец формирования печатной формы на примере любого документа.</li>
</ul>
<h4 id="пользователи-1">Пользователи</h4>
<ul>
<li>При работе в приложении в Интернете на основе <a href="https://v8.1c.ru/tekhnologii/1cfresh/">облачной технологии 1cFresh</a> администратор сервиса может установить <a href="https://its.1c.ru/db/bsp316doc#content:2186:1:issogl2_настройки_входа">настройки входа</a>, общие для всех пользователей сервиса в менеджере сервиса (раздел <strong>Главное</strong> - <strong>Настройки конфигурации</strong> - <strong>Аутентификация</strong>). Просмотреть настройки входа может администратор абонента в области данных (раздел <strong>Администрирование</strong> - <strong>Настройки пользователей и прав</strong> - <strong>Настройки входа</strong>).</li>
</ul>
<h4 id="работа-с-почтовыми-сообщениями">Работа с почтовыми сообщениями</h4>
<ul>
<li>Улучшена диагностика проблем, возникающих при получении и отправке почты. Помимо технологических сообщений почтовых серверов выводятся краткие пояснения по возможным причинам и способам их устранения. См. также на ИТС: <a href="https://its.1c.ru/bmk/bsp_email_account">Рекомендации по решению типовых проблем</a>.</li>
<li>При настройке электронной почты можно выбрать современный и более безопасный способ авторизации средствами почтового сервиса, который позволяет не хранить пароль от учетной записи почты в программе (OAuth 2.0).</li>
</ul>
<h4 id="рассылка-отчетов">Рассылка отчетов</h4>
<ul>
<li>Улучшена диагностика проблем, возникающих при отправке почты. Помимо технологических сообщений почтовых серверов выводятся краткие пояснения по возможным причинам и способам их устранения. См. также на ИТС: <a href="https://its.1c.ru/bmk/bsp_email_account">Рекомендации по решению типовых проблем</a>.</li>
</ul>
<h4 id="управление-доступом">Управление доступом</h4>
<ul>
<li>С помощью расшифровки <strong>Права пользователя на таблицу</strong> в отчете <strong>Анализ прав доступа</strong> можно посмотреть актуальные настройки ограничений прав на уровне записей (RLS) одним из следующих способов:
<ul>
<li>в любой форме списка в меню <strong>Ещё</strong> нажать <strong>Отчеты - Права пользователя</strong> и открыть расшифровку для интересующего пользователя;</li>
<li>в списке <strong>Пользователи</strong> нажать <strong>Отчеты - Права пользователя</strong> и открыть расшифровку для интересующей таблицы;</li>
<li>либо в разделе <strong>Администрирование - Настройки пользователей и прав</strong> нажать <strong>Анализ прав доступа</strong> и открыть расшифровку для интересующего права доступа.</li>
</ul></li>
<li>Для технических специалистов в отчете <strong>Права ролей</strong> можно проанализировать матрицу права ролей и профилей. Это можно сделать одним из следующих способом:
<ul>
<li>в любой форме списка в меню <strong>Ещё</strong> нажать <strong>Отчеты - Права ролей и профилей</strong></li>
<li>либо в списка <strong>Профили групп доступа</strong> нажать <strong>Отчеты - Права ролей профилей</strong> или <strong>Отчеты - Права профилей</strong></li>
<li>в разделе <strong>Администрирование</strong> нажать <strong>Отчеты администратора</strong>, ввести в строке поиске <strong>Права ролей</strong> и открыть отчет.</li>
</ul></li>
<li>Ускорено формирование отчета <strong>Анализ прав доступа</strong> в два раза.</li>
<li>Существенно упрощено администрирование прав расширений. Расширения со стандартными ролями (имена которых оканчиваются на <strong>Общие права</strong>, <strong>Базовые права</strong> или <strong>Полные права</strong>) автоматически подключаются к системе прав доступа: стандартные роли расширения включаются в соответствующие профили групп доступа и более не требуют какой-либо донастройки.</li>
</ul>
<h4 id="электронная-подпись-1">Электронная подпись</h4>
<!--Локализация-->
<ul>
<li>Квалифицированный сертификат электронной подписи можно перевыпустить быстрее, оформив заявление на выпуск в электронном виде (при условии, что прежний сертификат был получен в этой же программе и данные владельца сертификата не изменились). Для этого достаточно нажать <strong>Перевыпустить</strong> в списке <strong>Настройки электронной подписи и шифрование</strong> (<strong>Мои настройки</strong> или <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Электронная подпись и шифрование</strong>) и выбрать вариант <strong>Оформить в электронном виде</strong>. Электронный вид заявления сэкономит ваше время и бумагу.</li>
<li>Включить оповещение об окончании срока действия сертификата можно с помощью флажка <strong>Напомнить о перевыпуске</strong> в форме сертификата (для “личных” сертификатов). Перевыпустить сертификат в электронном виде можно не ранее, чем за 30 дней до окончания его срока действия.</li>
<li>Из списка текущих дел можно быстро перейти к спискам ваших сертификатов с истекающим сроком действия и заявлений на выпуск сертификата, находящихся в процессе исполнения.</li>
<li>Информация о наличии встроенной лицензии СКЗИ КриптоПро CSP отображается в данных сертификата (карточка сертификата - <strong>Показать данные сертификата</strong>) и служит подсказкой, что такой сертификат может использоваться с ПО КриптоПро CSP на условиях простой неисключительной лицензии без ввода серийного номера.</li>
<li>В заявлении на выпуск нового квалифицированного сертификата появилась печатная форма квалифицированного сертификата.</li>
<li>При проверке сертификата и подписи теперь проверяется статус аккредитованного удостоверяющего центра (АУЦ), выдавшего сертификат усиленной квалифицированной электронной подписи (УКЭП), а также сроки действия сертификатов УКЭП, выданных юридическим лицам и индивидуальным предпринимателям коммерческими АУЦ <a href="https://its.1c.ru/db/eldocs#content:110:hdoc">согласно законодательству</a>. Предусмотрены оповещения о прекращении срока действия сертификатов УКЭП. Список аккредитованных удостоверяющих центров обновляется автоматически с сайта “1С”.<!--Конец локализация--></li>
<li>“Личные” сертификаты, сертификаты с истекающим сроком действия, просроченные сертификаты и заявления на выпуск сертификата выделены с помощью поясняющих картинок в списке сертификатов и в карточке сертификата.</li>
<li>Теперь проверять электронные подписи на достоверность можно с минимальными правами, а также более гибко настраивать права на различные действия с сертификатом: добавление в справочник, подписание, расшифровку и шифрование данных.</li>
<li>Появилась возможность подписывать документы электронными подписями с меткой доверенного времени CAdES-T и CAdES-A (п. 19 ст. 2 Федерального закона от 06.04.2011 N 63-ФЗ “Об электронной подписи”). Для продления срока действия электронных подписей можно автоматически усовершенствовать ранее добавленные подписи и добавлять архивные метки времени в архивные подписи. Выбрать подходящий тип подписи для новых и существующих документов в программе можно в разделе <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Электронная подпись и шифрование</strong>.</li>
<li>Если сертификат отозван в удостоверяющем центре, но отзыв еще не вступил в силу, в карточке сертификата в меню <strong>Еще</strong> можно поставить пометку <strong>Сертификат отозван</strong> и сертификатом нельзя будет воспользоваться при подписании.</li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.6">Новые возможности для разработчиков в версии 3.1.6</h3>
<h4 id="базовая-функциональность-5">Базовая функциональность</h4>
<ul>
<li>В процедуре <code>ПередЗапускомПрограммы</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code> можно выполнить произвольные действия перед запуском программы, например, настроить начальную страницу и другие параметры интерфейса в зависимости от режима работы.</li>
<li>Поставляются общие картинки для всех видов объектов метаданных, например, <code>МетаданныеСправочники</code>, <code>МетаданныеДокументы</code> и т.п. (начинаются со слова <code>Метаданные</code>).</li>
<li>В общей форме <code>ВыборОбъектовМетаданных</code> возможен выбор объектов метаданных <code>ОбщиеРеквизиты</code>, <code>HTTPСервисы</code> и <code>ВнешниеИсточникиДанных</code>. В режиме выбора <strong>По видам объектов</strong> теперь также отображаются узнаваемые картинки для всех видов объектов метаданных.</li>
<li>В общем модуле <code>ОбщегоНазначенияКлиентСервер</code> появились функции <code>ДатаHTTP</code> и <code>ДатаRFC1123</code> для преобразования даты в формат <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#:~:text=Date/Time%20Formats-,3.3.1%20Full%20Date,-HTTP%20applications%20have">RFC-1123</a> и обратно, используемые при работе с файлами, получаемыми из интернета.</li>
<li>Для ускорения выполнения длительных операций предусмотрена возможность выполнить обработчик длительной операции в несколько потоков. Для этого необходимо:
<ul>
<li>Разделить данные на наборы, где каждый элемент набора будет обработан в отдельном фоновом задании.</li>
<li>Из программного интерфейса общего модуля <code>ДлительныеОперации</code> для запуска процедуры длительной операции вызвать функцию <code>ВыполнитьПроцедуруВНесколькоПотоков</code> (или <code>ВыполнитьФункциюВНесколькоПотоков</code>), передав третьим параметром сформированный набор данных. Подробное описание параметров см. в комментарии к этим функциям.</li>
<li>Максимально допустимое количество одновременно работающих фоновых заданий может быть задано администратором в разделе <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Производительность</strong></li>
<li>В файловой информационной базе и при работе в модели сервиса длительные операции всегда выполняются в один поток.</li>
<li>Пример см. в демонстрационной конфигурации в форме <code>ЗагрузкаАдресногоКлассификатора</code> регистра сведений <code>АдресныеОбъекты</code>.</li>
</ul></li>
<li>Для улучшения информирования пользователя о ходе выполнения длительной операции расширен программный интерфейс функции <code>ПараметрыОжидания</code> общего модуля <code>ДлительныеОперацииКлиент</code>:
<ul>
<li>Новое свойство <code>Заголовок</code> позволяет отобразить произвольный заголовок в окне ожидания выполнения длительной операции.</li>
<li>В состав структуры <code>ОповещениеПользователя</code> добавлены новые свойства:
<ul>
<li><code>Картинка</code> определяет отображаемую картинку в оповещении по завершению длительной операции.</li>
<li><code>Важное</code> позволяет отметить оповещение как важное, и тогда оповещение также будет выведено в центр оповещений.</li>
</ul></li>
</ul></li>
<li>Если не требуется обеспечить обновление с предыдущих версий конфигурации, в которые включена библиотека версии 3.1.5 и меньше, то больше не нужно указывать переименования ролей в процедуре <code>ПриДобавленииПереименованийОбъектовМетаданных</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>. Теперь переименования ролей отслеживаются автоматически.</li>
</ul>
<h4 id="варианты-отчетов-1">Варианты отчетов</h4>
<ul>
<li>Расширен программный интерфейс, который позволяет выделить поля настроек шапки отчета в отдельную группу. С помощью процедуры <code>ПриОпределенииСвойствЭлементовФормыНастроек</code> модуля отчета можно задавать следующие свойства группы: <code>Заголовок</code>, <code>ЦветФона</code>, <code>Подсказка</code>, <code>ОтображениеПодсказки</code>, <code>Высота</code>, <code>Ширина</code>, <code>РастягиватьПоВертикали</code> и <code>РастягиватьПоГоризонтали</code>. См. процедуру <code>СвойстваГруппыЭлементовФормы</code> общего модуля <code>ОтчетыСервер</code> и пример в процедуре <code>ПриОпределенииСвойствЭлементовФормыНастроек</code> модуля отчета <code>УниверсальныйОтчет</code>.</li>
<li>С помощью процедуры <code>ПриНачалеВыбораЗначений</code> общего модуля <code>ОтчетыКлиентПереопределяемый</code> можно переопределить форму выбора значений в полях отборов отчета. Например, это задействовано в отчете <code>ПраваРолей</code> для отбора по ролям и объектам метаданных с помощью общей формы <code>ВыборОбъектовМетаданных</code>.</li>
<li>Для того чтобы выполнить логику на клиенте перед формированием отчета, предусмотрено событие <code>ПередФормированиемОтчета</code> - см. функцию <code>НастройкиОтчетаПоУмолчанию</code> общего модуля <code>ОтчетыКлиентСервер</code>. Например, это может быть необходимо, чтобы вывести предупреждение перед формированием слишком большого отчета.</li>
<li>Расширен состав свойств <code>ДополнительныеСвойства</code> параметра <code>НовыеНастройкиКД</code> и объекта <code>Настройки</code> компоновщика настроек (объекта отчета) события модуля отчета <code>ПередЗагрузкойНастроекВКомпоновщик</code>. В них передаются свойства <code>КлючВарианта</code>, <code>КлючПредопределенногоВарианта</code>, <code>КонтекстВарианта</code> и <code>ФормаПараметрыОтбор</code>, которые позволяют точнее учитывать контекст создания отчета.</li>
<li>Реализовано событие <code>ПослеЗагрузкиНастроекВКомпоновщик</code> вместо устаревшего события <code>ПриОпределенииПараметровВыбора</code> (см. описание в функции <code>НастройкиОтчетаПоУмолчанию</code> общего модуля <code>ОтчетыКлиентСервер</code>). В нем возможно не только уточнять параметры выбора (например, список выбора), но и делать это с учетом загруженных фиксированных настроек. Кроме того, новое событие вызывается и при неинтерактивном формировании отчета, например, при рассылке отчетов.</li>
<li>Для отдельных нетиповых отчетов предусмотрен признак <code>ОтключитьСтандартноеКонтекстноеМеню</code>, позволяющий отключить использование контекстного меню и настройки колонки отчета. См. описание в функции <code>НастройкиОтчетаПоУмолчанию</code> общего модуля <code>ОтчетыКлиентСервер</code>.</li>
</ul>
<h4 id="контактная-информация">Контактная информация</h4>
<ul>
<li>В целях унификации начального заполнения и обновления предопределенных видов контактной информации в конфигурации теперь код заполнения достаточно разместить только в процедурах <code>ПриНачальномЗаполненииЭлементов</code> и <code>ПриНачальномЗаполненииЭлемента</code> общего модуля <code>УправлениеКонтактнойИнформациейПереопределяемый</code>. Кроме того, с ее помощью можно также задавать создание папок (группы справочника <code>ВидыКонтактнойИнформации</code>). См. примеры в демонстрационной конфигурации.</li>
</ul>
<h4 id="контроль-ведения-учета">Контроль ведения учета</h4>
<ul>
<li>В процедуре <code>ОткрытьОтчетПоПроблемам</code> общего модуля <code>КонтрольВеденияУчетаКлиент</code> добавлен необязательный параметр <code>ТочноеСоответствие</code>, который позволяет настроить применение отбора по параметру <code>ВидПроверок</code> при открытии отчета.</li>
</ul>
<h4 id="мультиязычность">Мультиязычность</h4>
<ul>
<li>Для получения в запросах значений мультиязычных реквизитов в соответствии с текущими языком пользователя, например подбор товаров или вывод их в произвольных списках, в программном интерфейсе общего модуля <code>МультиязычностьСервер</code> предусмотрена процедура <code>ИзменитьПолеЗапросаПодТекущийЯзык</code> изменяющая наименование мультиязычного реквизита в текст запроса на наименование реквизита согласно текущего языка пользователя. Например, для первого дополнительного языка процедура меняет <code>Наименование</code> на <code>НаименованиеЯзык1</code>. Подробнее см. комментарий к процедуре.</li>
</ul>
<h4 id="напоминания-пользователя">Напоминания пользователя</h4>
<ul>
<li>Программный интерфейс общего модуля <code>НапоминанияПользователя</code> расширен функцией <code>ИспользуютсяНапоминанияПользователя</code> для проверки возможности использования напоминаний пользователя.</li>
</ul>
<h4 id="обмен-данными-2">Обмен данными</h4>
<ul>
<li><p>Процедура <code>ПриИзмененииОпцииАвтономногоРежимаРаботы</code> общего модуля <code>ОбменДаннымиПереопределяемый</code> вызывается при изменении режима работы информационной базы и позволяет выполнить дополнительные действия, например, проинициализировать связанные константы и настройки.</p></li>
<li><p>При синхронизации данных через универсальный формат <code>EnterpriseData</code> появилась возможность выполнять правила регистрации, расположенные в общем модуле конфигурации или расширения. Для этого необходимо в менеджере плана обмена в процедуре <code>ПриПолученииНастроек</code> указать настройки <code>ПравилаРегистрацииВМенеджере</code> и <code>МенеджерРегистрации</code>. Пример настройки:</p>
<pre><code>Процедура ПриПолученииНастроек(Настройки) Экспорт

  …

  Настройки.ПравилаРегистрацииВМенеджере = Истина; 
  Настройки.МенеджерРегистрации = &quot;_ДемоМенеджерРегистрацииДляУниверсальногоФормата&quot;;

КонецПроцедуры
</code></pre>
<p>Для создания общего модуля необходимо использовать конфигурацию <strong>Конвертация данных</strong> версии не меньше 3.1.1. У общего модуля должны быть установлены следующие контексты выполнения: <strong>Сервер</strong>, <strong>Внешнее соединение</strong>, <strong>Клиент (обычное приложение)</strong>.</p></li>
<li><p>В обработке <code>Выгрузка загрузка EnterpriseData</code> в режиме разработчика возможно работать с общим каталогом временных файлов (опционально). Опция размещена в меню <code>Еще</code> и доступна в режиме загрузки данных.</p></li>
</ul>
<h4 id="обновление-версии-иб-1">Обновление версии ИБ</h4>
<ul>
<li>Программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазы</code> расширен методами <code>ЗаписатьСобытиеВЖурналРегистрации</code>, <code>ПерезапуститьОтложенноеОбновление</code>, <code>ПерезапуститьМонопольноеОбновление</code>, <code>ЗарегистрироватьПроблемуСДанными</code>, <code>ВключитьОтключитьОтложенноеОбновление</code>. Подробнее см. в описании к ним.</li>
<li>Программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> расширен методом <code>ПриЗаполненииПриоритетовТиповМетаданных</code>. Подробнее см. в описании к нему.</li>
<li>Структура <code>Параметры</code>, которая передается на вход отложенных обработчиков обновления, расширена свойством <code>ВерсияПодсистемыНаНачалоОбновления</code>. В нем передается полный номер версии подсистемы, к которой он относится, на момент начала обновления программы. Например, 3.1.5.123. Может быть полезно для ветвления логики выполнения обработчика в зависимости от версии, с которой выполняется обновление программы.</li>
<li>Упрощено описание отложенных обработчиков обновления для параллельного режима. Теперь не требуется указывать приоритеты выполнения обработчиков, т.к. они рассчитываются автоматически. При этом возможность указания приоритетов оставлена для случаев, когда по объективным причинам автоматические приоритеты не удовлетворяют решаемой задаче. Приоритеты, установленные у обработчика вручную, выделены цветом на закладке <strong>Конфликты</strong> в форме настройки обработчика обработки <strong>Описание обработчиков обновления</strong>. Подробнее см. документацию к подсистеме.</li>
<li>Инструмент разработчика <code>Описание обработчиков обновления</code> (<strong>Функции для технического специалиста</strong> - <strong>Описание обработчиков обновления</strong>) теперь позволяет отбирать отложенные обработчики обновления, у которых указана нестандартная процедура проверки необработанных данных. Данная возможность требуется для контроля, т.к. процедура проверки позволяет проверять доступность объекта для редактирования в процессе отложенного обновления и должна отвечать некоторым требованиям:
<ul>
<li>можно блокировать только необновленные данные;</li>
<li>данные должны разблокироваться по мере обработки, а не после полной обработки всех объектов;</li>
<li>ввод новых данных должен быть доступен всегда.</li>
</ul></li>
<li>Для поставки элементов различных справочников в конфигурации теперь необязательно создавать предопределенные элементы. Достаточно описать их создание в процедуре <code>ПриНачальномЗаполненииЭлементов</code> модуля менеджера справочника или общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code>.
<ul>
<li>Для возможности обновления таких элементов в процедуре <code>ПриНастройкеНачальногоЗаполненияЭлементов</code> модуля менеджера справочника или общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> для свойства настроек <code>ИмяКлючевогоРеквизита</code> следует указать имя реквизита, значение которого определяет уникальный идентификатор элемента;</li>
<li>Примеры заполнения поставляемых элементов смотрите в процедурах <code>ПриНачальномЗаполненииЭлементов</code> общих модулей <code>_ДемоОбновлениеИнформационнойБазыБСП</code> и <code>_ДемоСвойства</code> демонстрационной конфигурации.</li>
</ul></li>
<li>Для обновления отдельных реквизитов поставляемых элементов, описанных в процедуре <code>ПриНачальномЗаполненииЭлементов</code> в процедуре <code>ЗаполнитьЭлементыНачальнымиДанными</code> программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазы</code> расширен третьим параметром <code>НастройкиЗаполнения</code> у которого в свойстве <code>Реквизиты</code> определяется список обновляемых реквизитов через запятую. Подробнее см. в комментарии к ней.</li>
<li>При заполнении поставляемых элементов в собственных обработчиках обновления для исключения повторной записи элемента в программном интерфейса общего модуля <code>ОбновлениеИнформационнойБазы</code> предусмотрена процедура <code>ЗаполнитьОбъектНачальнымиДанными</code>, которая заполняет объект данными, описанными в процедуре <code>ПриНачальномЗаполненииЭлементов</code> без его записи.</li>
<li>Улучшен сценарий перехода с другой программы, когда меняется имя конфигурации, например, БАЗОВАЯ-&gt;ПРОФ. Теперь в этом случае автоматически выполняются обработчики начального заполнения данных для новых подсистем, которых ранее не было в конфигурации:
<ul>
<li>до начала выполнения обработчиков перехода, определенных в процедуре <code>ПриДобавленииОбработчиковПереходаСДругойПрограммы</code> общего модуля, имя которого задано в процедуре <code>ПодсистемыКонфигурацииПереопределяемый.ПриДобавленииПодсистем</code>;</li>
<li>вызываются только обработчики с режимами выполнения <code>Оперативно</code> и <code>Монопольно</code>;</li>
<li>по умолчанию отключено, для задействования возможности необходимо в процедуре <code>ПриДобавленииПодсистемы</code> общего модуля <code>ОбновлениеИнформационнойБазы&lt;Сокращение&gt;</code> указать свойство <code>ЗаполнятьДанныеНовыхПодсистемПриПереходеСДругойПрограммы</code>.
<ul>
<li>также можно точечно отключить отдельные обработчики, которые не требуется выполнять, установив для них свойство <code>НеВыполнятьПриПереходеСДругойПрограммы</code> в значение <code>Истина</code>.</li>
</ul></li>
</ul></li>
</ul>
<h4 id="печать-1">Печать</h4>
<ul>
<li>В подсистеме предусмотрен новый способ формирования печатных форм, упрощающий их редактирование в режиме предприятия, а также позволяющий пользователю создавать печатные формы с нуля. В частности, в редакторе макета выводится список доступных полей объекта, при этом список полей генерируется с использованием СКД и может быть иерархическим. Общий принцип состоит в том, что каждый объект конфигурации предоставляет список доступных полей и данные печати при помощи макета СКД, а в макете печатной формы в качестве параметров указываются поля этой СКД. Печатную форму по макету и данным печати формирует сама подсистема <strong>Печать</strong>. Рекомендуется использовать данную технологию при разработке новых печатных форм. Подробности см. в документации.</li>
</ul>
<h4 id="пользователи-2">Пользователи</h4>
<ul>
<li>Программный интерфейс общего модуля <code>Пользователи</code> расширен процедурами и функциями:
<ul>
<li><code>УстановитьНастройкиВхода</code> для сохранения настроек входа пользователей;</li>
<li><code>НовоеОписаниеНастроекВхода</code> для получения структуры с настройками входа по умолчанию;</li>
<li><code>ДобавитьИспользованныйПароль</code> для добавления пароля в список используемых, если в настройках для входа заполнено свойство <code>ЗапретитьПовторениеПароляСредиПоследних</code>.</li>
</ul></li>
</ul>
<h4 id="работа-с-почтовыми-сообщениями-1">Работа с почтовыми сообщениями</h4>
<ul>
<li>Для вывода пояснений и способов устранения ошибки подключения к почтовому серверу предусмотрена процедура <code>СообщитьОбОшибкеПодключения</code> в общем модуле <code>РаботаСПочтовымиСообщениямиКлиент</code>.</li>
<li>Для подготовки расширенного описания ошибки подключения к почтовому серверу предусмотрены функции <code>ПоясненияПоОшибке</code> и <code>РасширенноеПредставлениеОшибки</code> в общем модуле <code>РаботаСПочтовымиСообщениями</code>.</li>
</ul>
<h4 id="свойства-1">Свойства</h4>
<ul>
<li>В целях унификации начального заполнения и обновления предопределенных наборов дополнительных реквизитов и сведений в конфигурации теперь код заполнения достаточно разместить только в процедурах <code>ПриНачальномЗаполненииЭлементов</code> и <code>ПриНачальномЗаполненииЭлемента</code> общего модуля <code>УправлениеСвойствамиПереопределяемый</code>. См. примеры в демонстрационной конфигурации.</li>
</ul>
<h4 id="удаление-помеченных-объектов">Удаление помеченных объектов</h4>
<ul>
<li>Для дополнительных действий до и после удаления помеченных объектов вне транзакции в общем модуле <code>УдалениеПомеченныхОбъектовПереопределяемый</code> предусмотрены процедуры <code>ПередУдалениемГруппыОбъектов</code> и <code>ПослеУдаленияГруппыОбъектов</code>. Например, после удаления группы связанных объектов теперь возможно очистить связанные с ними данные на внешних ресурсах или выполнить другие операции, которые недопустимо выполнять в транзакции удаления.</li>
</ul>
<h4 id="управление-доступом-1">Управление доступом</h4>
<ul>
<li>В расширениях конфигурации можно добавлять и изменять состав видов доступа, поставляемых профилей групп доступа и настроек прав объектов - точно таким же образом, как и при разработке конфигурации.</li>
<li>Роли расширения конфигурации следует разрабатывать в соответствии с разделом <strong>Стандартные роли расширений</strong> стандарта <a href="https://its.1c.ru/db/v8std#content:488:hdoc"><strong>Стандартные роли</strong></a>. В этом случае существенно упрощается администрирование прав доступа, т.к. стандартные роли расширения автоматически включаются в соответствующие профили групп доступа и не требуют какой-либо дополнительной донастройки.</li>
</ul>
<h4 id="электронная-подпись-2">Электронная подпись<!--Локализация--></h4>
<ul>
<li>Подсистема <strong>Напоминания пользователя</strong> предоставляет возможность автоматического создания напоминаний об исполнении заявления на перевыпуск сертификата (флажок <strong>Напомнить о готовности</strong> в форме заявления) и об окончании срока действия сертификата (флажок <strong>Напомнить о перевыпуске</strong> в форме сертификата).</li>
<li>Подсистема <strong>Текущие дела</strong> обеспечивает отображение на рабочем столе пользователя ссылки для быстрого перехода к сертификатам, ожидающим перевыпуска и заявлениям в процессе исполнения. <!--Конец локализация--></li>
<li>Появилась возможность подписывать документы электронными подписями с меткой доверенного времени CAdES-T и CAdES-A (п. 19 ст. 2 Федерального закона от 06.04.2011 N 63-ФЗ “Об электронной подписи”).
<ul>
<li>Для подписания определенным типом подписи, в процедуру <code>Подписать</code> модуля <code>ЭлектроннаяПодписьКлиент</code> добавлен необязательный параметр <code>ТипПодписи</code>. Если усовершенствованные подписи недоступны в используемой версии платформы 1С:Предприятие, то параметр игнорируется, подписание выполняется в базовом формате CAdES-BES.</li>
<li>Для усовершенствования подписей и добавления архивных меток времени предназначена процедура <code>УсовершенствоватьПодпись</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code>, в модуль <code>ЭлектроннаяПодпись</code> добавлены процедуры <code>УсовершенствоватьПодпись</code> и <code>УсовершенствоватьПодписьОбъекта</code>. Для определения доступности усовершенствования подписей в зависимости от используемой версии платформы 1С:Предприятие имеется функция <code>ДоступнаУсовершенствованнаяПодпись</code>.</li>
<li>Для отбора отдельных подписей в функции <code>УстановленныеПодписи</code> модуля <code>ЭлектроннаяПодпись</code> появился необязательный параметр <code>ПорядковыйНомер</code>.</li>
<li>Для обновления данных усовершенствованной подписи в процедуру <code>ОбновитьПодпись</code> модуля <code>ЭлектроннаяПодпись</code> добавлен необязательный параметр <code>ОбновитьПоПорядковомуНомеру</code>.</li>
<li>Для добавления и обновления данных электронной подписи рекомендуется использовать функцию-конструктор <code>НовыеСвойстваПодписи</code> модуля <code>ЭлектроннаяПодписьКлиентСервер</code> в качестве начального значения параметра <code>СвойстваПодписи</code> процедур <code>ДобавитьПодпись</code> и <code>ОбновитьПодпись</code> общего модуля <code>ЭлектроннаяПодпись</code>.</li>
</ul></li>
</ul>
<h3 id="электронная-подпись-сервиса-dss">Электронная подпись сервиса DSS<!--Локализация--></h3>
<ul>
<li>Исключить константу <code>СлужебнаяУчетнаяЗаписьDSS</code> из планов обмена РИБ.</li>
</ul>
<h3 id="переход-на-версию-3.1.6-с-версии-3.1.5">Переход на версию 3.1.6 с версии 3.1.5</h3>
<h4 id="обязательные-действия-по-переходу-1">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения (см. <a href="https://its.1c.ru/db/bspdoc">главу 2 Инструкция по внедрению библиотеки</a>).</p>
<p>Для обновления следующих переопределяемых общих модулей требуется перенести из поставки библиотеки новые экспортные процедуры, удалить отсутствующие и убедиться, что комментарии, количество и имена параметров у процедур совпадают с поставкой библиотеки:</p>
<ul>
<li><code>ОбменДаннымиПереопределяемый</code>,</li>
<li><code>ОбновлениеИнформационнойБазыПереопределяемый</code>,</li>
<li><code>ОбщегоНазначенияПереопределяемый</code>,</li>
<li><code>ОрганизацииПереопределяемый</code>,</li>
<li><code>ОтчетыКлиентПереопределяемый</code>,</li>
<li><code>УправлениеКонтактнойИнформациейПереопределяемый</code>,</li>
<li><code>УправлениеСвойствамиПереопределяемый</code>.</li>
</ul>
<p>Рекомендации по задействованию новых возможностей переопределяемых общих модулей приведены выше в разделе <strong>Новые возможности для разработчиков</strong>.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки. В исключительных (редких) случаях, когда такая совместимость не обеспечена, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки, в этом разделе приведены необходимые инструкции. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h5 id="базовая-функциональность-6">Базовая функциональность</h5>
<ul>
<li>Константы <code>КоличествоПотоковДлительныхОпераций</code>, <code>КаталогВременныхФайловДляLinux</code>, <code>КаталогВременныхФайловДляWindows</code> и регистр сведений <code>ДлительныеОперации</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="варианты-отчетов-2">Варианты отчетов</h5>
<ul>
<li>Для работы подсистемы <strong>Варианты отчетов</strong> требуется наличие подсистемы <strong>Конструктор формул</strong>, необходимо добавить ее в конфигурацию.</li>
</ul>
<h5 id="обмен-данными-3">Обмен данными</h5>
<ul>
<li>Константу <code>ИспользоватьОптимизированнуюЗаписьСозданияАвтономногоРабочегоМеста</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="обновление-версии-иб-2">Обновление версии ИБ</h5>
<ul>
<li>Регистр сведений <code>ПрогрессОбновления</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="мультиязычность-1">Мультиязычность</h5>
<ul>
<li>Включить новую константу <code>ДанныеДляИзмененияМультиязычныхРеквизитов</code> в планы обмена РИБ и их подписки на события для регистрации изменений.</li>
</ul>
<h5 id="организации">Организации</h5>
<ul>
<li>В общем модуле <code>ОрганизацииПереопределяемый</code> процедура <code>ПриОпределенииРегистрационныхДанныхИностраннойОрганизации</code> переименована в <code>ПриОпределенииРегистрационныхДанныхОтделенияИностраннойОрганизации</code>.</li>
</ul>
<h5 id="печать-2">Печать</h5>
<ul>
<li>Для работы подсистемы <strong>Печать</strong> требуется наличие подсистемы <strong>Конструктор формул</strong>, необходимо добавить ее в конфигурацию.</li>
<li>Включить новый справочник <code>МакетыПечатныхФорм</code> в планы обмена РИБ и их подписки на события для регистрации изменений.</li>
</ul>
<h5 id="пользователи-3">Пользователи</h5>
<ul>
<li>Включить новую константу <code>ИспользоватьГруппыВнешнихПользователей</code> в планы обмена РИБ и их подписки на события для регистрации изменений.</li>
<li>Исключить новую константу <code>НастройкиВходаПользователей</code> из планов обмена РИБ.</li>
</ul>
<h5 id="работа-с-почтовыми-сообщениями-2">Работа с почтовыми сообщениями</h5>
<ul>
<li>Включить новый справочник <code>НастройкиАвторизацииИнтернетСервисов</code> в планы обмена РИБ и их подписки на события для регистрации изменений.</li>
</ul>
<h5 id="электронная-подпись-3">Электронная подпись</h5>
<ul>
<li>В планы обмена РИБ включить <!--Локализация-->новые регистры сведений <code>ОповещенияПользователейСертификатов</code>, <code>ЗаявленияНаВыпускСертификата</code> и <!--Конец локализация-->новые константы <code>АдресаСерверовМетокВремени</code>, <code>ДобавлятьМеткиВремениАвтоматически</code>, <code>ТипПодписиКриптографииПоУмолчанию</code>, <code>УсовершенствоватьПодписиАвтоматически</code>, <code>УсовершенствоватьПодписиСДаты</code>. Включить в обработчики регистрации изменений планов обмена РИБ.</li>
<li>В программном коде, в частности, в описании поставляемых профилей, заменить роль <code>ДобавлениеИзменениеЭлектронныхПодписейИШифрование</code> на новые роли <code>ДобавлениеИзменениеЭлектронныхПодписей</code>, <code>ШифрованиеИРасшифровкаДанных</code>, <code>РасшифровкаДанных</code> , <code>ДобавлениеИзменениеСертификатовКлючейЭлектроннойПодписиИШифрования</code> , <code>ДобавлениеИзменениеПрограммЭлектроннойПодписиИШифрования</code> согласно <a href="https://its.1c.ru/db/bsp316doc/content/4/1/issogl3_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BF%D1%80%D0%B0%D0%B2_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%B0_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B960">назначению ролей</a>. <!--Локализация--></li>
<li>Константу <code>АккредитованныеУдостоверяющиеЦентры</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
<li>Константу <code>РазрешенныеНеаккредитованныеУЦ</code> рекомендуется включать в состав планов обмена РИБ и автономного рабочего места (АРМ). <!--Конец локализация--></li>
</ul>
<h4 id="необязательные-действия-по-переходу-1">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h4 id="базовая-функциональность-7">Базовая функциональность</h4>
<ul>
<li>Общая картинка <code>Информация</code> отмечена как устаревшая и переименована в <code>УдалитьИнформация</code>. Вместо нее следует использовать стандартную картинку <code>Информация</code>.</li>
</ul>
<h5 id="варианты-отчетов-3">Варианты отчетов</h5>
<ul>
<li>В отчетах на базе системы компоновки данных (СКД) при нажатии на колонку доступны возможности контекстного меню и настройки свойств колонки. При этом если в конфигурации для отчетов определен свой макет оформления компоновки данных, то для включения этих возможностей необходимо установить в нем для заголовков группировок режим изменения размера колонки <strong>Быстрое изменение</strong>. См. пример в демонстрационной конфигурации в общем макете <code>_ДемоОформлениеОтчетовБежевый</code> и в процедуре <code>ПередЗагрузкойВариантаНаСервере</code> общего модуля <code>ОтчетыПереопределяемый</code>.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.6">Особенности обновления с ранних версий на версию 3.1.6</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.6) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <strong>Переход с предыдущих версий</strong> для каждой пропущенной версии.</li>
</ul>
<h4 id="базовая-функциональность-8">Базовая функциональность</h4>
<ul>
<li>Константу <code>СтандартныеПодсистемыВАвтономномРежиме</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.6">Переход на исправительные релизы 3.1.6</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.6.<strong>1</strong>, 3.1.6.<strong>20</strong>, 3.1.6.<strong>300</strong> из т.п. Для обновления на исправительные релизы предназначена внешняя обработка <strong>ОбновлениеНаИсправительнуюВерсиюБСП.epf</strong> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <strong>Обновить на исправительную версию</strong>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <strong>Сформировать файл настроек</strong> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <strong>ПроверкаВнедренияБСП.erf</strong>.</p>
<!--Локализация-->
<h4 id="с-версии-3.1.6.271-и-меньше">С версии 3.1.6.271 и меньше</h4>
<h5 id="электронная-подпись-4">Электронная подпись</h5>
<p>Константу <code>РазрешенныеНеаккредитованныеУЦ</code> рекомендуется включать в состав планов обмена РИБ и автономного рабочего места (АРМ). <!--Конец локализация--></p>
<h4 id="с-версии-3.1.6.257-и-меньше">С версии 3.1.6.257 и меньше</h4>
<h5 id="обмен-данными-4">Обмен данными</h5>
<ul>
<li>В версии 1.11.5 универсального формата обмена <code>Enterprise Data</code> реализованы следующие возможности:
<ul>
<li>Начиная с версии ФФД 1.2, коды маркировки по некоторым товарным группам (духи, АТП (сигары)) могут быть переданы в ККТ с дополнительными параметрами, указывающими, какая часть маркируемой единицы подлежит выбытию;</li>
<li>теперь в правилах конвертации можно передать признак договора <strong>Организация выступает в качестве налогового агента по уплате НДС</strong>;</li>
<li>добавлены свойства, которые позволяют в правилах конвертации обмениваться информацией о <strong>Резервах по оплате труда</strong>;</li>
<li>расширили значения перечислений <strong>Виды продукции ИС</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ ИсполнительныйЛист</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ УдержанныйНДФЛ</strong>. Документ может использоваться при передаче сведений об Едином Налоговом Платеже (ЕНП);</li>
<li>свойства справочника <code>Договоры</code> расширено полем <code>ИдентификаторГосКонтракта</code>, что позволяет синхронизировать информацию о государственных контрактах между приложениями;</li>
<li>для ФСС в объект формата <strong>Справочник номенклатура</strong> добавлено необязательное свойство <code>КодТРУ</code>, дополнительно формат расширен новым перечислением <code>ТипыПлатежнойСистемыККТ</code>;</li>
<li>свойства объекта формата <strong>Справочник Организации</strong> расширены необязательным полем <strong>Валюта регламентированного учета</strong>;</li>
<li>в объекте формата <strong>Справочник Патенты</strong> поля <code>КБК</code> и <code>ПотенциальноВозможныйГодовойДоход</code> стали необязательными. Это расширяет возможность конвертации справочника из программ, где патенты учитываются в урезанном виде;</li>
<li>исправлены выявленные ошибки.</li>
</ul></li>
</ul>
<h4 id="с-версии-3.1.6.209-и-меньше">С версии 3.1.6.209 и меньше</h4>
<h5 id="обмен-данными-5">Обмен данными</h5>
<ul>
<li>Обновлен универсальный формат обмена <code>Enterprise Data</code> до версии 1.10.6, в который добавлен документ <code>УдержанныйНДФЛ</code> для отражения сведений о Едином Налоговом Платеже (ЕНП).</li>
</ul>
<!--Локализация-->
<h4 id="с-версии-3.1.6.198-и-меньше">С версии 3.1.6.198 и меньше</h4>
<h5 id="электронная-подпись-5">Электронная подпись</h5>
<p>Константу <code>АккредитованныеУдостоверяющиеЦентры</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ). <!--Конец локализация--></p>
<h4 id="с-версии-3.1.6.180-и-меньше">С версии 3.1.6.180 и меньше</h4>
<h5 id="обновление-версии-иб-3">Обновление версии ИБ</h5>
<ul>
<li>Автоматическое выполнение обработчиков начального заполнения данных для новых подсистем, которых ранее не было в конфигурации, при переходе с другой программы по умолчанию отключено, для задействования возможности необходимо в процедуре <code>ПриДобавленииПодсистемы</code> общего модуля <code>ОбновлениеИнформационнойБазы&lt;Сокращение&gt;</code> указать свойство <code>ЗаполнятьДанныеНовыхПодсистемПриПереходеСДругойПрограммы</code>.</li>
<li>Также можно точечно отключить отдельные обработчики, которые не требуется выполнять, установив для них свойство <code>НеВыполнятьПриПереходеСДругойПрограммы</code> в значение <code>Истина</code>.</li>
</ul>
<h4 id="с-версии-3.1.6.159-и-меньше">С версии 3.1.6.159 и меньше</h4>
<h5 id="организации-1">Организации</h5>
<ul>
<li>В общем модуле <code>ОрганизацииПереопределяемый</code> процедура <code>ПриОпределенииРегистрационныхДанныхИностраннойОрганизации</code> переименована в <code>ПриОпределенииРегистрационныхДанныхОтделенияИностраннойОрганизации</code>.</li>
</ul>
<h4 id="с-версии-3.1.6.118-и-меньше">С версии 3.1.6.118 и меньше</h4>
<h5 id="электронная-подпись-6">Электронная подпись</h5>
<p>В планы обмена РИБ включить новые константы <code>АдресаСерверовМетокВремени</code>, <code>ДобавлятьМеткиВремениАвтоматически</code>, <code>ТипПодписиКриптографииПоУмолчанию</code>, <code>УсовершенствоватьПодписиАвтоматически</code>, <code>УсовершенствоватьПодписиСДаты</code>. Включить в обработчики регистрации изменений планов обмена РИБ. Перенести в конфигурацию соответствующие изменения из формы <code>ОбщиеНастройки</code> обработки <code>ПанельАдминистрированияБСП</code>.</p>
<h2 id="версия-3.1.5">Версия 3.1.5</h2>
<p>Версия 3.1.5 предназначена для разработки на платформе <strong>1С:Предприятие</strong> в режиме совместимости с версиями 8.3.14, 8.3.15, 8.3.16 или 8.3.17, т.е.:</p>
<ul>
<li>8.3.14, если в свойстве <code>Режим совместимости</code> установлено значение <code>Не использовать</code>;</li>
<li>8.3.15, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code> или <code>Не использовать</code>;</li>
<li>8.3.16, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Не использовать</code>;</li>
<li>8.3.17, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code>, <code>Версия 8.3.16</code> или <code>Не использовать</code>;</li>
<li>8.3.18 и выше, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code>, <code>Версия 8.3.16</code> или <code>Версия 8.3.17</code>.</li>
</ul>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.5</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.5">Новые возможности и изменения в версии 3.1.5</h3>
<!--Локализация-->
<p>В состав библиотеки включена новая подсистема <strong>Электронная облачная подпись</strong>, которая расширяет возможности подсистемы <strong>Электронная подпись</strong>. С ее помощью все основные операции подписи и шифрования выполняются в облачном сервисе <strong>КриптоПро DSS</strong> (<a href="https://www.cryptopro.ru/products/dss">см. страничку продукта на сайте КриптоПро</a>).</p>
<p>Организованное таким способом централизованное защищенное хранение закрытых ключей пользователей позволяет отказаться от установки средств криптографии на компьютерах и имеет сертификат соответствия требованиям ФСБ России для работы с квалифицированной электронной подписью.</p>
<p>В подсистеме предусмотрена проверка действительности сертификатов и электронных подписей документов с использованием сервиса <strong>КриптоПро SVS</strong> (<a href="https://www.cryptopro.ru/products/pki/verify">см. страничку продукта на сайте КриптоПро</a>). Поддержка этого сервиса позволяет организовать полноценную работу с электронной подписью, не устанавливая средства криптографии на компьютеры пользователей. Предварительная настройка подсистемы выполняется в разделе <strong>Администрирование – Общие настройки – Электронная подпись и шифрование.</strong> Для разработчиков программный интерфейс подсистемы Электронная подпись не претерпел изменений, и использование новой подсистемы проходит прозрачно.<!--Конец локализация--></p>
<h4 id="варианты-отчетов-4">Варианты отчетов</h4>
<ul>
<li>Для экономии экранного места по вертикали и более оптимального задействования распространенных широкоформатных мониторов шапка отчетов стала компактнее. Поля размещены в трех колонках, а заголовки полей - внутри полей в подсказках ввода.
<ul>
<li>Состав полей в шапке отчета можно перенастроить по кнопке в правом верхнем углу шапки отчета.</li>
</ul></li>
<li>Справа в шапке отчета выводится строка фильтра и автосуммы.
<ul>
<li>С ее помощью теперь можно быстро добавлять новые фильтры по точному значению или фрагменту значения любого из полей, выведенных в отчет. Например, чтобы быстро установить фильтр по значению <strong>Розничный склад</strong>, достаточно ввести фрагмент <strong>роз</strong> и программа сама предложит варианты фильтров.</li>
<li>Кроме того, можно добавлять фильтры с условиями, например, <strong>Остатки</strong> &gt; 500.</li>
</ul></li>
<li>При добавлении нового фильтра, поля или сортировки в отчет предусмотрено поле для поиска по наименованию поля. Это особенно удобно, когда список доступных полей длинный.</li>
<li>Сохранить вариант отчета теперь можно за одну кнопку - см. новый пункт меню <strong>Сохранить</strong> в форме отчета. Для задания дополнительных параметров, таких как, наименование, размещение и доступность сохраняемого варианта отчета, рядом доступна прежняя команда <strong>Сохранить как…</strong>.</li>
<li>В случае если отчет содержит несколько уровней группировок, то в подменю <strong>Разворачивать до</strong> и в контекстном меню <strong>Уровни группировок</strong> для наглядности выводятся заголовки этих группировок. Например, если в отчете иерархия из трех группировок <strong>Организация</strong>, <strong>Счет</strong> и <strong>Валюта</strong>, то в подменю выводятся три одноименных пункта вместо прежних <strong>Уровень 1</strong>, <strong>Уровень 2</strong> и <strong>Уровень 3</strong>.</li>
<li>Пункт меню формы отчета <strong>Еще - Прочее - Изменить вариант отчета…</strong> перенесен в форму настроек отчета в <strong>Еще - Настройки для технического специалиста…</strong>, созвучно системной команде <strong>Функции для технического специалиста…</strong> в главном меню.</li>
<li>Подменю формы отчета <strong>Еще - Прочее</strong> переименовано в <strong>Еще - Персональные настройки</strong> и содержит теперь только релевантные команды <strong>Выбрать настройки…</strong>, <strong>Сохранить настройки…</strong> и <strong>Поделиться настройками…</strong>.</li>
</ul>
<h4 id="завершение-работы-пользователей">Завершение работы пользователей</h4>
<ul>
<li>Для того чтобы возможности администратора по установке блокировки работы с программой из командной строки не уступали интерактивным возможностям программы, параметр командной строки <code>ЗавершитьРаботуПользователей</code> расширен свойствами:
<ul>
<li><code>ИмяАдминистратора</code> - имя администратор кластера серверов 1С;</li>
<li><code>ПарольАдминистратора</code> - пароль администратор кластера серверов 1С;</li>
<li><code>Сообщение</code> - текст сообщения, выдаваемого пользователям в качестве предупреждения о планируемой блокировке соединений;</li>
<li><code>КодРазрешения</code> - произвольная строка для входа в программу, несмотря на установленную блокировку (для параметра запуска <code>/UC</code>);</li>
<li><code>ОжиданиеМин</code> - время отсрочки начала блокировки программы, в минутах;</li>
<li><code>ДлительностьМин</code> - длительность блокировки программы с учетом отсрочки, в минутах. Например: <code>1С 1cv8.exe" ENTERPRISE /F "&lt;Путь к информационной базе&gt;" /N "Администратор" /P /C "ЗавершитьРаботуПользователей, ИмяАдминистратора=Администратор, ПарольАдминистратора=1, Сообщение=Необходимо завершить работу в программе для внепланового обновления, КодРазрешения=Обновление, ОжиданиеМин=5, ДлительностьМин=30</code></li>
</ul></li>
</ul>
<h4 id="обмен-данными-6">Обмен данными</h4>
<ul>
<li>Если в программе настроена синхронизация данных в распределенной информационной базе, то теперь расширения конфигурации, подключенные в главном узле, автоматически передаются и устанавливаются во все подчиненные узлы. Для этого в подчиненном узле достаточно перейти в <strong>Настройки синхронизации данных</strong>, нажать ссылку <strong>Установить обновление</strong> и следовать инструкциям помощника обновления (как при получении изменений конфигурации из главного узла).</li>
<li>Обратите внимание, что перед обновлением на новую версию программы в главном и периферийных узлах не должно быть расширений, меняющих структуру данных. Также следует удалить из периферийных информационных баз расширения, имена которых совпадают с расширениями в главном узле (кроме патчей). Добавлять расширения можно после обновления всех периферийных баз.</li>
<li>Улучшен интерфейс формы списка настроенных синхронизаций. Удалены избыточные команды, а группировка команд списка настроек направлена на выполнение синхронизации.</li>
<li>Улучшена работа с предупреждениями синхронизации данных:
<ul>
<li>Переход к списку предупреждений происходит непосредственно из строки синхронизации, что позволяет отображать информацию только по текущей синхронизации. Теперь можно быстро оценить состояние конкретной синхронизации, просто переходя в список предупреждений;</li>
<li>Перечень предупреждений выводится единым списком и максимально вариативен за счет предоставляемых отборов. В связи с этим улучшена оперативная работа, например, можно быстро найти все предупреждения, которые относятся к определенному объекту;</li>
<li>Каждый вид предупреждений выводится в отдельной форме, которая сопровождается подробной подсказкой: что это за предупреждение, вероятная причина возникновения, как исправить. Тем самым, можно отработать часть предупреждений без привлечения квалифицированных специалистов;</li>
<li>В предупреждениях синхронизации теперь можно добавлять комментарий. Это полезно при совместной работе или если при работе с предупреждением синхронизации требуется оставить заметку на будущее;</li>
<li>Появилась возможность удаления предупреждений, которые накопились в результате предыдущих синхронизаций, но при этом потеряли свою актуальность. Например, если все проблемы исправлены внешней обработкой, но при этом остались предупреждения, которые более не несут смысловую нагрузку, то теперь можно быстро их удалить.</li>
</ul></li>
</ul>
<h4 id="работа-с-файлами">Работа с файлами</h4>
<ul>
<li>При работе программы в томах с файлами могут оставаться файлы, не привязанные ни к одному присоединенному файлу в информационной базе. Теперь при очистке ненужных файлов такие файлы всегда будут удаляться вместе с ненужными файлами.</li>
<li>При настройке очистки ненужных файлов стало возможным выбрать какие файлы очищать:
<ul>
<li>только файлы, не привязанные к присоединенным файлам в информационной базе</li>
<li>файлы, не привязанные к присоединенным файлам в информационной базе, и ненужные файлы.</li>
</ul></li>
<li>При очистке ненужных файлов их данные очищались, а сами присоединенные файлы помечались на удаление. Теперь ненужные файлы удаляются сразу вместе с данными, если есть такая возможность.</li>
</ul>
<h4 id="управление-доступом-2">Управление доступом</h4>
<ul>
<li>Повышена эффективность работы с программой при включенных ограничениях доступа к данным (RLS): в ряде случаев ускорено обновление прав доступа до 20%, а также до трех раз сокращен объем служебных данных в информационной базе, которые теперь зависят от фактического использования видов доступа в группах доступа. Эффект тем больше, чем меньше видов доступа реально задействовано, например, если в программе предусмотрено всего 15 видов доступа, а реально используются только два из них.</li>
</ul>
<h4 id="учет-оригиналов-первичных-документов">Учет оригиналов первичных документов</h4>
<ul>
<li>Для получения актуальной информации о состояниях оригиналов в форме <strong>Изменение состояния оригинала документа</strong> (открывается из форм списков по ссылке в колонке <strong>Состояние оригинала - Уточнить по печатным формам…</strong> или по ссылке из форм документов <strong>Состояние оригинала - Уточнить по печатным формам…</strong>) размещены дополнительные сведения о дате и авторе изменения текущего состояния;</li>
<li>Отслеживание состояний первичных документов только по определенным печатным формам документа. Данная возможность может быть полезна, если документ имеет множество печатных форм, но только в одной требуется подпись сотрудника и только по ней следует отслеживать состояние;</li>
<li>Для упрощения учета оригиналов первичных документов, где требуется подпись нескольких сотрудников, предусмотрено отслеживание состояний печатных форм документа по сотрудникам.</li>
</ul>
<h4 id="электронная-подпись-7">Электронная подпись</h4>
<!--Локализация-->
<ul>
<li>В связи с вступлением в силу с 01.01.2022 федерального закона от 27.12.2019 № 476-ФЗ “О внесении изменений в Федеральный закон «Об электронной подписи»”, удостоверяющий центр ООО «Научно-производственный центр “1С”» переходит к выпуску квалифицированных сертификатов только для физических лиц, включая сертификаты для сотрудников. С 01.04.2021 появится возможность оформить заявление на сертификат для физического лица так же просто, как для организаций. Для этого достаточно нажать <strong>Добавить</strong> - <strong>Заявление на выпуск сертификата</strong> в списке <strong>Настройки электронной подписи и шифрование</strong> (<strong>Мои настройки</strong> или <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Электронная подпись и шифрование</strong>) и вместо варианта <strong>Организация</strong> выбрать <strong>Физическое лицо</strong>.</li>
<li>Подача заявлений на выпуск сертификатов и создание подписей для национальной системы маркировки товаров теперь возможно при работе в операционных системах Linux и macOS (ранее только в Windows), а также в большем количестве веб-браузеров. Кроме того, количество предложений об установке внешних компонент сокращено с двух до одного, что позволяет быстрее получить результат.<!--Конец локализация--></li>
<li>Можно указывать несколько пользователей, для которых сертификат будет считаться «личным». Для этого в форме <strong>Сертификаты ключей электронной подписи и шифрования</strong> в поле <strong>Пользователь</strong> открывается выбора списка пользователей.</li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.5">Новые возможности для разработчиков в версии 3.1.5</h3>
<h4 id="базовая-функциональность-9">Базовая функциональность</h4>
<ul>
<li>Нередко, например, при парсинге текста или анализе значений ячеек табличного документа, возникает необходимость приведения строкового литерала к дате. Для данных целей в программном интерфейсе общего модуля <code>ОбщегоНазначенияКлиентСервер</code> реализована функция <code>СтрокаВДату</code>.</li>
<li>Аналогично, для определения, является ли строковый литерал числом, в программном интерфейсе общего модуля <code>ОбщегоНазначенияКлиентСервер</code> реализована функция <code>ЭтоЧисло</code>.</li>
<li>В некоторых сценариях, например, в финансовых отчетах, необходимо вывести нестандартное представление периода:
<ul>
<li>1 полугодие 2021 г. – вместо 01.01.2021 – 30.06.2021;</li>
<li>9 месяцев 2021 г. - вместо 01.01.2021 – 30.09.2021;</li>
<li><strong>за все время</strong> - вместо пустого значения;</li>
<li>начиная со строчной. Для этого в программном интерфейсе общих модулей <code>СтроковыеФункции</code> и <code>СтроковыеФункцииКлиент</code> реализована функция <code>ПредставлениеПериодаВТексте</code>.</li>
</ul></li>
<li>Для обмена сообщениями по «Интеграционной шине» реализовано регламентное задание <code>ОбработкаСервисовИнтеграции</code>, которое требуется включить при задействовании данной возможности. Подробнее о продукте см. «<a href="https://wonderland.v8.1c.ru/blog/integratsionnaya-shina/">Интергационная шина</a>».</li>
<li>В некоторых случаях конфигурация может не содержать в имени слово <strong>Базовая</strong>, но при этом она является базовой версией. В подобных случаях признак можно переопределить в процедуре <code>ПриОпределенииПризнакаЭтоБазоваяВерсияКонфигурации</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>. Он влияет на корректную работу различных механизмов конфигурации, таких как работа с внешним соединением (COM) и другие.</li>
<li>В функцию <code>РасчетныеПоказателиЯчеек</code> общего модуля <code>ОбщегоНазначенияКлиентСервер</code> добавлен необязательный параметр <code>ПараметрыРасчета</code> типа возвращаемого значения функции <code>ПараметрыРасчетаПоказателейЯчеек</code> общего модуля <code>ОбщегоНазначенияКлиентСервер</code>. В новом параметре свойство <code>РассчитатьНаСервере</code> позволяет разработчику явно указать, выполнять расчет на сервере или на клиенте, вместо автоопределения.</li>
</ul>
<h4 id="варианты-отчетов-5">Варианты отчетов</h4>
<ul>
<li>При анализе данных отчетов бухгалтерского учета специалисты оперируют финансовыми периодами: 1 квартал, 3 квартал, полугодие, 9 месяцев и т.д. Для этого при разработке отчета можно изменить (переопределить) форму выбора периода:
<ul>
<li><p>В процедуре <code>ОпределитьНастройкиФормы</code> модуля отчета значение свойства <code>Настройки.ВариантПериода</code> изменить на <code>Финансовый</code>:</p>
<pre class="1с"><code>Настройки.ВариантПериода = Перечисления.ВариантыПериода.Финансовый;</code></pre></li>
</ul></li>
<li>Также для удобства, при работе с финансовыми периодами можно переопределить представление периода:
<ul>
<li>В процедуре <code>ОпределитьНастройкиФормы</code> модуля объекта, значение свойства настроек <code>ВариантПредставленияПериода</code> изменить на <code>Гиперессылка</code>: <code>1С     Настройки.ВариантПредставленияПериода = Перечисления.ВариантыПредставленияПериода.Гиперессылка;</code></li>
</ul></li>
</ul>
<h4 id="завершение-работы-пользователей-1">Завершение работы пользователей</h4>
<ul>
<li>Для завершения работы пользователей в программе при установке блокировки сеансов с информационной базой программный интерфейс общего модуля <code>СоединенияИБКлиент</code> дополнен процедурами <code>УстановитьРежимЗавершенияРаботыПользователей</code> и <code>УстановитьПризнакЗавершитьВсеСеансыКромеТекущего</code>. Подробнее см. в комментарии к ним.</li>
</ul>
<h4 id="загрузка-данных-из-файла">Загрузка данных из файла</h4>
<ul>
<li>В случаях когда требуется переопределить представление справочника, в который загружаются табличные данные, в процедуре <code>ОпределитьПараметрыЗагрузкиДанныхИзФайла</code> модуля менеджера справочника можно задавать значение нового свойства <code>ПредставлениеОбъекта</code> параметра <code>Параметры</code>. Например, загрузка данных выполняется в справочник <strong>Контрагенты</strong>, но вместо этого необходимо отобразить <strong>Клиент</strong>. Пример см. в демонстрационной конфигурации в модуле менеджере справочника <code>_ДемоНоменклатура</code>.</li>
<li>Для улучшения документирующих комментариев в программном интерфейсе общего модуля <code>ЗагрузкаДанныхИзФайла</code> предусмотрены функции-конструкторы <code>НастройкиЗагрузкиДанных</code>, <code>ОписаниеЗагружаемыхДанныхДляСправочников</code>, <code>НовыйСписокНеоднозначностей</code>, <code>ТаблицаСопоставления</code>. Подробнее см. в демонстрационной конфигурации в модуле менеджера справочника <code>_ДемоНоменклатура</code>.</li>
</ul>
<h4 id="запрет-редактирования-реквизитов-объектов">Запрет редактирования реквизитов объектов</h4>
<ul>
<li>Теперь, когда требуется разблокировать сразу и невидимые реквизиты (например, зависимые от видимых) можно просто передать <code>Ложь</code> в новый параметр <code>ТолькоВидимые</code> процедуры <code>РазрешитьРедактированиеРеквизитовОбъекта</code> общего модуля <code>ЗапретРедактированияРеквизитовОбъектовКлиент</code>. Однако для пользователя может быть неожиданным то, что в списке реквизитов есть такие, которые не удается найти на форме (они не видимы).</li>
</ul>
<h4 id="обмен-данными-7">Обмен данными</h4>
<ul>
<li><p>Обновлен универсальный формат обмена <code>Enterprise Data</code> до версии 1.10.6, в который добавлен документ <code>УдержанныйНДФЛ</code> для отражения сведений о Едином Налоговом Платеже (ЕНП).</p></li>
<li><p>В версии 1.11.5 универсального формата обмена <code>Enterprise Data</code> реализованы следующие возможности:</p>
<ul>
<li>Начиная с версии ФФД 1.2, коды маркировки по некоторым товарным группам (духи, АТП (сигары)) могут быть переданы в ККТ с дополнительными параметрами, указывающими, какая часть маркируемой единицы подлежит выбытию;</li>
<li>теперь в правилах конвертации можно передать признак договора <strong>Организация выступает в качестве налогового агента по уплате НДС</strong>;</li>
<li>добавлены свойства, которые позволяют в правилах конвертации обмениваться информацией о <strong>Резервах по оплате труда</strong>;</li>
<li>расширили значения перечислений <strong>Виды продукции ИС</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ ИсполнительныйЛист</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ УдержанныйНДФЛ</strong>. Документ может использоваться при передаче сведений об Едином Налоговом Платеже (ЕНП);</li>
<li>свойства справочника <code>Договоры</code> расширено полем <code>ИдентификаторГосКонтракта</code>, что позволяет синхронизировать информацию о государственных контрактах между приложениями;</li>
<li>для ФСС в объект формата <strong>Справочник номенклатура</strong> добавлено необязательное свойство <code>КодТРУ</code>, дополнительно формат расширен новым перечислением <code>ТипыПлатежнойСистемыККТ</code>;</li>
<li>свойства объекта формата <strong>Справочник Организации</strong> расширены необязательным полем <strong>Валюта регламентированного учета</strong>;</li>
<li>в объекте формата <strong>Справочник Патенты</strong> поля <code>КБК</code> и <code>ПотенциальноВозможныйГодовойДоход</code> стали необязательными. Это расширяет возможность конвертации справочника из программ, где патенты учитываются в урезанном виде;</li>
<li>исправлены выявленные ошибки.</li>
</ul></li>
<li><p>Для записи узла обмена при помощи длительной операции, необходимо в обработчик события формы <code>ПередЗаписью</code> добавить вызов процедуры <code>ОбменДаннымиКлиент.ПередЗаписью</code>. При этом необходимо убедится, что в последующих процедурах, таких как <code>ПриЗаписи</code>, не происходит изменения данных узла. Например, см. план обмена <code>_ДемоСинхронизацияДанныхЧерезУниверсальныйФормат</code> в демонстрационной конфигурации.</p></li>
<li><p>При разработке правил для универсального обмена данными рекомендуется использовать функцию <code>ОбменДаннымиXDTO.КлассКлючевыеСвойства</code> для обращения к ключевым свойствам объекта.</p>
<p>Например:</p>
<pre><code>КлючевыеСвойства = ОбменДаннымиXDTOСервер.КлассКлючевыеСвойства();
Код = Лев(ДанныеИБ.Наименование, 4);
Если СтекВыгрузки.Количество() = 1 Тогда
  ДанныеXDTO[КлючевыеСвойства].Вставить(&quot;Код&quot;, Код);
Иначе
  ДанныеXDTO.Вставить(&quot;Код&quot;, Код);
КонецЕсли;</code></pre></li>
</ul>
<h4 id="обновление-версии-иб-4">Обновление версии ИБ</h4>
<ul>
<li>Процедура <code>ПриФормированиеСпискаРазрабатываемыхПодсистем</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> устарела, вместо нее следует использовать процедуру <code>ПриФормированииСпискаРазрабатываемыхПодсистем</code> этого же модуля.</li>
</ul>
<h4 id="печать-3">Печать</h4>
<ul>
<li>Для улучшения документирующих комментариев в программном интерфейсе общего модуля <code>УправлениеПечатьюКлиент</code> предусмотрена функция-конструктор <code>ОписаниеПараметровПечати</code>. Подробнее см. в демонстрационной конфигурации в модуле формы <code>ОсновнаяФорма</code> справочника <code>_ДемоОрганизации</code>.</li>
</ul>
<h4 id="регламентные-задания">Регламентные задания</h4>
<ul>
<li>Для управления работой различных механизмов при блокировке и разблокировке работы с внешними ресурсами в программе можно использовать новые процедуры <code>ПриЗапретеРаботыСВнешнимиРесурсами</code> и <code>ПриРазрешенииРаботыСВнешнимиРесурсами</code> общего модуля <code>БлокировкаРаботыСВнешнимиРесурсамиПереопределяемый</code>. Подробнее про блокировку работы с внешними ресурсами см. в документации - <strong>Глава 5. Пользовательская документация</strong> - раздел <strong>5.53 Регламентные задания</strong> - <strong>Особенности выполнения регламентных заданий при копировании информационной базы</strong>.</li>
</ul>
<h4 id="управление-доступом-3">Управление доступом</h4>
<ul>
<li>Для поставки профилей групп доступа в конфигурации теперь необязательно создавать предопределенные элементы в справочнике <code>ПрофилиГруппДоступа</code>, а достаточно только перечислить их в процедуре <code>ПриЗаполненииПоставляемыхПрофилейГруппДоступа</code> общего модуля <code>УправлениеДоступомПереопределяемый</code>. Кроме того, с ее помощью можно также задавать папки (группы справочника <code>ПрофилиГруппДоступа</code>) с поставляемыми профилями групп доступа.
<ul>
<li>Созданные ранее предопределенные элементы и папки рекомендуется удалить. При этом профили будут сопоставлены по идентификатору поставляемых данных, а папки профилей в первый раз будут сопоставлены по наименованию, а в дальнейшем также по идентификатору поставляемых данных. См. примеры в демонстрационной конфигурации и документации.</li>
<li>Вместо обращения к предопределенным элементам <code>Администратор</code> справочника <code>ПрофилиГруппДоступа</code> и <code>Администраторы</code> справочника <code>ГруппыДоступа</code> рекомендуется вызывать, соответственно, функции <code>ПрофильАдминистратор</code> и <code>ГруппаДоступаАдминистраторы</code> общего модуля <code>УправлениеДоступом</code>.</li>
</ul></li>
<li>При разработке логики ограничения в процедурах <code>ПриЗаполненииОграниченияДоступа</code> модулей менеджеров объектов метаданных для некоторых редких случаев, когда список элементов зависит от прав на некоторый технологический объект, теперь можно использовать функции <code>ПравоДоступа</code> и <code>РольДоступна</code>. Подробнее см. в документации.</li>
</ul>
<h4 id="учет-оригиналов-первичных-документов-1">Учет оригиналов первичных документов</h4>
<ul>
<li><p>Отслеживание состояний первичных документов только по определенным печатным формам документа. Данная возможность может быть полезна, если документ имеет множество печатных форм, но только в одной требуется подпись сотрудника и только по ней следует отслеживать состояние. Для этого в программном интерфейсе общего модуля <code>УчетОригиналовПервичныхДокументовПереопределяемый</code> добавлена процедура переопределения списка отслеживаемых печатных форм документа;</p>
<ul>
<li><code>ЗаполнитьТаблицуУчетаОригиналов</code>.</li>
</ul></li>
<li><p>Отслеживание состояний печатных форм по сотрудникам в документах, где требуется подпись нескольких сотрудников. Для этого в программном интерфейсе:</p>
<ul>
<li>общего модуля <code>УчетОригиналовПервичныхДокументовПереопределяемый</code> добавлена процедура переопределения списка “многосотрудниковых” документов<code>ПриОпределенииМногосотрудниковыхДокументов</code>;</li>
<li>модуле менеджера регистра сведений <code>СостоянияОригиналовПервичныхДокументов</code>, у процедуры <code>ЗаписатьСостояниеОригиналаДокументаПоПечатнымФормам</code> добавлен параметр <code>Сотрудник</code>.</li>
</ul></li>
<li><p>В случаях, когда требуется отслеживание статуса записи изменившегося состояния оригинала в программном интерфейсе общего модуля <code>УчетОригиналовПервичныхДокументовКлиент</code>, <code>УчетОригиналовПервичныхДокументовВызовСервера</code> и модуле менеджера регистра сведений <code>СостоянияОригиналовПервичныхДокументов</code> у процедур <code>ЗаписатьСостоянияОригиналовПослеПечати</code> и <code>ЗаписатьСостоянияОригиналовДокументаПослеПечатиФормы</code> предусмотрен параметр признака записи <code>Записано</code>.</p>
<p>Подробности см. в документации.</p></li>
</ul>
<h4 id="шаблоны-сообщений">Шаблоны сообщений</h4>
<ul>
<li>В случаях, когда требуется отслеживание статуса отправки исходящего письма в программном интерфейсе общего модуля <code>ШаблоныСообщений</code> у функции <code>СформироватьСообщениеИОтправить</code> в возвращаемом значении предусмотрено свойство <code>СсылкаНаПисьмо</code>.</li>
<li>Для улучшения документирующих комментариев в программном интерфейсе общего модуля <code>ШаблоныСообщений</code> предусмотрена функция-конструктор <code>ПараметрыОтправкиПисьмаПоШаблону</code>. Подробнее см. в комментарии к ней.</li>
</ul>
<h4 id="электронная-подпись-8">Электронная подпись</h4>
<ul>
<li>Для повышения скорости проверки и создания электронных подписей XMLDSig с помощью процедур <code>Подписать</code> и <code>ПроверитьПодпись</code> общих модулей <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code> предусмотрено автоматическое определение параметров XMLDSig из передаваемого конверта XML. Для этого нужно оставить незаполненными свойства <code>XPathSignedInfo</code> и <code>XPathПодписываемыйТег</code> структуры, возвращаемой функцией <code>ПараметрыXMLDSig</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code>.</li>
<li>Для упрощения создания электронных подписей XMLDSig в типовых сценариях добавлена функция <code>КонвертXML</code> в общие модули <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code>. В описании функции указан подробный состав возможностей, предусмотренных для XML документа, которые следует учитывать при использовании различных форматов документа XML.</li>
<li>Теперь можно создавать и проверять подписи XMLDSig не только с алгоритмом канонизации <strong>Exclusive XML Canonicalization 1.0</strong>, но и с алгоритмами <strong>Canonical XML 1.0</strong> и <strong>Canonical XML 1.1</strong> (для всех трех алгоритмов поддерживается вариант <strong>WithComments</strong>). <!--Локализация-->Кроме того, для работы с государственными и муниципальными сервисами такими как, <strong>ГИИС ДМДК</strong> и аналогичными, предусмотрен алгоритм канонизации Единой системы межведомственного электронного взаимодействия (СМЭВ) <strong>urn://smev-gov-ru/xmldsig/transform</strong>.<!--Конец локализация--></li>
</ul>
<h3 id="переход-на-версию-3.1.5-с-версии-3.1.4">Переход на версию 3.1.5 с версии 3.1.4</h3>
<h4 id="обязательные-действия-по-переходу-2">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения (см. <a href="https://its.1c.ru/db/bspdoc">главу 2 Инструкция по внедрению библиотеки</a>).</p>
<p>Для обновления следующих переопределяемых общих модулей требуется перенести из поставки библиотеки новые экспортные процедуры, удалить отсутствующие и убедиться, что комментарии, количество и имена параметров у процедур совпадают с поставкой библиотеки:</p>
<ul>
<li><code>БизнесПроцессыИЗадачиКлиентПереопределяемый</code>,<br />
</li>
<li><code>ДополнительныеОтчетыИОбработкиПереопределяемый</code>,</li>
<li><code>ЗаполнениеОбъектовПереопределяемый</code>,</li>
<li><code>ОбновлениеИнформационнойБазыПереопределяемый</code>,</li>
<li><code>ОтчетыПереопределяемый</code>,</li>
<li><code>ПодключаемыеКомандыПереопределяемый</code>,</li>
<li><code>ПолнотекстовыйПоискСерверПереопределяемый</code>,</li>
<li><code>РаботаСПочтовымиСообщениямиПереопределяемый</code>,</li>
<li><code>РаботаСФайламиПереопределяемый</code>,</li>
<li><code>СозданиеНаОснованииПереопределяемый</code>,</li>
<li><code>СтруктураПодчиненностиПереопределяемый</code>,</li>
<li><code>ТекущиеДелаПереопределяемый</code>,</li>
<li><code>УправлениеПечатьюПереопределяемый</code>,</li>
<li><code>УчетОригиналовПервичныхДокументовПереопределяемый</code>.</li>
</ul>
<p>Рекомендации по задействованию новых возможностей переопределяемых общих модулей приведены выше в разделе <strong>Новые возможности для разработчиков</strong>.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки. В исключительных (редких) случаях, когда такая совместимость не обеспечена, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки, в этом разделе приведены необходимые инструкции. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h4 id="варианты-отчетов-6">Варианты отчетов</h4>
<ul>
<li>Процедура <code>ДополнитьСвязиОбъектовМетаданных</code> общего модуля <code>ОтчетыПереопределяемый</code> удалена, т.к. более не востребована.</li>
</ul>
<h5 id="взаимодействия-1">Взаимодействия</h5>
<ul>
<li>Если подсистема <code>Взаимодействия</code> внедрена без подсистемы <code>УправлениеДоступом</code>, следует удалить подписку <code>ЗаполнитьНаборыЗначенийДоступаТабличныхЧастейДокументовВзаимодействия</code>, так как она переименована в <code>ЗаполнитьНаборыЗначенийДоступаТабличныхЧастейДокументов</code>, исключена из подсистемы <code>Взаимодействия</code> и включена в подсистему <code>УправлениеДоступом</code>.</li>
</ul>
<h5 id="обмен-данными-8">Обмен данными</h5>
<ul>
<li>Функции <code>КоличествоНерассмотренныхПроблем</code> и <code>СтруктураЗаголовкаГиперссылкиМонитораПроблем</code> общего модуля <code>ОбменДаннымиСервер</code> отмечены как устаревшие, т.к. более не востребованы.</li>
<li>Константу <code>ЗагрузитьРасширенияИзменяющиеСтруктуруДанных</code> запрещено включать в планы обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="пользователи-4">Пользователи</h5>
<ul>
<li>Пересмотреть прикладную логику, которая зависит от наличия ограничения на уровне записей на регистр сведений СоставыГруппПользователей (ограничение было удалено в целях повышения производительности, что допустимо т.к. для обеспечения секретности и прикладной логики достаточно ограничения справочников).</li>
</ul>
<h4 id="работа-с-файлами-1">Работа с файлами</h4>
<ul>
<li>Константы <code>РежимОчисткиФайлов</code>, <code>ПутьКТомуБезУчетаРегиональныхНастроек</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="управление-доступом-4">Управление доступом</h5>
<ul>
<li>В планы обмена РИБ включить новые регистры сведений <code>ИспользуемыеВидыДоступа</code>, <code>ИспользуемыеВидыДоступаПоТаблицам</code>. В обработчики регистрации изменений планов обмена РИБ включить только регистр сведений <code>ИспользуемыеВидыДоступа</code>.</li>
<li>Удалить созданные подписки на события <code>ЗаполнитьНаборыЗначенийДоступаТабличныхЧастей&lt;Окончание&gt;</code>, а их типы перенести в новый определяемый тип <code>ВладелецСОграничениемПоНаборамЗначенийДоступаДокумент</code>. Если документов нет, то в новом определяемом типе нужно указать тип <code>СправочникОбъект.ИдентификаторыОбъектовМетаданных</code>.</li>
<li>Удалить созданные подписки на события <code>ЗаписатьНаборыЗначенийДоступа&lt;Окончание&gt;</code>, а их типы перенести в определяемый тип <code>ВладелецНаборовЗначенийДоступаОбъект</code>.</li>
<li>Удалить созданные подписки на события <code>ЗаписатьЗависимыеНаборыЗначенийДоступа&lt;Окончание&gt;</code>, а их типы перенести в определяемый тип <code>ВладелецВнешнихЗначенийВНаборахЗначенийДоступаОбъект</code>.</li>
<li>Во всех регистрах сведений (включая библиотечные) имя которых начинается с <code>КлючиДоступаКРегистру</code>, переименовать измерение <code>ДляВнешнихПользователей</code> в <code>ВариантДоступа</code> и установить все его свойства (включая тип), как у измерения <code>ВариантДоступа</code> регистра сведений <code>КлючиДоступаКРегистрам</code>. При повторном обновлении библиотек с версией БСП ниже 3.1.5, которые поставляют регистры сведений <code>КлючиДоступаКРегистру*</code>, операцию нужно повторить или не переносить свойства измерения <code>ВариантДоступа</code>.</li>
<li>Во всех ролях обновить стандартные шаблоны <code>ДляОбъекта</code>, <code>ДляРегистра</code> и ограничения доступа с этими шаблонами (реализованы улучшения). Кроме того, обновить стандартные шаблоны <code>ПоЗначениям</code>, <code>ПоЗначениямРасширенный</code>, <code>ПоЗначениямИНаборамРасширенный</code>, <code>ПоНаборамЗначений</code> (имена ресурсов прав служебных регистров были дополнены словом Право для корректности перевода). Для обновления шаблонов рекомендуется использовать отчет <code>ПроверкаВнедренияБСП.erf</code> в режиме исправления ошибок.</li>
</ul>
<h4 id="необязательные-действия-по-переходу-2">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="контактная-информация-1">Контактная информация</h5>
<!--Локализация-->
<ul>
<li>Функция <code>СтруктураКонтактнойИнформацииПоТипу</code> общего модуля <code>РаботаСАдресамиКлиентСервер</code> устарела. Вместо нее для получения полей адреса следует использовать функцию <code>ПоляАдреса</code> общего модуля <code>РаботаСАдресамиКлиентСервер</code>, а для получения полей телефона функцию <code>СведенияОТелефоне</code> общего модуля <code>УправлениеКонтактнойИнформацией</code>.<!--Конец локализация--></li>
<li>Второй параметр <code>ВидКонтактнойИнформации</code> функции <code>ПредставлениеКонтактнойИнформации</code> общего модуля <code>УправлениеКонтактнойИнформацией</code> устарел и игнорируется. Следует удалить его во всех местах вызова функции.</li>
</ul>
<h5 id="обмен-данными-9">Обмен данными</h5>
<ul>
<li>Для того чтобы расширения конфигурации, подключенные в главном узле РИБ, автоматически передавались и устанавливались во все подчиненные узлы, в планах обмена РИБ рекомендуется установить свойство <code>Включать расширения конфигурации</code>. Например, см. план обмена <code>_ДемоОбменВРаспределеннойИнформационнойБазе</code> в демонстрационной конфигурации.</li>
<li>При этом для планов обмена автономной работы в модели сервиса (АРМ) свойство <code>Включать расширения конфигурации</code> должно быть снято. Например, см. план обмена <code>_ДемоАвтономнаяРабота</code> в демонстрационной конфигурации.</li>
</ul>
<h5 id="электронная-подпись-9">Электронная подпись</h5>
<!--Локализация-->
<ul>
<li>Для поддержки удобного заполнения заявления для физического лица, которое будет доступно пользователям с 01.04.2021, рекомендуется реализовать заполнение новых свойств <code>ИНН</code>, <code>АдресРегистрации</code> и <code>Телефон</code> в параметре <code>Параметры</code> процедуры <code>ПриЗаполненииРеквизитовВладельцаВЗаявленииНаСертификат</code>. См. пример в демонстрационной конфигурации в общем модуле <code>_ДемоСтандартныеПодсистемы</code>.</li>
<li>Для поддержки срока прекращения доступности заявления для организаций с 01.12.2021, при использовании процедуры <code>ДобавитьСертификат</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с целью создания нового заявления на сертификат для организации, требуется обеспечить управление видимостью этой команды с помощью функции <code>ДоступностьСозданияЗаявления</code> общего модуля <code>ЭлектроннаяПодпись</code>. Кроме того, следует реализовать команду добавления заявления для физического лица (также с управлением видимостью, для поддержки срока начала доступности заявления для физических лиц с 01.04.2021). См. пример в демонстрационной конфигурации в формах списков справочников <code>_ДемоОрганизации</code> и <code>_ДемоФизическиеЛица</code>.<!--Конец локализация--></li>
<li>Для повышения скорости проверки и создания электронных подписей XMLDSig с помощью процедур <code>Подписать</code> и <code>ПроверитьПодпись</code> общих модулей <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code> рекомендуется перейти на автоматическое определение параметров XMLDSig из передаваемого конверта XML. Для этого нужно оставить незаполненными свойства <code>XPathSignedInfo</code> и <code>XPathПодписываемыйТег</code> структуры, возвращаемой функцией <code>ПараметрыXMLDSig</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code>.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.5">Особенности обновления с ранних версий на версию 3.1.5</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.4) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <strong>Переход с предыдущих версий</strong> для каждой пропущенной версии.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.5">Переход на исправительные релизы 3.1.5</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.5.<strong>1</strong>, 3.1.5.<strong>20</strong>, 3.1.5.<strong>300</strong> из т.п. Для обновления на исправительные релизы предназначена внешняя обработка <strong>ОбновлениеНаИсправительнуюВерсиюБСП.epf</strong> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <strong>Обновить на исправительную версию</strong>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <strong>Сформировать файл настроек</strong> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <strong>ПроверкаВнедренияБСП.erf</strong>.</p>
<h4 id="с-версии-3.1.5.459-и-меньше">С версии 3.1.5.459 и меньше</h4>
<h5 id="обмен-данными-10">Обмен данными</h5>
<ul>
<li>В версии 1.11.5 универсального формата обмена <code>Enterprise Data</code> реализованы следующие возможности:
<ul>
<li>Начиная с версии ФФД 1.2, коды маркировки по некоторым товарным группам (духи, АТП (сигары)) могут быть переданы в ККТ с дополнительными параметрами, указывающими, какая часть маркируемой единицы подлежит выбытию;</li>
<li>теперь в правилах конвертации можно передать признак договора <strong>Организация выступает в качестве налогового агента по уплате НДС</strong>;</li>
<li>добавлены свойства, которые позволяют в правилах конвертации обмениваться информацией о <strong>Резервах по оплате труда</strong>;</li>
<li>расширили значения перечислений <strong>Виды продукции ИС</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ ИсполнительныйЛист</strong>;</li>
<li>в правилах конвертации доступен новый объект формата <strong>Документ УдержанныйНДФЛ</strong>. Документ может использоваться при передаче сведений об Едином Налоговом Платеже (ЕНП);</li>
<li>свойства справочника <code>Договоры</code> расширено полем <code>ИдентификаторГосКонтракта</code>, что позволяет синхронизировать информацию о государственных контрактах между приложениями;</li>
<li>для ФСС в объект формата <strong>Справочник номенклатура</strong> добавлено необязательное свойство <code>КодТРУ</code>, дополнительно формат расширен новым перечислением <code>ТипыПлатежнойСистемыККТ</code>;</li>
<li>свойства объекта формата <strong>Справочник Организации</strong> расширены необязательным полем <strong>Валюта регламентированного учета</strong>;</li>
<li>в объекте формата <strong>Справочник Патенты</strong> поля <code>КБК</code> и <code>ПотенциальноВозможныйГодовойДоход</code> стали необязательными. Это расширяет возможность конвертации справочника из программ, где патенты учитываются в урезанном виде;</li>
<li>исправлены выявленные ошибки.</li>
</ul></li>
</ul>
<h4 id="с-версии-3.1.5.426-и-меньше">С версии 3.1.5.426 и меньше</h4>
<h5 id="обмен-данными-11">Обмен данными</h5>
<ul>
<li>Обновлен универсальный формат обмена <code>Enterprise Data</code> до версии 1.10.6, в который добавлен документ <code>УдержанныйНДФЛ</code> для отражения сведений о Едином Налоговом Платеже (ЕНП).</li>
</ul>
<h4 id="с-версии-3.1.5.262-и-меньше">С версии 3.1.5.262 и меньше</h4>
<h5 id="обновление-версии-иб-5">Обновление версии ИБ</h5>
<ul>
<li><p>Добавлена возможность перехода на другую программу в модели сервиса, например Базовая -&gt; Проф или Проф -&gt; Корп. Для задействования данной возможности необходимо проанализировать обработчики перехода, указанные в процедуре <code>ПриДобавленииОбработчиковПереходаСДругойПрограммы</code> - если обрабатываются неразделенные данные, требуется установить новое свойство <code>ОбщиеДанные</code> в значение <code>Истина</code>.</p>
<p>Например:</p>
<pre><code>  Обработчик = Обработчики.Добавить();
  Обработчик.ПредыдущееИмяКонфигурации = &quot;*&quot;;
  Обработчик.ОбщиеДанные = Истина;
  Обработчик.Процедура = &quot;&lt;ИмяМодуля&gt;.&lt;ИмяПроцедурыОбработчикаНеразделенныхДанных&gt;&quot;;</code></pre></li>
</ul>
<h4 id="с-версии-3.1.5.221-и-меньше">С версии 3.1.5.221 и меньше</h4>
<!--Локализация-->
<h4 id="электронная-облачная-подпись">Электронная облачная подпись</h4>
<ul>
<li>Добавлена возможность использования REST API v2 КриптоПро DSS 2.0. В нем реализовано долговременное хранение документов, применение асинхронных операций, выполнение пакетных операций и другие функции. Также REST API v2 предполагает использование мобильных приложений, разработанных на базе DSS SDK, таких как <strong>myDSS 2.0</strong> и <strong>DSS Client</strong>. Для переключения на REST API v2 в карточке справочника <strong>Серверы облачной подписи</strong> необходимо установить значение в поле <strong>Версия API</strong> на 2.0.3284.</li>
</ul>
<h5 id="электронная-подпись-10">Электронная подпись</h5>
<p>Для конфигураций, имеющих в составе <a href="https://v8.1c.ru/tekhnologii/standartnye-biblioteki/1s-biblioteka-internet-podderzhki/">Библиотеку интернет-поддержки пользователей</a>, в процедуре <code>ПриОпределенииИспользуемыхВерсийВнешнихКомпонент</code> общего модуля <code>ПолучениеВнешнихКомпонентВМоделиСервисаПереопределяемый</code> вставить строки:</p>
<pre><code>Идентификаторы.Добавить(&quot;ExtraCryptoAPI&quot;);
Идентификаторы.Добавить(&quot;XMLDSignAddIn&quot;);</code></pre>
<!--Конец локализация-->
<h4 id="с-версии-3.1.5.208-и-меньше">С версии 3.1.5.208 и меньше</h4>
<h5 id="базовая-функциональность-10">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения <code>Нерекомендуемый состав ролей</code> подсистемы <code>Базовая функциональность</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.5.192-и-меньше">С версии 3.1.5.192 и меньше</h4>
<h5 id="работа-с-файлами-2">Работа с файлами</h5>
<ul>
<li>Добавлена константа <code>ПутьКТомуБезУчетаРегиональныхНастроек</code>. Константу не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h4 id="с-версии-3.1.5.180-и-меньше">С версии 3.1.5.180 и меньше</h4>
<h5 id="работа-с-файлами-3">Работа с файлами</h5>
<ul>
<li>Добавлена константа <code>РежимОчисткиФайлов</code>. Константу не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h4 id="с-версии-3.1.5.163-и-меньше">С версии 3.1.5.163 и меньше</h4>
<h5 id="работа-с-файлами-4">Работа с файлами</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения справочников хранения присоединенных файлов подсистемы <code>Работа с файлами</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.5.146-и-меньше">С версии 3.1.5.146 и меньше</h4>
<h5 id="базовая-функциональность-11">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения <code>Нерекомендуемый состав ролей</code> подсистемы <code>Базовая функциональность</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.5.132-и-меньше">С версии 3.1.5.132 и меньше</h4>
<h5 id="обновление-версии-иб-6">Обновление версии ИБ</h5>
<ul>
<li>Процедура <code>ПриФормированиеСпискаРазрабатываемыхПодсистем</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> устарела, вместо нее следует использовать процедуру <code>ПриФормированииСпискаРазрабатываемыхПодсистем</code> этого же модуля.</li>
</ul>
<h2 id="версия-3.1.4">Версия 3.1.4</h2>
<p>Версия 3.1.4 предназначена для разработки на платформе <strong>1С:Предприятие</strong> в режиме совместимости с версиями 8.3.14, 8.3.15 или 8.3.16, т.е.:</p>
<ul>
<li>8.3.14, если в свойстве <code>Режим совместимости</code> установлено значение <code>Не использовать</code>;</li>
<li>8.3.15, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code> или <code>Не использовать</code>;</li>
<li>8.3.16, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Не использовать</code>;</li>
<li>8.3.17 и выше, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Версия 8.3.16</code>.</li>
</ul>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.4</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.4">Новые возможности и изменения в версии 3.1.4</h3>
<p>В эту версию включена новая подсистема <strong>Перевод текста</strong> (в группе подсистем <strong>Мультиязычность</strong>), предоставляющая программный интерфейс для автоматического перевода произвольного текст с одного языка на другой. Перевод выполняется при помощи сервисов онлайн-перевода <strong>Яндекс Переводчик</strong> и <strong>Google Translate</strong>, входящих, соответственно, в состав сервисов <strong>Yandex Cloud</strong> и <strong>Google Cloud</strong>.</p>
<p>Из подсистемы <strong>Базовая функциональность</strong> выделена подсистема <strong>Мультиязычность</strong>. В неё вошли все метаданные, предоставляющие возможность вывода представлений данных на нескольких языках. Подсистема <strong>Мультиязычность</strong>, в свою очередь, также разделена на подсистемы, поддерживающие мультиязычность, соответствующие основному списку подсистем: <strong>Базовая функциональность</strong> и <strong>Печать</strong>.</p>
<h4 id="пользователи-5">Пользователи</h4>
<ul>
<li>Ранее, если пользователи забывали свои пароли для входа в программу, то для их восстановления требовалось обращаться к администратору программы. Это могло быть сложной и длительной процедурой. Теперь можно самостоятельно восстановить свой пароль, нажав ссылку “Забыли пароль?” в окне входа в программу. Из-за массового перехода пользователей на удаленную работу в рамках антикризисных решений восстановление паролей доступно сразу для всех пользователей программы. Настройка восстановления паролей предусмотрена в разделе <strong>Администрирование - Настройки пользователей и прав - Восстановление паролей</strong> выбором одного из вариантов:
<ul>
<li>восстановить пароль по электронной почте с помощью стандартного сервиса «1С» или указав свой почтовый сервер. Для этого в карточках пользователей на вкладке <strong>Адреса, телефоны</strong> должен быть указан почтовый адрес, куда будет отправлено письмо с кодом подтверждения для ввода нового пароля;</li>
<li>или восстановить пароль переходом по ссылке. Для этого необходимо предварительно подготовить страницу в Интернете или внутренней сети компании с описанием процесса восстановления доступа.</li>
<li>для отключения восстановления паролей необходимо снять признак Выводить ссылку Забыли пароль?</li>
</ul></li>
<li>Для помощи с часто встречающимися затруднениями при входе в программу также можно показать ссылку <strong>Нужна помощь?</strong>. Для этого необходимо:
<ul>
<li>подготовить информационные материалы и опубликовать их на странице в Интернете или внутренней сети компании;</li>
<li>включить отображение этой ссылки. см. раздел <strong>Администрирование - Настройки пользователей и прав - Восстановление паролей</strong>. <!--Локализация--> #### Банки</li>
</ul></li>
<li>В связи с вступлением в силу с 01.01.2021 положений Федерального закона от 27.12.2019 №479-ФЗ «О внесении изменений в Бюджетный кодекс Российской Федерации в части казначейского обслуживания и системы казначейских платежей» изменяются реквизиты для уплаты налогов, страховых взносов, сборов и других обязательных платежей во всех регионах. Для обеспечения возможности осуществления платежей в Казначейство по новым реквизитам в <strong>Классификаторе банков</strong> сделаны следующие изменения:
<ul>
<li><strong>Классификатор банков</strong> переименован в <strong>Справочник БИК</strong> и теперь содержит не только список кредитных организаций, но и Управления Федерального казначейства, а также других участников расчетов.</li>
<li>При загрузке классификатора теперь необходимо выбирать классификатор <strong>Справочник БИК</strong>. <strong>Справочник БИК</strong> аналогичен имеющемуся <strong>Справочнику по кредитным организациям</strong>, но кроме кредитных организаций в него входят и другие участники расчетов.</li>
<li>В <strong>Справочник БИК</strong> добавлено поле <strong>БИК РКЦ</strong>, указывающее для казначейских расчетных счетов банк, в котором открыт счет. <!--Конец локализация--> #### Валюты</li>
</ul></li>
<li>Если в программе ведется работа на нескольких языках, то параметры прописи валюты теперь можно вводить на всех используемых языках. Тем самым, в частности, появляется возможность формировать на нужных языках печатные формы, содержащие суммы, записанные прописью, например: “Сто двадцать пять рублей 00 копеек”. Для перехода к редактированию параметров прописей на нужном языке, необходимо выбрать соответствующий пункт в подменю <strong>Параметры прописи</strong> в карточке валюты.</li>
</ul>
<h4 id="варианты-отчетов-7">Варианты отчетов</h4>
<ul>
<li>Теперь настраивать отчеты можно гораздо быстрее:
<ul>
<li>При нажатии на заголовок колонки таблицы открывается форма для сортировки, фильтров и других действий с этой колонкой. Можно отфильтровать колонку, отметив флажками конкретные значения из этой колонки, либо задав условие, например: если значение в колонке больше 10. Кроме того, в заголовках колонок наглядно выводится значок направления сортировки.</li>
<li>Контекстное меню заголовка таблицы предоставляет возможности по:
<ul>
<li>вставке поля (колонки) справа;</li>
<li>вставке группировки ниже;</li>
<li>перемещению поля (колонки) влево, вправо, вверх, вниз;</li>
<li>скрытию поля (колонки);</li>
<li>переименованию поля (колонки);</li>
<li>установке, снятию фильтра;</li>
<li>сортировке поля (колонки) по возрастанию, убыванию;</li>
<li>оформлению, предлагая, как предопределенные варианты оформления, так и произвольный.</li>
</ul></li>
<li>С помощью контекстного меню в самой таблице, помимо открытия значения, расшифровки и других стандартных действий, также можно быстро выполнить:
<ul>
<li>фильтрацию по значению ячейки и выбранному условию, либо воспользовавшись расширенными возможностями;</li>
<li>сортировку по возрастанию, убыванию;</li>
<li>оформление, выбрав предопределенный или произвольный вариант.</li>
</ul></li>
</ul></li>
</ul>
<h4 id="печать-4">Печать</h4>
<ul>
<li>Печатные формы можно формировать на иностранном языке. Данная возможность может быть полезна, если необходимо предоставить какие-либо документы иностранному контрагенту, например: прайс-лист, счет на оплату и т. д. Для этого:
<ul>
<li>в списке <strong>Языки печатных форм</strong> (<strong>Администрирование</strong> - <strong>Печатные формы, отчеты и обработки</strong> - <strong>Языки печатных форм</strong>) добавить нужный язык;</li>
<li>перейти к редактированию макета печатной формы, которую требуется выводить на другом языке (<strong>Администрирование</strong> - <strong>Печатные формы, отчеты и обработки</strong> - <strong>Макеты печатных форм</strong>), переключить язык и выполнить перевод;</li>
<li>ввести наименования для печати на добавленном языке в элементах справочников, которые выводятся в печатную форму (например, справочники Номенклатура и Контрагенты);</li>
<li>сформировать печатную форму и переключить на выбранный язык. <!--Локализация--> #### Электронная подпись</li>
</ul></li>
<li>В связи с вступлением в силу с 01.01.2022 федерального закона от 27.12.2019 № 476-ФЗ “О внесении изменений в Федеральный закон «Об электронной подписи»”, удостоверяющий центр ООО «Научно-производственный центр “1С”» переходит к выпуску квалифицированных сертификатов только для физических лиц, включая сертификаты для сотрудников. С 01.04.2021 появится возможность оформить заявление на сертификат для физического лица так же просто, как для организаций. Для этого достаточно нажать <strong>Добавить</strong> - <strong>Заявление на выпуск сертификата</strong> в списке <strong>Настройки электронной подписи и шифрование</strong> (<strong>Мои настройки</strong> или <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Электронная подпись и шифрование</strong>) и вместо варианта <strong>Организация</strong> выбрать <strong>Физическое лицо</strong>.</li>
<li>При выводе табличных документов на печать в штампе электронной подписи выводится эмблема организации, заданная в карточке организации. <!--Конец локализация--></li>
</ul>
<h4 id="центр-мониторинга">Центр мониторинга</h4>
<ul>
<li>В случае возникновения программной ошибки теперь выводится сообщение, которое может содержать важные подробности: инструкцию по обходу проблемы, информацию о наличии исправления, а также номер ошибки. Эти подробности доступны после того, как в настройках программы указано <strong>Разрешить автоматическую отправку сведений об использовании программы в фирму «1С»</strong> (раздел <strong>Администрирование</strong> - <strong>Интернет-поддержка и сервисы</strong> - <strong>Центр мониторинга</strong>). Отправляемые сведения используется сотрудниками фирмы «1С» для анализа и устранения проблем, помогают быстрее выпускать исправления ошибок.
<ul>
<li>Для отключения автоматической отправки информации о программных ошибках в фирму «1С» можно в перейти в <strong>Главное меню</strong>, открыть <strong>Функции для технического специалиста</strong> - <strong>Управление настройками обработки ошибок</strong> и изменить настройку <strong>Отправлять отчет</strong> на <strong>Спрашивать пользователя</strong> или на <strong>Не отправлять</strong>.</li>
</ul></li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.4">Новые возможности для разработчиков в версии 3.1.4</h3>
<p>Новая подсистема <strong>Генерация штрихкода</strong> предоставляет программный интерфейс для генерирования изображений штрихкодов EAN8, EAN13, EAN128, Code39, Code93, Code128, Code16k, PDF417, ITF14, RSS14, EAN13AddOn2, EAN13AddOn5, QR, GS1DataBarExpandedStacked, Datamatrix.</p>
<h4 id="базовая-функциональность-12">Базовая функциональность</h4>
<ul>
<li><p>Для упрощения вызова процедуры <code>ВыполнитьВФоне</code> общего модуля <code>ДлительныеОперации</code> в функции-конструкторе <code>ПараметрыВыполненияВФоне</code> параметр <code>ИдентификаторФормы</code> сделан необязательным. Это удобно в тех случаях, когда результат выполнения процедуры нужно размещать не в автоматически создаваемом временном хранилище на время жизни формы, а в собственном временном хранилище; или когда формы-владельца не существует, например, при вызове длительной операции из общей команды, размещенной в глобальном интерфейсе.</p></li>
<li><p>В общих модулях <code>ФайловаяСистема</code> и <code>ФайловаяСистемаКлиент</code> появилась функция <code>УникальноеИмяФайла</code>, с помощью которой можно сформировать уникальное имя файла в указанной папке. Если файл с таким именем уже существует, то к имени файла добавляется уникальный порядковый номер, например: “файл (2).txt”, “файл (3).txt” и т.п.</p></li>
<li><p>В редких случаях возникает необходимость определять сразу несколько минимальных или рекомендуемых версий платформы <strong>1С:Предприятие</strong>. Например, если функции, необходимые для работы конфигурации, были включены в исправительные релизы платформы. Для этого добавлена возможность указывать сразу несколько сборок платформы в параметрах <code>МинимальнаяВерсияПлатформы</code> и <code>РекомендуемаяВерсияПлатформы</code> коллекции <code>ОбщиеПараметры</code> процедуры <code>ПриОпределенииОбщихПараметровБазовойФункциональности</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>. При этом пользователю будет предлагаться для обновления тот номер сборки, который соответствует текущей версии платформы (первым трем цифрам). Например, если указать <code>"8.3.14.1694; 8.3.15.2107; 8.3.16.1791"</code>, то при запуске на предыдущих релизах 8.3.14 будет предложено перейти на 8.3.14.1694, при работе на 8.3.15 - 8.3.15.2107, и 8.3.16 - 8.3.16.1791, соответственно.</p></li>
<li><p>В редких случаях в конфигурации бывает необходимо опционально задействовать новые возможности платформы <strong>1С:Предприятие</strong>, не увеличивая минимальную версию платформы, требуемую для запуска. При помощи функции <code>ВерсияРежимаСовместимости</code> общего модуля <code>СтандартныеПодсистемыСервер</code> можно также проверить требуемый режим совместимости платформы <strong>1С:Предприятие</strong> в тех случаях, когда конфигурация рассчитана на работу в нескольких режимах совместимости. См. также <a href="https://its.1c.ru/db/v83doc#bookmark:dev:TI000001244">документацию 1С:Предприятие 8.3</a>.</p></li>
<li><p>При работе в мультиязычной конфигурации бывает необходимо получить представления данных на требуемом языке. Для этого программный интерфейс функций <code>ЗначениеРеквизитаОбъекта</code>, <code>ЗначенияРеквизитаОбъекта</code>, <code>ЗначениеРеквизитаОбъектов</code> и <code>ЗначенияРеквизитовОбъектов</code> модуля <code>ОбщегоНазначения</code> расширен параметром <code>КодЯзыка</code>.</p></li>
<li><p>Также при работе в мультиязычной конфигурации для определения представлений данных может понадобиться получить признак того, что язык интерфейса текущего пользователя соответствует языку конфигурации. Для этого в программный интерфейс общего модуля <code>ОбщегоНазначения</code> добавлена функция <code>ЭтоОсновнойЯзык</code>.</p></li>
<li><p>В функцию <code>РасчетныеПоказателиЯчеек</code> общего модуля <code>ОбщегоНазначенияКлиентСервер</code> добавлен необязательный параметр <code>ПараметрыРасчета</code> типа возвращаемого значения функции <code>ПараметрыРасчетаПоказателейЯчеек</code> общего модуля <code>ОбщегоНазначенияКлиентСервер</code>. В новом параметре свойство <code>РассчитатьНаСервере</code> позволяет разработчику явно указать, выполнять расчет на сервере или на клиенте, вместо автоопределения. <!--Локализация--> #### Банки</p></li>
<li><p>Для получения сведений из <strong>Справочника БИК</strong> об участниках расчетов в программном интерфейсе общего модуля <code>РаботаСБанками</code> предусмотрена функция <code>СведенияБИК</code>. Подробнее см. в описании к ней.</p></li>
<li><p>Для интерактивного выбора участника расчетов из <strong>Справочника БИК</strong> по номеру БИК предусмотрена процедура <code>ВыбратьИзСправочникаБИК</code> в общем модуле <code>РаботаСБанкамиКлиент</code>. В процедуре определяется количество найденных записей по переданному БИК и в случае, если запись не единственная, либо таких записей нет, открывает форму выбора. В случае, если запись одна, выбор осуществляется автоматически. <!--Конец локализация--></p></li>
</ul>
<h4 id="валюты">Валюты</h4>
<ul>
<li><p>Пользователь может вводить параметры прописи валюты на иностранных языках. Для получения суммы прописью на иностранном языке программный интерфейс функции <code>СформироватьСуммуПрописью</code> общего модуля <code>РаботаСКурсамиВалют</code> расширен параметром <code>КодЯзыка</code>.<br />
Пример использования:</p>
<pre class="1c"><code>ДанныеПечати.Вставить(&quot;СуммаПрописью&quot;, 
  РаботаСКурсамиВалют.СформироватьСуммуПрописью(ДанныеПечати.ИтоговаяСумма, Шапка.ВалютаДокумента, , КодЯзыка));</code></pre></li>
</ul>
<h4 id="варианты-отчетов-8">Варианты отчетов</h4>
<ul>
<li><p>Расширены возможности настройки отчета из контекстного меню. Из контекстного меню заголовка таблицы можно вставлять в таблицу новое поле (колонку), выбрав из списка доступных полей. Для более быстрой вставки наиболее частотных (основных) полей можно отдельно перечислить их:</p>
<ul>
<li>в процедуре <code>ПриОпределенииОсновныхПолей</code> общего модуля <code>ОтчетыПереопределяемый</code>;</li>
<li>или в модуле объекта отчета в процедуре <code>ОпределитьНастройкиФормы</code> включить событие <code>ПриОпределенииОсновныхПолей</code> и реализовать процедуру <code>ПриОпределенииОсновныхПолей</code>. См. пример реализации в демонстрационной конфигурации в отчете <code>_ДемоФайлы</code>.</li>
</ul>
<p>Например, количество доступных полей для вывода в отчет по номенклатуре может достигать нескольких десятков. Однако если предполагается, что в отчет чаще других выводят цены, то поле <strong>Цена</strong> можно включить в список основных полей, которые будут выводиться сразу в подменю вставки новой колонки:</p>
<pre><code>Процедура ПриОпределенииОсновныхПолей(Форма, ОсновныеПоля) Экспорт 
  ОсновныеПоля.Добавить(&quot;Регистратор&quot;);
  ОсновныеПоля.Добавить(&quot;Номенклатура&quot;);
  ОсновныеПоля.Добавить(&quot;Количество&quot;);
  ОсновныеПоля.Добавить(&quot;Цена&quot;);
  ОсновныеПоля.Добавить(&quot;Сумма&quot;);
КонецПроцедуры</code></pre></li>
</ul>
<h4 id="запрет-редактирования-реквизитов-объектов-1">Запрет редактирования реквизитов объектов</h4>
<ul>
<li>Для того чтобы централизованно переопределять список заблокированных реквизитов, заданных в модулях менеджера различных объектов, в общем модуле <code>ЗапретРедактированияРеквизитовОбъектовПереопределяемый</code> предусмотрена процедура <code>ПриОпределенииЗаблокированныхРеквизитов</code>.</li>
</ul>
<h4 id="контактная-информация-2">Контактная информация</h4>
<ul>
<li>Для получения контактной информации интересующего типа в функции <code>КонтактнаяИнформацияОбъекта</code> программного интерфейса общего модуля <code>УправлениеКонтактнойИнформацией</code> второй параметр <code>ВидИлиТипКонтактнойИнформации</code> теперь поддерживает передачу значения с типом <code>ПеречислениеСсылка.ТипыКонтактнойИнформации</code>. Например, для получения всех адресов организации (юридического, фактического и др.), достаточно указать тип контактной информации <code>Перечисления.ТипыКонтактнойИнформации.Адрес</code>.</li>
<li>Для получения контактной информации объектов на иностранном языке программный интерфейс модуля <code>УправлениеКонтактнойИнформацией</code> расширен функциями <code>КонтактнаяИнформация</code> и <code>ОтборКонтактнойИнформации</code>. Подробности см. в описании к этим функциям. <!--Локализация-->- Для заполнения муниципальных адресов в декларациях, регламентированных отчетах и др. документах в соответствии с приказом Минфина России от 5 ноября 2015 г. N 171н “Об утверждении Перечня элементов планировочной структуры, элементов улично-дорожной сети, элементов объектов адресации, типов зданий (сооружений), помещений, используемых в качестве реквизитов адреса, и Правил сокращенного наименования адресообразующих элементов” в общем модуле <code>РаботаСАдресами</code> предусмотрена функция программного интерфейса <code>СведенияОбАдресеПриказМинфинаРФ171н</code>, которая возвращает адрес в виде структуры. Это дает возможность получать типы полей адреса (региона, района, города и т.д.) согласно перечню сокращенных наименований видов субъектов Российской Федерации, муниципальных образований, населенных пунктов, элементов планировочной структуры, элементов улично-дорожной сети и идентификационных элементов объекта адресации. Функция доступна с версии 3.1.4.146 и выше. <!--Конец локализация--></li>
</ul>
<h4 id="обновление-версии-иб-7">Обновление версии ИБ</h4>
<ul>
<li>Предусмотрена возможность предопределения общих правил заполнения предопределенных данных при первом запуске информационной базы. Например, когда два разных объекта заполняются одинаковыми данными начального заполнения. Для этого в программном интерфейсе общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> добавлены процедуры заполнения:
<ul>
<li><code>ПриНастройкеНачальногоЗаполненияЭлементов</code></li>
<li><code>ПриНачальномЗаполненииЭлементов</code></li>
<li><code>ПриНачальномЗаполненииЭлемента</code></li>
</ul></li>
<li>Процедуры аналогичны одноименным процедурам в модулях менеджеров объектов с начальным заполнением, но в значении первого параметра <code>ПолноеИмяОбъекта</code> передается имя объекта метаданных, предопределенные данные которого заполняются.</li>
<li>Для упрощения отладки и разработки новых обработчиков обновления в качестве версии обработчика теперь можно указывать значение <code>ОтладкаОбработчика</code>. В таком случае обработчик будет выполняться при каждом обновлении и для его отладки достаточно запустить программу с ключом <code>ЗапуститьОбновлениеИнформационнойБазы</code>. Так же это может быть удобно для случаев, когда точный номер версии для обработчика не известен до его помещения в основное хранилище.</li>
</ul>
<h4 id="обмен-данными-12">Обмен данными</h4>
<ul>
<li><p>Если дополнительный параметр объекта <code>ИспользоватьОтменуПроведенияДляОчисткиДвижений</code> принимает значение <code>Истина</code>, то удаление движений объектов будет выполняться как при отмене проведения, то есть с учетом всех проверок программы. Иначе сохранено старое поведение, т.е. безусловное удаление движений. Параметр рекомендуется заполнять в событии <code>ПередЗаписьюПолученныхДанных</code>. <!--Локализация--> #### Отправка SMS</p></li>
<li><p>Из списка доступных провайдеров SMS удален провайдер <strong>GSM-INFORM</strong> в связи с прекращением его деятельности.</p></li>
<li><p><a href="https://beeline.amega-inform.ru/support/news_archive.php?news_id=241">Изменен адрес</a> сервиса отправки SMS-провайдера <strong>Билайн</strong>. Если в программе настроены SMS-рассылки через <strong>Билайн</strong>, рекомендуется переключиться на новый адрес a2p-sms.beeline.ru. Для этого следует обратиться в службу поддержку Билайна и затем изменить настройку в программе, указав новый способ авторизации и введя полученные логин и пароль (раздел <strong>Администрирование</strong> - <strong>Органайзер</strong> - <strong>Настройка отправки SMS</strong>). В будущем доступ к услуге по прежнему адресу beeline.amega-inform.ru может быть прекращен (подробности можно уточнить в службе поддержки компании <strong>Билайн</strong>).</p></li>
</ul>
<h4 id="организации-2">Организации</h4>
<ul>
<li>Для подготовки печатных форм на иностранном языке программный интерфейс всех функций общих модулей <code>ОрганизацииСервер</code> и <code>ОрганизацииПереопределяемый</code> расширен параметром <code>КодЯзыка</code>. Необходимо учесть это изменение во всех функциях модуля <code>ОрганизацииПереопределяемый</code>, где выполнялось переопределение. <!--Конец локализация--></li>
</ul>
<h4 id="пользователи-6">Пользователи</h4>
<ul>
<li>Для возможности восстановления паролей пользователей по электронной почте в конфигурацию должны быть включены подсистемы <code>КонтактнаяИнформация</code> и <code>РаботаСПочтовымиСообщениями</code>. Если подсистема <code>РаботаСПочтовымиСообщениями</code> была внедрена ранее, то в текущую конфигурацию требуется добавить новую константу <code>УчетнаяЗаписьДляВосстановленияПароля</code> выполнив сравнение/объединение с конфигурацией библиотеки из комплекта поставки. Константу рекомендуется включать в состав планов обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
<li>В общий модуль <code>Пользователи</code> добавлена новая функция <code>АвторизоватьТекущегоПользователяПриВходе</code>, которую следует вызывать в начале процедур http-сервисов, веб-сервисов, com-соединений, если они используются для удаленного подключения обычных пользователей, чтобы обеспечить контроль ограничений на вход (по дате, по активности и т.д.).</li>
</ul>
<h4 id="печать-5">Печать</h4>
<ul>
<li><p>Печатные формы можно формировать на иностранном языке. Данная возможность может быть полезна, если необходимо предоставить какие-либо документы иностранному контрагенту, например: прайс-лист, счет на оплату и т. д. Для этого пользователь добавляет произвольный язык в справочник <code>ЯзыкиПечатныхФорм</code>, самостоятельно переводит пользовательский макет печатной формы на иностранный язык, а также вводит представления для выводимых на печать объектов.<br />
Чтобы поддержать этот сценарий в печатной форме, необходимо выполнить ряд доработок печатных форм:</p>
<ul>
<li>включить мультиязычность для реквизитов справочников, выводимых в печатной форме</li>
<li>подготовить макет печатной формы для возможности перевода;</li>
<li>при формировании печатной формы готовить макет и данные на требуемом языке;</li>
<li>возможность переключения языков включить в печатной форме явно.</li>
</ul>
<p>Подробности см. в документации.</p>
<p>Пример формирования печатной формы с поддержкой мультиязычности можно посмотреть в процедуре <code>Печать</code> документа <code>_ДемоСчетНаОплатуПокупателю</code>.</p></li>
<li><p>Язык, на котором требуется сформировать печатную форму, передается в параметре <code>ПараметрыВывода.КодЯзыка</code> процедуры <code>Печать</code> менеджера печати. Его необходимо использовать при получении макета и данных, выводимых в табличный документ.</p></li>
<li><p>По умолчанию в печатной форме для пользователя отключена возможность переключения языков. Для включения этой возможности параметр <code>КоллекцияПечатныхФорм</code> процедуры <code>Печать</code> расширен свойством <code>ДоступенВыводНаДругихЯзыках</code>, необходимо установить значение <code>Истина</code>. Например:</p></li>
</ul>
<pre class="1с"><code>  ПечатнаяФорма = УправлениеПечатью.СведенияОПечатнойФорме(КоллекцияПечатныхФорм, &quot;Счет&quot;);
  Если ПечатнаяФорма &lt;&gt; Неопределено Тогда
    ПечатнаяФорма.ТабличныйДокумент = ПечатьСчетаЗаказа(МассивОбъектов, ОбъектыПечати, &quot;Счет&quot;, ВыводитьПлатежныеРеквизиты, ПараметрыВывода.КодЯзыка);
    ПечатнаяФорма.СинонимМакета = НСтр(&quot;ru = &#39;Счет на оплату&#39;&quot;);
    ПечатнаяФорма.ПолныйПутьКМакету = &quot;Документ._ДемоСчетНаОплатуПокупателю.ПФ_MXL_СчетЗаказ&quot;;
    ПечатнаяФорма.ДоступенВыводНаДругихЯзыках = Истина;
  КонецЕсли;</code></pre>
<ul>
<li>Для получения макета на требуемом языке функция <code>МакетПечатнойФормы</code> общего модуля <code>УправлениеПечатью</code> расширена параметром <code>КодЯзыка</code>.</li>
</ul>
<h4 id="рассылка-отчетов-1">Рассылка отчетов</h4>
<ul>
<li>Для упрощения вызова функций <code>ВыполнитьРассылкуОтчетов</code> и <code>ВыполнитьРассылку</code> общего модуля <code>РассылкаОтчетов</code> предусмотрены функции-конструкторы их параметров <code>ПараметрыЖурнала</code>, <code>ОтчетыДляРассылки</code> и <code>ПараметрыДоставки</code>.</li>
</ul>
<h3 id="свойства-2">Свойства</h3>
<ul>
<li>Для получения представлений свойств на иностранном языке
<ul>
<li>программный интерфейс модуля <code>УправлениеСвойствами</code> расширен функциями <code>ПредставлениеЗначенияСвойства</code> и <code>ПредставленияЗначенийСвойств</code>.</li>
<li>программный интерфейс функций <code>ЗначенияСвойств</code> и <code>ЗначениеСвойства</code> общего модуля <code>УправлениеСвойствами</code> расширен параметром <code>КодЯзыка</code>.</li>
</ul>
Подробности см. в описании к этим функциям.</li>
</ul>
<h4 id="управление-доступом-5">Управление доступом</h4>
<ul>
<li>Функции <code>ЧтениеРазрешено</code> и <code>ИзменениеРазрешено</code> общего модуля <code>УправлениеДоступом</code> теперь поддерживают необязательный параметр <code>Пользователь</code>, позволяющий проверить право доступа на уровне записей для произвольного пользователя. Параметр доступен только в производительном режиме, который можно определить с помощью новой функции <code>ПроизводительныйВариант</code> общего модуля <code>УправлениеДоступом</code>.</li>
</ul>
<h4 id="электронная-подпись-11">Электронная подпись</h4>
<!--Локализация-->
<ul>
<li>Для вывода эмблемы организации в штампе электронной подписи расширен состав возвращаемого значения функции <code>ДополнительныеСведенияОрганизации</code> общего модуля <code>ОрганизацииСервер</code> и параметра <code>ДополнительныеСведения</code> процедуры <code>ПриОпределенииДополнительныхСведенийОрганизации</code> общего модуля <code>ОрганизацииПереопределяемый</code>: в новом свойстве <code>ЭмблемаОрганизацииДляШтампаЭлектроннойПодписи</code> необходимо возвращать картинку с эмблемой. Пример реализации см. в демонстрационной конфигурации в процедуре <code>ОрганизацииПереопределяемый.ПриОпределенииДополнительныхСведенийОрганизации</code> и справочнике <code>_ДемоОрганизации</code>.<!--Конец локализация--></li>
<li>Функция <code>ПараметрыXMLDSig</code> общих модулей <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code> теперь возвращает значения по умолчанию, подходящие для большинства случаев. <!--Локализация-->Кроме того, не требуется заполнять алгоритмы для создания подписи при использовании сертификатов с алгоритмами открытого ключа ГОСТ 94, ГОСТ 2001, ГОСТ 2012/256 и ГОСТ 2012/512.<!--Конец локализация--></li>
</ul>
<h3 id="переход-на-версию-3.1.4-с-версии-3.1.3">Переход на версию 3.1.4 с версии 3.1.3</h3>
<h4 id="обязательные-действия-по-переходу-3">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения (см. <a href="https://its.1c.ru/db/bspdoc">главу 2 Инструкция по внедрению библиотеки</a>).</p>
<p>Для обновления следующих переопределяемых общих модулей требуется перенести из поставки библиотеки новые экспортные процедуры, удалить отсутствующие и убедиться, что комментарии, количество и имена параметров у процедур совпадают с поставкой библиотеки:</p>
<ul>
<li><code>ЗапретРедактированияРеквизитовОбъектовПереопределяемый</code>;</li>
<li><code>ОбновлениеИнформационнойБазыПереопределяемый</code>;</li>
<li><code>ОбщегоНазначенияПереопределяемый</code>; <!--Локализация-->- <code>ОрганизацииПереопределяемый</code>; <!--Конец локализация--></li>
<li><code>ОтчетыПереопределяемый</code>;</li>
<li><code>УправлениеПечатьюПереопределяемый</code>.</li>
</ul>
<p>Рекомендации по задействованию новых возможностей переопределяемых общих модулей приведены выше в разделе <strong>Новые возможности для разработчиков</strong>.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки. В исключительных (редких) случаях, когда такая совместимость не обеспечена, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки, в этом разделе приведены необходимые инструкции. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h5 id="бизнес-процессы-и-задачи">Бизнес-процессы и задачи</h5>
<ul>
<li>Указать в составе определяемого типа <code>БизнесПроцессОбъект</code> объекты бизнес-процессов, подключенных к подсистеме. Состав объектов должен совпадать с составом ссылок в определяемом типе <code>БизнесПроцесс</code>.</li>
</ul>
<h5 id="управление-доступом-6">Управление доступом</h5>
<ul>
<li><p>Во всех ролях обновить стандартные шаблоны <code>ДляОбъекта</code>, <code>ДляРегистра</code> и ограничения доступа по шаблону <code>ДляОбъекта</code>. Рекомендуется использовать отчет <code>ПроверкаВнедренияБСП.erf</code> в режиме исправления ошибок. <!--Локализация--> ##### Электронная подпись</p></li>
<li><p>Для поддержки удобного заполнения заявления для физического лица, которое будет доступно пользователям с 01.04.2021, рекомендуется реализовать заполнение новых свойств <code>ИНН</code>, <code>АдресРегистрации</code> и <code>Телефон</code> в параметре <code>Параметры</code> процедуры <code>ПриЗаполненииРеквизитовВладельцаВЗаявленииНаСертификат</code>. Смотри пример в демонстрационной конфигурации в общем модуле <code>_ДемоСтандартныеПодсистемы</code>.</p></li>
<li><p>Для поддержки срока прекращения доступности заявления для организаций с 01.12.2021, при использовании процедуры <code>ДобавитьСертификат</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с целью создания нового заявления на сертификат для организации, требуется обеспечить управление видимостью этой команды с помощью функции <code>ДоступностьСозданияЗаявления</code> общего модуля <code>ЭлектроннаяПодпись</code>. Кроме того, следует реализовать команду добавления заявления для физического лица (также с управлением видимостью, для поддержки срока начала доступности заявления для физических лиц с 01.04.2021). Смотри пример в демонстрационной конфигурации в формах списков справочников <code>_ДемоОрганизации</code> и <code>_ДемоФизическиеЛица</code>. <!--Конец локализация--></p></li>
</ul>
<h4 id="необязательные-действия-по-переходу-3">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="даты-запрета-изменения">Даты запрета изменения</h5>
<ul>
<li>Процедура <code>ОбновитьРазделыДатЗапретаИзменения</code> общего модуля <code>ДатыЗапретаИзменения</code> перенесена в область <code>УстаревшиеПроцедурыИФункции</code>. Обновление выполняется автоматически, поэтому вызовы процедуры следует удалить.</li>
</ul>
<h5 id="перевод-текста">Перевод текста</h5>
<ul>
<li>Объекты подсистемы не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="печать-6">Печать</h5>
<ul>
<li>Справочник <code>ЯзыкиПечатныхФорм</code> следует включить в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="работа-с-почтовыми-сообщениями-3">Работа с почтовыми сообщениями</h5>
<ul>
<li>Константу <code>УчетнаяЗаписьДляВосстановленияПароля</code> следует включить в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h4 id="работа-с-файлами-5">Работа с файлами</h4>
<ul>
<li>Константу <code>РежимОчисткиФайлов</code> не следует включить в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="электронная-подпись-12">Электронная подпись</h5>
<ul>
<li>При использовании функции <code>ПараметрыXMLDSig</code> общих модулей <code>ЭлектроннаяПодписьКлиент</code> и <code>ЭлектроннаяПодпись</code> рекомендуется перейти к использованию значений, возвращаемых по умолчанию.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.4">Особенности обновления с ранних версий на версию 3.1.4</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.3) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <strong>Переход с предыдущих версий</strong> для каждой пропущенной версии.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.4">Переход на исправительные релизы 3.1.4</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.4.<strong>1</strong>, 3.1.4.<strong>20</strong>, 3.1.4.<strong>300</strong> из т.п. Для обновления на исправительные релизы предназначена внешняя обработка <strong>ОбновлениеНаИсправительнуюВерсиюБСП.epf</strong> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <strong>Обновить на исправительную версию</strong>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <strong>Сформировать файл настроек</strong> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <strong>ПроверкаВнедренияБСП.erf</strong>. <!--Локализация--> #### С версии 3.1.4.407 и меньше</p>
<h5 id="электронная-подпись-13">Электронная подпись</h5>
<p>Для конфигураций, имеющих в составе <a href="https://v8.1c.ru/tekhnologii/standartnye-biblioteki/1s-biblioteka-internet-podderzhki/">Библиотеку интернет-поддержки пользователей</a>, в процедуре <code>ПриОпределенииИспользуемыхВерсийВнешнихКомпонент</code> общего модуля <code>ПолучениеВнешнихКомпонентВМоделиСервисаПереопределяемый</code> вставить строки:</p>
<pre><code>Идентификаторы.Добавить(&quot;ExtraCryptoAPI&quot;);
Идентификаторы.Добавить(&quot;XMLDSignAddIn&quot;);</code></pre>
<!--Конец локализация-->
<h4 id="с-версии-3.1.4.232-и-меньше">С версии 3.1.4.232 и меньше</h4>
<h5 id="базовая-функциональность-13">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения подсистем <code>Контактная информация</code> и <code>Свойства</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета. <!--Локализация--> #### С версии 3.1.4.186 и меньше</li>
</ul>
<h5 id="электронная-подпись-14">Электронная подпись</h5>
<ul>
<li>Для поддержки удобного заполнения заявления для физического лица, которое будет доступно пользователям с 01.04.2021, рекомендуется реализовать заполнение новых свойств <code>ИНН</code>, <code>АдресРегистрации</code> и <code>Телефон</code> в параметре <code>Параметры</code> процедуры <code>ПриЗаполненииРеквизитовВладельцаВЗаявленииНаСертификат</code>. Смотри пример в демонстрационной конфигурации в общем модуле <code>_ДемоСтандартныеПодсистемы</code>.</li>
<li>Для поддержки срока прекращения доступности заявления для организаций с 01.12.2021, при использовании процедуры <code>ДобавитьСертификат</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с целью создания нового заявления на сертификат для организации, требуется обеспечить управление видимостью этой команды с помощью функции <code>ДоступностьСозданияЗаявления</code> общего модуля <code>ЭлектроннаяПодпись</code>. Кроме того, следует реализовать команду добавления заявления для физического лица (также с управлением видимостью, для поддержки срока начала доступности заявления для физических лиц с 01.04.2021). Смотри пример в демонстрационной конфигурации в формах списков справочников <code>_ДемоОрганизации</code> и <code>_ДемоФизическиеЛица</code>. <!--Конец локализация--></li>
</ul>
<h2 id="версия-3.1.3">Версия 3.1.3</h2>
<p>Версия 3.1.3 предназначена для разработки на платформе <strong>1С:Предприятие</strong> в режиме совместимости с версиями 8.3.14, 8.3.15 или 8.3.16, т.е.:</p>
<ul>
<li>8.3.14, если в свойстве <code>Режим совместимости</code> установлено значение <code>Не использовать</code>;</li>
<li>8.3.15, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code> или <code>Не использовать</code>;</li>
<li>8.3.16, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Не использовать</code>;</li>
<li>8.3.17 и выше, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Версия 8.3.16</code>.</li>
</ul>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.3</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.3">Новые возможности и изменения в версии 3.1.3</h3>
<p>В эту версию включена новая подсистема <strong>Учет оригиналов первичных документов</strong>. С ее помощью можно упростить учет и контроль наличия подписанных оригиналов входящих и исходящих первичных документов, например, в сценарии: документ распечатали, передали клиенту, ждем возвращения подписанного оригинала. Ключевые возможности:</p>
<ul>
<li>Подсистему можно подключить к произвольным документам конфигурации, входящим, исходящим и двусторонним первичным документам.</li>
<li>Фиксация и хранение признака наличия оригиналов первичных документов, как для каждой печатной формы, так и по одному общему состоянию на документ.</li>
<li>Фиксация сотрудника, установившего и изменившего состояние оригинала (или печатных форм) первичного документа, а также даты последних изменений текущего состояния.</li>
<li>Возможна установка, изменение и отслеживание признака состояния оригинала первичного документа в специализированном рабочем места, в журналах или формах документов.</li>
<li>Можно ввести и настроить любой список состояний, которые могут потребовать в учете.</li>
<li>Включить отслеживание состояний напечатанных документов можно в разделе <strong>Администрирование – Печатные формы, отчеты и обработки</strong>.</li>
</ul>
<p>Кроме того, следующие подсистемы получили существенное развитие и ряд новых функций:</p>
<h4 id="базовая-функциональность-14">Базовая функциональность</h4>
<ul>
<li><p>Для длительного хранения электронных документов в соответствии с требованиями законодательства добавлена возможность сохранения печатных форм документов и отчетов в формате PDF/A. Эта возможность доступна при использовании платформы 8.3.16 и выше. <!--Локализация--> #### Банки</p></li>
<li><p>В связи с вступлением в силу с 01.01.2021 положений Федерального закона от 27.12.2019 №479-ФЗ «О внесении изменений в Бюджетный кодекс Российской Федерации в части казначейского обслуживания и системы казначейских платежей» изменяются реквизиты для уплаты налогов, страховых взносов, сборов и других обязательных платежей во всех регионах. Для обеспечения возможности осуществления платежей в Казначейство по новым реквизитам в <strong>Классификаторе банков</strong> сделаны следующие изменения:</p>
<ul>
<li><strong>Классификатор банков</strong> переименован в <strong>Справочник БИК</strong> и теперь содержит не только список кредитных организаций, но и Управления Федерального казначейства, а также других участников расчетов.</li>
<li>При загрузке классификатора теперь необходимо выбирать классификатор <strong>Справочник БИК</strong>. <strong>Справочник БИК</strong> аналогичен имеющемуся <strong>Справочнику по кредитным организациям</strong>, но кроме кредитных организаций в него входят и другие участники расчетов.</li>
<li>В <strong>Справочник БИК</strong> добавлено поле <strong>БИК РКЦ</strong>, указывающее для казначейских расчетных счетов банк, в котором открыт счет. <!--Конец локализация--></li>
</ul></li>
</ul>
<h4 id="варианты-отчетов-9">Варианты отчетов</h4>
<ul>
<li>Среди всех отчетов в программе имеются такие, которые открываются контекстно из документов, справочников или других объектов для просмотра связанной с ними информации. Например: <strong>Движения документа</strong>, <strong>Места использования</strong> и т.п.
<ul>
<li>Теперь возможно изменять и сохранять варианты контекстных отчетов. Например, если требуется наложить дополнительные отборы или изменить состав полей, а также добавить группировки, можно выполнить соответствующие действия в расширенном режиме настройки отчета. При необходимости, внесенные изменения, можно сохранить в личном или общедоступном варианте отчета.</li>
<li>Кроме того, варианты контекстных отчетов, подобно тому, как и обычные, возможно включать в рассылки (раздел <strong>Администрирование – Печатные формы, отчеты и обработки – Рассылки отчетов</strong>).</li>
</ul></li>
<li>Улучшен универсальный отчет (раздел <strong>Администрирование – Печатные формы, отчеты и обработки</strong>):
<ul>
<li>Для наглядности в заголовке выводится источник данных отчета, например, «Универсальный отчет: Документ “Анкета” за 2020 г.»</li>
<li>Опционально, выводятся сведения о количестве подчиненных записей в группировках.</li>
</ul></li>
</ul>
<h4 id="взаимодействия-2">Взаимодействия</h4>
<ul>
<li>Улучшена диагностика регламентного задания получения и отправки почты. В случае, когда задание по какой-либо причине приостановлено и почта не отправляется, в списке <strong>Взаимодействия</strong>, а также в форме исходящего письма выводится соответствующее предупреждение.</li>
</ul>
<h4 id="групповое-изменение-реквизитов">Групповое изменение реквизитов</h4>
<ul>
<li>Повышено удобство группового изменения реквизитов (открывается из панели <strong>Администрирование – Обслуживание – Корректировка данных</strong> либо из списков по команде <strong>Изменить выделенные…</strong>):
<ul>
<li>запоминается последнее выбранное значение в поле <strong>Изменять</strong>,</li>
<li>при выборе элементов для изменения по гиперссылке <strong>Все элементы</strong> можно сохранять и загружать ранее настроенные отборы,</li>
<li>также в форме <strong>Выбор элементов для изменения</strong> предусмотрено поле быстрого поиска элементов по произвольной строке. При этом поиск и отбор элементов выполняется по всем видимым колонкам списка, состав которых настраивается по гиперссылке <strong>Колонки списка</strong> внизу формы.</li>
<li>состав видимых колонок запоминается раздельно для каждой таблицы (комбинации таблиц).</li>
</ul></li>
</ul>
<h4 id="контактная-информация-3">Контактная информация</h4>
<ul>
<li>Для удобного ввода номеров телефонов в разделе <strong>Администрирование – Общие настройки – Виды контактной информации</strong> предусмотрена настройка масок ввода. Для каждого вида контактной информации в поле <strong>Вводить номер по маске</strong> можно задать свою маску, например, +7 (999) 999-99-99. Маска ввода применяется для ввода новых номеров телефонов.</li>
<li>Для экономии размеров информационной базы оптимизировано хранение контактной информации. Это позволит уменьшить размер вновь вводимой контактной информации в среднем на 30%. <!--Локализация-->- Введенные в программу адреса контактной информации могут регулярно устаревать вследствие переподчинения адресных объектов (улиц, населенных пунктов), их переименования или упразднения. Теперь устаревшие адреса можно автоматически исправлять на актуальные согласно адресному классификатору ФИАС.
<ul>
<li>Для этого у видов контактной информации с типом <strong>Адрес</strong> в дополнительных настройках включить флажок <strong>Автоматически исправлять устаревшие адреса</strong> (раздел <strong>Администрирование – Общие настройки – Виды контактной информации</strong>). Предварительно требуется подключиться к Интернет-поддержке пользователей или загрузить в программу историю изменений адресных объектов в адресном классификаторе ФИАС.</li>
<li>Рекомендуется включать этот флажок для адресов, требующих актуального состояния (например, адреса доставки), и не включать для юридически значимых адресов: например, адрес ЕГРЮЛ, место регистрации, рождения и др., т.к. они могут фигурировать в юридических документах.</li>
</ul></li>
</ul>
<h4 id="контроль-ведения-учета-1">Контроль ведения учета</h4>
<ul>
<li>Состав проверок расширен полезными проверками контактной информации (раздел <strong>Администрирование – Обслуживание – Правила проверки учета</strong>):
<ul>
<li>Выявление некорректных настроек видов контактной информации, «испорченных» в результате нештатной работы с программой или при синхронизации данных. Предусмотрено частичное восстановление «битых» настроек.</li>
<li>Выявление устаревших адресов контактной информации вследствие переподчинения адресных объектов (улиц, населенных пунктов), их переименования или упразднения. Также можно актуализировать выявленные устаревшие адреса автоматически.</li>
<li>Выявление и исправление адресов, содержащих устаревший тип здания «Литер»: он заменяется на корректный тип «Литера»;</li>
<li>Проверка всех адресов, введенных в программе, на соответствие адресному классификатору ФИАС.</li>
</ul></li>
<li>Новые проверки рекомендуется запускать по необходимости или настроить регулярный запуск по расписанию. <!--Конец локализация--></li>
</ul>
<h4 id="обмен-данными-13">Обмен данными</h4>
<ul>
<li>Добавлена возможность расширения состава данных при обмене между приложениями в универсальном формате <strong>EnterpriseData</strong>. Теперь базовую схему формата можно расширять отсутствующими объектами и их свойствами, и включить в обмен дополнительные данные. Это позволяет повысить полноту передаваемых в обмене данных, упрощает адаптацию типовых обменов в доработанных конфигурациях и разработку новых обменов. Например, можно дополнить объект <strong>Документ.ЗаказКлиента</strong> базовый схемы формата реквизитом <strong>ИдентификаторЗаказаВПрограммеКлиента</strong>, и поддержать его получение и отправку при обмене с внешними системами клиентов.</li>
</ul>
<h4 id="обновление-версии-иб-8">Обновление версии ИБ</h4>
<ul>
<li>Существенно уменьшено время многопоточного выполнения дополнительных процедур обработки данных при обновлении больших информационных баз. В некоторых случаях ускорение достигает 40%.</li>
</ul>
<h4 id="обсуждения">Обсуждения</h4>
<ul>
<li>Больше не нужно переключаться между различными мессенджерами и социальными сетям для общения с несколькими контактами. Можно получать и отправлять сообщения из внешних мессенджеров (Telegram, ВКонтакте) прямо в программе в списке <strong>Обсуждения</strong>.</li>
<li>Предварительно можно настроить подключение к мессенджерам в разделе <strong>Администрирование - Интернет-поддержка и сервисы - Обсуждения</strong>.</li>
<li>При подключении можно указать не только <strong>1С:Диалог</strong>, но и собственный сервер системы взаимодействия.</li>
<li>Теперь не нужно отдельно указывать информацию об участниках обсуждения:
<ul>
<li>при установке флажка <strong>Недействителен</strong> в карточке пользователя он также автоматически блокируется в обсуждениях;</li>
<li>при редактировании контактной информации и фотографии в карточке пользователя эти изменения сразу применяются в списке участников обсуждения.</li>
</ul></li>
<li>Упрощен подбор новых участников обсуждения:
<ul>
<li>можно выбрать участника обсуждения из списка пользователей программы;</li>
<li>убедиться, что выбран нужный участник, посмотрев не только на имя, но и его контактную информацию, подразделение и его фото;</li>
<li>вставить участников обсуждения из буфера обмена.</li>
</ul></li>
</ul>
<h4 id="отчет-о-движениях-документа">Отчет о движениях документа</h4>
<ul>
<li>Комбинация клавиш для открытия отчета о движениях документа изменена на более удобную <strong>Ctrl+Shift+A</strong> (ранее была <strong>Ctrl+Shift+L</strong>).</li>
</ul>
<h4 id="поиск-и-удаление-дублей">Поиск и удаление дублей</h4>
<ul>
<li>После удаления дублей элементов (раздел <strong>Администрирование – Обслуживание – Корректировка данных</strong>) дополнительно выводится список мест, в которых заменили дубли и, возможно, появились новые. Например, при замене дублей контрагентов могут появиться дубли договоров.</li>
</ul>
<h4 id="полнотекстовый-поиск">Полнотекстовый поиск</h4>
<ul>
<li>Комбинация клавиш для открытия формы <strong>Поиск документов, файлов или отчетов</strong> изменена на <strong>Ctrl+Alt+F</strong>. Если в программе включен глобальный поиск, то прежняя комбинация <strong>Ctrl+Shift+F</strong> активизирует поле глобального поиска.</li>
</ul>
<h4 id="пользователи-7">Пользователи</h4>
<ul>
<li>В карточку пользователя теперь можно добавлять фотографию.</li>
<li>В различных формах и отчетах при редактировании полей со списками пользователей упрощен подбор пользователей:
<ul>
<li>в форме подбора можно быстро найти интересующего пользователя по части имени, адреса или телефона;</li>
<li>теперь можно посмотреть контактную информация пользователя и его фото;</li>
<li>вставить список выбираемых пользователей из буфера обмена.</li>
</ul></li>
</ul>
<h4 id="работа-с-почтовыми-сообщениями-4">Работа с почтовыми сообщениями</h4>
<ul>
<li>Для повышения удобства работы справочник <strong>Учетные записи электронной почты</strong> переименован в <strong>Настройки почты</strong>.</li>
<li>Существенно улучшена автоматическая настройка подключения к почте корпоративных доменов, обслуживаемых популярными почтовыми сервисами, такими как Яндекс, Mail.Ru и т. д. Также расширен список известных почтовых сервисов.</li>
<li>Расширена диагностика неполадок при подключении к почтовым серверам, выводится дополнительная техническая информация для администраторов локальной сети и почтового сервиса. На сайте ИТС опубликованы решения типовых проблем подключения к почтовым серверам: <a href="https://its.1c.ru/bmk/bsp_email_account">https://its.1c.ru/bmk/bsp_email_account</a>.</li>
<li>Для исключения ошибок ввода пароля при настройке почты добавлена возможность просмотра вводимых символов. В поле ввода пароля вводимые символы по умолчанию скрываются, их можно посмотреть, нажав на соответствующую кнопку справа в этом же поле.</li>
</ul>
<h4 id="структура-подчиненности">Структура подчиненности</h4>
<ul>
<li>Для проведения документа или пометки на удаление элемента в отчете <strong>Связанные документы</strong>, более не придется переходить в форму объекта. Достаточно выделить несколько строк в самом отчете и воспользоваться соответствующими командами.</li>
<li>Найти требуемый документ совсем не сложно, воспользовавшись командами поиска.</li>
<li>Перейти к отчету можно нажав комбинацию клавиш <strong>Ctrl+Shift+S</strong>.</li>
</ul>
<h4 id="удаление-помеченных-объектов-1">Удаление помеченных объектов</h4>
<ul>
<li>Теперь можно не ждать завершения поиска всех помеченных на удаление объектов – выберите интересующий вид объектов и ускорьте вывод списка помеченных на удаление.</li>
<li>В форме <strong>Удаление помеченных объектов</strong>:
<ul>
<li>Раньше было сложно найти объект в списке помеченных на удаления. Теперь можно вывести реквизиты объектов, помеченных на удаление, для каждого вида объекта для облегчения поиска;</li>
<li>стало удобнее исправлять проблемы при удалении объектов – видно всю цепочку связей не удаленного объекта.</li>
<li>больше не нужно ждать завершения замены ссылок или завершения пометки удаления не удаленного объекта. Теперь сначала выбирается способ устранение проблемы, а потом выполняется групповая обработка объектов.</li>
</ul></li>
<li>Раньше могли возникать трудности при удалении списка объектов со сложными связями. Для облегчения удаления объектов добавлен новый режим удаления – упрощенный. Теперь можно выбрать один из трех способов удаления объектов:
<ul>
<li><strong>Стандартный</strong> – выполняет полную проверку и не удаляет объекты при наличии мест использования.<br />
Подходит для удаления одиночных объектов и цепочек объектов с простыми связями.</li>
<li><strong>Упрощенный</strong> – очищает ссылки на удаляемые объекты в помеченных на удаление местах использования.<br />
Подходит для удаления цепочек объектов со сложными связями.</li>
<li><strong>Ускоренный</strong> – блокирует вход в программу.<br />
Подходит для срочного удаления большого объема данных.</li>
</ul></li>
<li>Существенно увеличена скорость удаления помеченных объектов (раздел <strong>Администрирование – Обслуживание – Удаление помеченных объектов</strong>) при выборе способов удаления <strong>Стандартный</strong> и <strong>Упрощенный</strong>.</li>
</ul>
<h4 id="управление-доступом-7">Управление доступом</h4>
<ul>
<li>С помощью отчета <strong>Анализ прав доступа</strong> администратор может наглядно получать сводную и подробную информацию об уровне доступа пользователей к отчетам и таблицам информационной базы:
<ul>
<li>Какие именно пользователи имеют права на просмотр, редактирование или создание тех или иных справочников, документов и т.д., с расшифровкой до групп доступа, посредством которых им предоставлены эти права;</li>
<li>Можно сгруппировать таблицы по отчетам, в которых выводятся данные из этих таблиц;</li>
<li>Без учета ограничений доступ к данным на уровне записей (RLS);</li>
<li>Отчет размещен в разделе <strong>Администрирование – Настройка пользователей и прав – Пользователи</strong>, может быть открыт из списка <strong>Пользователи</strong>, из карточки пользователя, а также из всех списков через меню <strong>Еще - Отчеты</strong>.</li>
</ul></li>
</ul>
<h4 id="центр-мониторинга-1">Центр мониторинга</h4>
<ul>
<li>В случае возникновения программной ошибки теперь выводится сообщение, которое может содержать важные подробности: инструкцию по обходу проблемы, информацию о наличии исправления, а также номер ошибки. Эти подробности доступны после того, как в настройках программы указано <strong>Разрешить автоматическую отправку сведений об использовании программы в фирму «1С»</strong> (раздел <strong>Администрирование</strong> - <strong>Интернет-поддержка и сервисы</strong> - <strong>Центр мониторинга</strong>). Отправляемые сведения используется сотрудниками фирмы «1С» для анализа и устранения проблем, помогают быстрее выпускать исправления ошибок.
<ul>
<li>Для отключения автоматической отправки информации о программных ошибках в фирму «1С» можно в перейти в <strong>Главное меню</strong>, открыть <strong>Функции для технического специалиста</strong> - <strong>Управление настройками обработки ошибок</strong> и изменить настройку <strong>Отправлять отчет</strong> на <strong>Спрашивать пользователя</strong> или на <strong>Не отправлять</strong>.</li>
</ul></li>
</ul>
<h4 id="шаблоны-сообщений-1">Шаблоны сообщений</h4>
<ul>
<li><p>В конфигурациях, поддерживающих несколько языков интерфейса, параметры шаблонов выводятся на текущем языке пользователя. Это позволяет редактировать шаблоны сообщений пользователям, работающих в программе на разных языках. <!--Локализация--> #### Электронная подпись</p></li>
<li><p>В связи с вступлением в силу с 01.01.2022 федерального закона от 27.12.2019 № 476-ФЗ “О внесении изменений в Федеральный закон «Об электронной подписи»”, удостоверяющий центр ООО «Научно-производственный центр “1С”» переходит к выпуску квалифицированных сертификатов только для физических лиц, включая сертификаты для сотрудников. С 01.04.2021 появится возможность оформить заявление на сертификат для физического лица так же просто, как для организаций. Для этого достаточно нажать <strong>Добавить</strong> - <strong>Заявление на выпуск сертификата</strong> в списке <strong>Настройки электронной подписи и шифрование</strong> (<strong>Мои настройки</strong> или <strong>Администрирование</strong> - <strong>Общие настройки</strong> - <strong>Электронная подпись и шифрование</strong>) и вместо варианта <strong>Организация</strong> выбрать <strong>Физическое лицо</strong>. <!--Конец локализация--></p></li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.3">Новые возможности для разработчиков в версии 3.1.3</h3>
<!--Локализация-->
<h4 id="адресный-классификатор">Адресный классификатор</h4>
<ul>
<li>Для получения по ОКТМО различных сведений о муниципальных образованиях (наименования адресных объектов, идентификаторы ФИАС, коды инспекции ФНС и др.) в программном интерфейсе общего модуля <code>АдресныйКлассификатор</code> предусмотрена функция <code>СведенияПоОКМТО</code>. Подробнее см. в описании к ней.</li>
</ul>
<h4 id="банки">Банки</h4>
<ul>
<li><p>Для получения сведений из <strong>Справочника БИК</strong> об участниках расчетов в программном интерфейсе общего модуля <code>РаботаСБанками</code> предусмотрена функция <code>СведенияБИК</code>. Подробнее см. в описании к ней.</p></li>
<li><p>Для интерактивного выбора участника расчетов из <strong>Справочника БИК</strong> по номеру БИК предусмотрена процедура <code>ВыбратьИзСправочникаБИК</code> в общем модуле <code>РаботаСБанкамиКлиент</code>. В процедуре определяется количество найденных записей по переданному БИК и в случае, если запись не единственная, либо таких записей нет, открывает форму выбора. В случае, если запись одна, выбор осуществляется автоматически. <!--Конец локализация--></p></li>
</ul>
<h4 id="варианты-отчетов-10">Варианты отчетов</h4>
<p>В программный интерфейс общего модуля <code>ВариантыОтчетов</code> добавлена функция <code>ИспользуемыеТаблицыОтчета</code>, которая расширяет функцию <code>ИспользуемыеТаблицы</code>. Достаточно передать только метаданные отчета, а функция самостоятельно:</p>
<ul>
<li>Получит схему компоновки данных отчета;</li>
<li>Получить коллекцию таблиц, используемых в СКД или запросе, вызвав функцию <code>ИспользуемыеТаблицы</code>;</li>
<li>Опционально вызовет событие объекта отчета <code>ПриОпределенииИспользуемыхТаблиц</code>.</li>
</ul>
<h4 id="взаимодействия-3">Взаимодействия</h4>
<ul>
<li>В программном интерфейсе общего модуля <code>Взаимодействия</code> добавлен метод <code>ЗаполнитьНаборыЗначенийДоступаПоУмолчанию</code>. С его помощью в процедуре <code>ПриЗаполненииНаборовЗначенийДоступа</code> общего модуля <code>ВзаимодействияПереопределяемый</code> можно объединять прикладной набор значений доступа к документам подсистемы со стандартным заполнением по умолчанию.</li>
<li>В программном интерфейсе общего модуля <code>Взаимодействия</code> добавлен метод <code>ПредметВзаимодействия</code>. Позволяет получить сведения о предмете взаимодействия, чтобы, например, добавить предмет в набор значений доступа взаимодействия.</li>
</ul>
<h4 id="базовая-функциональность-15">Базовая функциональность</h4>
<ul>
<li>Для упрощения вызова процедур общего модуля <code>АдминистрированиеКластера</code> по управлению сеансами и соединениями предусмотрены функции-конструкторы <code>ФильтрСеансов</code> и <code>ФильтрСоединений</code>.</li>
<li>Улучшена работа инструмента <code>Проверка внедрения БСП</code>:
<ul>
<li>Улучшена работа механизма сравнения состава типов – исключены отдельные случаи, в которых ошибка не обнаруживалась или описание ошибки было некорректным;</li>
<li>Новая проверка и автоматическое исправление некорректных прав на реквизиты и табличные части объектов.</li>
<li>Проверка и исправление ошибок по выгрузке файлов в формате EDT.</li>
<li>Реализован контроль версии используемого отчета – если она отличается от версии БСП, то некоторые проверки могут пропускать часть ошибок для избегания ложных срабатываний. Вместо этого будет регистрироваться ошибка различия версий отчета и БСП.</li>
</ul></li>
<li>Для расчета агрегированных показателей (сумма, количество, среднее, максимум, минимум) выделенных ячеек произвольного табличного документа реализована функция <code>РасчетныеПоказателиЯчеек</code> общего модуля <code>ОбщегоНазначенияКлиентСервер</code>.</li>
<li>Для улучшения результата, возвращаемого методом <code>ПредставлениеПериода</code>, добавлена функция <code>ПредставлениеПериодаВТексте</code> общего модуля <code>СтроковыеФункции</code>. Теперь, представление формируется более корректно – в нижнем регистре или с заглавной буквы, если, например, с периода начинается предложение.</li>
<li>Теперь и для регистров сведений, накопления и бухгалтерии у отдельных реквизитов поддержана возможность ввода и хранения значений сразу на нескольких языках:
<ul>
<li>Правила внедрения и программный интерфейс аналогичны правилам для справочников, документов и планов видов характеристик.</li>
<li>В общем модуле <code>МультиязычностьСервер</code> в процедуре <code>ПриСозданииНаСервере</code> добавлен третий необязательный параметр <code>ИмяСписка</code> для переопределения имени динамического списка на форме. Это может быть полезно при наличии нескольких динамических списков на форме.</li>
</ul></li>
<li>Для упрощения разработки прикладных решений с несколькими языками изменен программный интерфейс общего модуля <code>ОбщегоНазначения</code>:
<ul>
<li>В функциях <code>ЗначениеРеквизитаОбъекта</code>, <code>ЗначенияРеквизитовОбъекта</code>, <code>ЗначенияРеквизитовОбъектов</code>, <code>ЗначениеРеквизитаОбъектов</code> предусмотрен необязательный параметр <code>КодЯзыка</code>, позволяющий возвращать значение на требуемом языке для мультиязычных реквизитов.</li>
<li>Новые процедуры <code>УстановитьЗначениеРеквизита</code>, <code>УстановитьЗначенияРеквизитов</code> для сохранения значений на указанном языке для мультиязычных реквизитов.</li>
</ul></li>
<li>В функцию <code>МестаИспользования</code> модуля <code>ОбщегоНазначения</code> добавлен необязательный параметр <code>ДополнительныеПараметры</code>, позволяющий изменять настройки исключения поиска ссылок непосредственно при вызове функции <code>МестаИспользования</code>. Это может быть полезно при проверке ссылочной целостности с учетом прикладной специфики.</li>
</ul>
<h4 id="групповое-изменение-объектов">Групповое изменение объектов</h4>
<ul>
<li>Расширен состав подключаемых команд. В процедуре <code>ПриОпределенииОбъектовСКомандойГрупповогоИзмененияОбъектов</code> общего модуля <code>ГрупповоеИзменениеОбъектовПереопределяемый</code> можно подключить команды <code>ИзменитьВыделенные</code> к произвольным спискам и журналам.<br />
Пример см. в демонстрационной конфигурации в форме списка справочника <code>_ДемоНоменклатура</code>.</li>
</ul>
<h4 id="валюты-1">Валюты</h4>
<ul>
<li>По умолчанию курсы валют хранятся с точностью 4 знака после запятой. Для переопределения точности, с которой хранятся значения курсов валют, предусмотрен определяемый тип <code>КурсВалюты</code>.</li>
</ul>
<h4 id="даты-запрета-изменения-1">Даты запрета изменения</h4>
<ul>
<li>При реализации специальных сценариев работы, обмене данными и для ускорения массовой загрузки данных (если данные не попадают в запрещенный период) может возникнуть необходимость временно отключать проверку запрета изменения. Если запись объекта выполняется в режиме, когда признак <code>ОбменДанными.Загрузка</code> не установлен, и при записи объекта также записываются другие связанные с ним данные, то для отключения проверки запрета изменения в общем модуле <code>ДатыЗапретаИзменения</code> можно вызвать процедуру <code>ОтключитьПроверкуДатЗапрета</code>. Также предусмотрена функция <code>ПроверкаДатЗапретаОтключена</code> в этом же общем модуле.</li>
<li>Для упрощения вызова функции <code>НайденЗапретИзмененияДанных</code> общего модуля <code>ДатыЗапретаИзменения</code> предусмотрена функция-конструктор ее параметра <code>ПараметрыСообщенияОЗапрете</code>.</li>
</ul>
<h4 id="календарные-графики">Календарные графики</h4>
<ul>
<li>При использовании данных производственного календаря следует дополнительно учитывать периоды нерабочих дней, установленные в соответствии с законодательством. Получить такие периоды можно с помощью метода <code>ПериодыНерабочихДней</code> общего модуля <code>КалендарныеГрафики</code>.</li>
<li>Метод <code>ДатыБлижайшихРабочихДней</code> устарел, вместо него рекомендуется использовать: метод <code>БлижайшиеРабочиеДаты</code> для производственного календаря и метод <code>БлижайшиеДатыВключенныеВГрафик</code> общего модуля <code>ГрафикиРаботы</code> для графика работы соответственно.<br />
Для метода <code>БлижайшиеРабочиеДаты</code> реализован параметр <code>УчитыватьНерабочиеПериоды</code>, позволяющий по-разному интерпретировать периоды нерабочих дней в календарях РФ в 2020 году. Параметр <code>НерабочиеПериоды</code> в свою очередь позволяет уточнить, какие конкретно периоды нужно учитывать.</li>
</ul>
<h4 id="контактная-информация-4">Контактная информация</h4>
<!--Локализация-->
<ul>
<li>Для массовой проверки адресов на корректность и выявления устаревших адресов программный интерфейс общего модуля <code>РаботаСАдресами</code> расширен функция <code>ПроверитьАдреса</code>. Подробнее см. в описании к ней.</li>
<li>Для программного включения автоматического исправления устаревших адресов у вида контактной информации необходимо:
<ul>
<li><p>В обработчике обновления для вида контактной информации установить параметр <code>ИсправлятьУстаревшиеАдреса</code> в значение <code>Истина</code></p>
<pre class="1c"><code>ПараметрыВида = УправлениеКонтактнойИнформацией.ПараметрыВидаКонтактнойИнформации(&quot;Адрес&quot;);
ПараметрыВида.ИсправлятьУстаревшиеАдреса = Истина;
УправлениеКонтактнойИнформацией.УстановитьСвойстваВидаКонтактнойИнформации(ПараметрыВида);</code></pre></li>
<li><p>Рекомендуется активизировать этот параметр для адресов, требующих актуального состояния (например, адреса доставки) и не включать для юридически значимых адресов (например, адрес ЕГРЮЛ, место регистрации, рождения и др., т.к. они могут фигурировать в юридических документах).<!--Конец локализация--></p></li>
</ul></li>
<li>Для получения списка видов контактной информации произвольного объекта программный интерфейс общего модуля <code>УправлениеКонтактнойИнформацией</code> расширен функцией <code>ВидыКонтактнойИнформацииОбъекта</code>. Список может быть отфильтрован по типу контактной информации.</li>
<li>В случаях, когда возникает необходимость определить, содержит ли интересующий объект контактную информацию, в программном интерфейсе общего модуля <code>УправлениеКонтактнойИнформацией</code>, предусмотрена функция <code>СодержитКонтактнуюИнформацию</code>.</li>
<li>Для ускорения открытия форм с контактной информацией предлагается сконвертировать ее из предыдущих форматов в формат JSON для того, чтобы эта конвертация не выполнялась на лету при каждом открытии форм. Для этого в общем модуле <code>УправлениеКонтактнойИнформацией</code> предусмотрены функции программного интерфейса:
<ul>
<li><code>ОбъектыТребующиеОбновленияКонтактнойИнформации</code> возвращает список объектов, требующих обновления;</li>
<li><code>ОбновитьКонтактнуюИнформациюОбъекта</code> конвертирует ранее сохраненную контактную информации в формат JSON;</li>
<li>Пример использования функций в обработчике обновления см. модуле менеджере справочника <code>ДемоКонтактныеЛицаПартнеров</code> демонстрационной конфигурации. <!--Локализация-->- С версии 3.1.3.415 для заполнения муниципальных адресов в декларациях, регламентированных отчетах и др. документах в соответствии с приказом Минфина России от 5 ноября 2015 г. N 171н “Об утверждении Перечня элементов планировочной структуры, элементов улично-дорожной сети, элементов объектов адресации, типов зданий (сооружений), помещений, используемых в качестве реквизитов адреса, и Правил сокращенного наименования адресообразующих элементов” в общем модуле <code>РаботаСАдресами</code> предусмотрена функция программного интерфейса <code>СведенияОбАдресеПриказМинфинаРФ171н</code>, которая возвращает адрес в виде структуры. Это дает возможность получать типы полей адреса (региона, района, города и т.д.) согласно перечню сокращенных наименований видов субъектов Российской Федерации, муниципальных образований, населенных пунктов, элементов планировочной структуры, элементов улично-дорожной сети и идентификационных элементов объекта адресации. <!--Конец локализация--></li>
</ul></li>
</ul>
<h4 id="обмен-данными-14">Обмен данными</h4>
<ul>
<li>В структуру настроек планов обмена через универсальный формат EnterpriseData добавлено новое свойство <code>РасширенияФорматаОбмена</code>. Подробнее см. описание свойства в <code>ОбменДаннымиСервер.НастройкиПланаОбменаПоУмолчанию</code>.</li>
<li>В структуру описания варианта настройки обмена добавлено новое свойство <code>РасширениеФормата</code>. Подробнее см. описание свойства в <code>ОбменДаннымиСервер.ОписаниеВариантаНастройкиОбменаПоУмолчанию</code>.</li>
</ul>
<h4 id="обновление-версии-иб-9">Обновление версии ИБ</h4>
<ul>
<li>Для получения информации о ходе обновления информационной базы программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазы</code> расширен новыми функциями <code>ПрогрессОбновленияОбластейДанных</code>, <code>ОбработчикиОбновления</code> и <code>ОбновляемыеОбъекты</code>. Подробнее см. в комментариях к ним.</li>
<li>Для написания произвольной логики блокировки объектов в процессе обновления программный интерфейс модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> расширен процедурой <code>ПриВыполненииПроверкиОбъектОбработан</code>.</li>
<li>Если в библиотеке или конфигурации разрабатываются параллельные отложенные обработчики обновления:
<ul>
<li>Для таких обработчиков больше не требуется заполнять свойство <code>ОчередьОтложеннойОбработки</code>.</li>
<li>Если есть два обработчика, которые пересекаются по читаемым или изменяемым данным, то необходимо в описании одного из них заполнить свойство <code>ПриоритетыВыполнения</code> для корректного расчета очереди (ранее требовалось заполнять свойство у каждого зависимого обработчика).</li>
</ul></li>
<li>Для добавления новых обработчиков, а также для удобства разрешения конфликтов между ними предусмотрена обработка <code>Описание обработчиков обновления</code> (меню <code>Все функции</code>).
<ul>
<li>Для выгрузки измененных описаний необходимо указать разрабатываемые в текущей конфигурации подсистемы в процедуре <code>ПриФормированиеСпискаРазрабатываемыхПодсистем</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code>.<br />
Подробнее см. в описании к ней.</li>
</ul></li>
<li>Для дополнительного контроля корректности описания обработчиков обновления при запуске программы предусмотрена процедура <code>ПередФормированиеСпискаОтложенныхОбработчиков</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code>.</li>
<li>Для обновления произвольных предопределённых данных в обработчиках обновления и начального заполнения программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазы</code> расширен процедурами <code>ЗарегистрироватьПредопределенныеЭлементыДляОбновленияОбновлениеИнформационнойБазы</code> и <code>ЗаполнитьЭлементыНачальнымиДанными</code>. Подробнее см. комментарии к этим процедурам.</li>
<li>Для упрощения отладки и разработки новых обработчиков обновления в качестве версии обработчика теперь можно указывать значение <code>ОтладкаОбработчика</code>. В таком случае обработчик будет выполняться при каждом обновлении и для его отладки достаточно запустить программу с ключом <code>ЗапуститьОбновлениеИнформационнойБазы</code>. Так же это может быть удобно для случаев, когда точный номер версии для обработчика не известен до его помещения в основное хранилище.</li>
</ul>
<h4 id="обсуждения-1">Обсуждения</h4>
<ul>
<li>Для программной отправки сообщения участникам обсуждения предусмотрены процедуры <code>ОтправитьСообщение</code> и <code>ОтпавитьУведомление</code> общего модуля <code>Обсуждения</code>:</li>
</ul>
<pre class="1c"><code>Сообщение = Обсуждения.ОписаниеСообщения(&quot;Привет, мир!&quot;);
Получатель = ОбщегоНазначенияКлиентСервер.ЗначениеВМассиве(Администратор);
Обсуждения.ОтправитьСообщение(Пользователи.ТекущийПользователь(), Получатель, Сообщение);</code></pre>
<ul>
<li>Для сопоставления пользователей системы взаимодействия и элементов справочника <strong>Пользователи</strong> см. новые функции общего модуля <code>Обсуждения</code>.</li>
</ul>
<h4 id="подключаемые-команды">Подключаемые команды</h4>
<ul>
<li>Для форм, в которых в <code>ПередЗаписью</code> взводится <code>Отказ</code> и через обработчик ожидания выполняются дополнительные действия, предусмотрена процедура <code>ПослеЗаписи</code> общего модуля <code>ПодключаемыеКомандыКлиент</code>. Ее необходимо вызывать из обработчика события <code>ПослеЗаписи</code> для продолжения выполнения подключаемой команды. См. пример в форме <code>ФормаЭлемента</code> справочника <code>УчетныеЗаписиЭлектроннойПочты</code>.</li>
<li>Для удобства разработки собственных видов подключаемых команд предусмотрена функция-конструктор <code>ПараметрыВыполненияКоманды</code> в общих модулях <code>ПодключаемыеКоманды</code> и <code>ПодключаемыеКомандыКлиент</code>.</li>
<li>Для подключаемой команды теперь также можно выводить пометку (флажок). Например, кнопки “Принято к выполнению”, “Показывать удаленные элементы” и т.п. Для этого при описании подключаемой команды в свойстве <code>ЗначениеПометки</code> указать реквизит формы, в котором хранится состояние флажка (значение типа Булево). Подробнее см. описание процедуры <code>ПриОпределенииКомандПодключенныхКОбъекту</code> в общем модуле <code>ПодключаемыеКомандыПереопределяемый</code>.</li>
</ul>
<h4 id="поиск-и-удаление-дублей-1">Поиск и удаление дублей</h4>
<ul>
<li>Для обработки объектов, в которых не заменяются ссылки (см. <code>ПриДобавленииИсключенийПоискаСсылок</code> в общем модуле <code>ОбщегоНазначенияПереопределяемый</code>), теперь предусмотрена переопределяемая процедура <code>ПослеЗаменыСсылок</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>. Например, если в результате замены дублей появляются логически одинаковые записи регистра сведений, то можно исключить регистр из автозамены дублей и обработать записи самостоятельно после замены. Пример см. в демонстрационной конфигурации в процедуре <code>ПослеЗаменыСсылок</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code>.</li>
<li>При замене дублей теперь можно заменять дубли связанных объектов метаданных, подобранных по прикладным правилам или созданных во время замены.<br />
Например, при замене контрагента вместе с ним можно заменить его банковские счета. При этом, если был создан одинаковый банковский счет для дубля и оригинала, то при замене контрагентов будет подобрана замена банковского счета по номеру.<br />
Для этого необходимо:
<ul>
<li>определить связи между объектами в процедуре <code>ПриОпределенииСвязейПодчиненныхОбъектов</code> модуля <code>ОбщегоНазначенияПереопределяемый</code> и поля связи с основными объектами;</li>
<li>если подбор замены на основе равенства значений полей связи не подходит, то можно определить свою процедуру подбора замен. Пример см. в демонстрационной конфигурации в модуле менеджера справочника <code>_ДемоБанковскиеСчета</code>.</li>
</ul></li>
<li>Расширен состав подключаемых команд. В процедуре <code>ПриОпределенииОбъектовСКомандамиОбъединенияДублейЗаменыСсылок</code> модуля <code>ПоискИУдалениеДублейПереопределяемый</code> можно подключить команды <code>Объединить выделенные</code> и <code>Заменить выделенные</code> к произвольным спискам и журналам. Пример см. в демонстрационной конфигурации в форме списка справочника <code>_ДемоНоменклатура</code>.</li>
<li>Параметр <code>ПараметрыЗамены.ЗаменаПарыВТранзакции</code> функции <code>ЗаменитьСсылки</code> общего модуля <code>ОбщегоНазначения</code> устарел и игнорируется. Теперь для замены ссылок не открывается одной общей транзакции, а открываются отдельные транзакции на каждый объект, связанные с ним движения и последовательности.</li>
</ul>
<h4 id="получение-файлов-из-интернета">Получение файлов из Интернета</h4>
<ul>
<li>В функции <code>ДиагностикаСоединения</code> общего модуля <code>ПолучениеФайловИзИнтернета</code> предусмотрен параметр <code>ЗаписыватьОшибку</code> (по умолчанию <code>Истина</code>), с помощью которого можно отключать автоматическую запись диагностической информации в журнал регистрации, когда это не требуется. Например, это полезно в тех случаях, когда протоколирование выполняется другими средствами.</li>
</ul>
<h4 id="пользователи-8">Пользователи</h4>
<ul>
<li>Для отображения дополнительной информации при выборе пользователей можно переопределить форму подбора пользователей на собственную. Для этого необходимо указать новое имя формы подбора пользователей в процедуре <code>ПриОпределенииФормыВыбораПользователей</code> общего модуля <code>ПользователиПереопределяемый</code>.<br />
Подробности см. в описании этой процедуры.</li>
</ul>
<h4 id="рассылка-отчетов-2">Рассылка отчетов</h4>
<ul>
<li>В случае если требуется изменить настройки отчета перед его рассылкой, теперь возможно реализовать соответствующую логику в процедуре <code>ПриПодготовкеПараметровФормированияОтчета</code> общего модуля <code>РассылкаОтчетовПереопределяемый</code>.</li>
</ul>
<h4 id="структура-подчиненности-1">Структура подчиненности</h4>
<ul>
<li>Для управления выводом элементов дерева в отчете <code>Связанные документы</code> предусмотрена процедура <code>ПередВыводомСвязанногоОбъекта</code> общего модуля <code>СтруктураПодчиненностиПереопределяемый</code>. Например, она может быть полезна, если необходимо отказаться от вывода элементов в определенных случаях согласно прикладной логике.</li>
</ul>
<h4 id="удаление-помеченных-объектов-2">Удаление помеченных объектов</h4>
<ul>
<li>Повышена целостность удаления помеченных объектов. Теперь связанные объекты будут удаляться в одной транзакции, если задана связь между объектами в процедуре <code>ПриОпределенииСвязейПодчиненныхОбъектов</code> общего модуля <code>ОбщегоНазначенияПереопределяемый</code></li>
<li>Расширен программный интерфейс общего модуля <code>УдалениеПомеченныхОбъектов</code>:
<ul>
<li>Для программного удаления объектов с контролем ссылочной целостности предусмотрена функция <code>УдалитьПомеченныеОбъекты</code>.</li>
<li>Для получения списка помеченных на удаления объектов с учетом исключения поиска ссылок и предопределенных элементов реализована функция <code>ПомеченныеНаУдаление</code>. Подробнее см. описание этих функций.</li>
</ul></li>
<li>Для вызова интерактивного удаления помеченных из прикладного решения реализована процедура <code>НачатьУдалениеПомеченных</code> и <code>ПерейтиКУдалениюПомеченных</code> общего модуля <code>УдалениеПомеченныхОбъектовКлиент</code>. Подробнее см. описание функций.</li>
<li>В повседневной работе образуется помеченные на удаление объекты, которые нельзя удалить и хотелось бы скрыть. Теперь эту задачу можно решить средствами библиотеки.<br />
Команды скрытия/отображения помеченных на удаление объектов можно добавить на форму через механизм подключаемых команд. Подробнее см. документацию к библиотеке и программный интерфейс общих модулей <code>УдалениеПомеченныхОбъектовСервер</code> и <code>УдалениеПомеченныхОбъектовКлиент</code>.</li>
</ul>
<h4 id="управление-доступом-8">Управление доступом</h4>
<ul>
<li>С помощью отчета <code>Анализ прав доступа</code> администратор может наглядно получать сводную и подробную информацию об уровне доступа пользователей к отчетам и таблицам информационной базы.
<ul>
<li>При отсутствии в конфигурации подсистемы <code>Настройки программы</code> отчет необходимо разместить в рабочем месте администратора.</li>
<li>Для возможности перехода к отчету из форм объектов, в них необходимо встроить подсистему <code>Подключаемые команды</code>.</li>
<li>Если в конфигурацию не встроена подсистема <code>Варианты отчетов</code>, то отчет <code>АнализПравДоступа</code> следует удалить из метаданных конфигурации.</li>
</ul></li>
</ul>
<h4 id="центр-мониторинга-2">Центр мониторинга</h4>
<ul>
<li>Для программной проверки состояния отправки статистики реализована функция <code>ЦентрМониторингаВключен</code> общего модуля <code>ЦентрМониторинга</code>.</li>
</ul>
<h4 id="шаблоны-сообщений-2">Шаблоны сообщений</h4>
<ul>
<li>Для упрощения работы с общими реквизитами при программном формировании шаблонов сообщений расширен программный интерфейс общего модуля <code>ШаблоныСообщений</code> процедурой <code>ЗаполнитьОбщиеРеквизиты</code> и функцией <code>ИмяУзлаОбщихРеквизитов</code>. Подробнее см. комментарий к ним.</li>
</ul>
<h4 id="электронная-подпись-15">Электронная подпись</h4>
<ul>
<li>Для визуализации результатов проверки сертификата, выполненной заранее, в общий модуль <code>ЭлектроннаяПодписьКлиент</code> добавлена процедура <code>ПоказатьРезультатПроверкиСертификата</code>.</li>
<li>Для получения информации о причинах и способах исправления ошибки, возникшей при работе с электронной подписью, в общий модуль <code>ЭлектроннаяПодпись</code> добавлена функция <code>ОшибкаПоКлассификатору</code>.</li>
</ul>
<h3 id="переход-на-версию-3.1.3-с-версии-3.1.2">Переход на версию 3.1.3 с версии 3.1.2</h3>
<h4 id="обязательные-действия-по-переходу-4">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения (см. <a href="https://its.1c.ru/db/bspdoc">главу 2 Инструкция по внедрению библиотеки</a>).</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки. В исключительных (редких) случаях, когда такая совместимость не обеспечена, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки, в этом разделе приведены необходимые инструкции. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <code>Проверка внедрения БСП</code>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>. В этой версии состав проверок был дополнительно расширен, чтобы выявлять больше типовых проблем внедрения.</p>
<h5 id="календарные-графики-1">Календарные графики</h5>
<ul>
<li>Регистр сведений <code>ПериодыНерабочихДнейКалендаря</code> рекомендуется включать в состав планов обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="обновление-версии-иб-10">Обновление версии ИБ</h5>
<ul>
<li>Регистр сведений <code>ОбработчикиОбновления</code> рекомендуется включать только в состав начального образа планов обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
<li>Регистры сведений <code>ОбработчикиОбновленияОбщихДанных</code> и <code>ПотокиОбновления</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="удаление-помеченных-объектов-3">Удаление помеченных объектов</h5>
<ul>
<li>Регистры сведений <code>УдаляемыеОбъекты</code>, <code>НеудаленныеОбъекты</code> и константу <code>ПроверятьИспользованиеУдаляемыхОбъектов</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ).</li>
</ul>
<h4 id="необязательные-действия-по-переходу-4">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="варианты-отчетов-11">Варианты отчетов</h5>
<ul>
<li><p>Контекстные отчеты теперь возможно сохранять как новые варианты отчетов и включить в рассылки отчетов. Для того чтобы эти возможности вступили в силу, рекомендуется дополнительно пересмотреть места установки параметра формы отчета <code>ВидимостьКомандВариантовОтчетов</code> и отказаться от его использования. <!--Локализация--> ##### Вызов онлайн-поддержки</p></li>
<li><p>В версию 2.4.2 Библиотеки интернет-поддержки включена новая редакция данной подсистемы. Рекомендуется перейти на нее, т.к. в будущем подсистема может быть удалена из поставки Библиотеки стандартных подсистем. Подробнее см. раздел <code>Интеграция с 1С-Коннект</code> в файле UpdateISL.htm, который входит в состав поставки Библиотеки интернет-поддержки 2.4.2. <!--Конец локализация--></p></li>
</ul>
<h5 id="обновление-версии-иб-11">Обновление версии ИБ</h5>
<ul>
<li>Удалена процедура <code>ПриФормированииОчередейОтложенныхОбработчиков</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> как невостребованная.</li>
</ul>
<h5 id="обсуждения-2">Обсуждения</h5>
<ul>
<li>Для использования стандартной формы выбора пользователей для добавления участников обсуждения в модуле управляемого приложения в обработчик события <code>ОбработкаПолученияФормыВыбораПользователейСистемыВзаимодействия</code> вставить вызов подсистемы Обсуждения:</li>
</ul>
<pre class="1c"><code>    Если ОбщегоНазначенияКлиент.ПодсистемаСуществует(&quot;СтандартныеПодсистемы.Обсуждения&quot;) Тогда
    
        МодульОбсужденияСлужебныйКлиент = ОбщегоНазначенияКлиент.ОбщийМодуль(&quot;ОбсужденияСлужебныйКлиент&quot;);
        МодульОбсужденияСлужебныйКлиент.ПриПолученииФормыВыбораПользователейСистемыВзаимодействия(НазначениеВыбора, Форма, ИдентификаторОбсуждения, Параметры, ВыбраннаяФорма, СтандартнаяОбработка);
    
    КонецЕсли;</code></pre>
<h5 id="печать-7">Печать</h5>
<ul>
<li>Для улучшения диагностики в процедуре <code>ЗадатьОбластьПечатиДокумента</code> общего модуля <code>УправлениеПечатью</code> добавлена проверка типа параметра <code>Ссылка</code> (допускаются только ссылочные типы). При передаче значения некорректного типа будет записана ошибка в журнале регистрации. Необходимо проверить все места использования этой процедуры.</li>
<li>Вместо функции <code>ДанныеQRКода</code> общего модуля <code>УправлениеПечатью</code> следует использовать функции <code>ДанныеQRКода</code> или <code>ИзображениеШтрихкода</code> общего модуля <code>ГенерацияШтрихкодаВызовСервера</code> из библиотеки <code>1С:Библиотека подключаемого оборудования</code> версии 2.1.4 (или больше). В частности, в них улучшена работа в ОС Linux. Прежняя функция отмечена как устаревшая для обратной совместимости.</li>
</ul>
<h5 id="работа-с-файлами-6">Работа с файлами</h5>
<ul>
<li>Процедура <code>ИзменитьСправочникХраненияФайлов</code> общего модуля <code>РаботаСФайлами</code> отмечена как устаревшая. Вместо нее рекомендуется вызывать функцию <code>СконвертироватьФайлыВПрисоединенные</code> этого же общего модуля.</li>
</ul>
<h5 id="структура-подчиненности-2">Структура подчиненности</h5>
<ul>
<li><p>Если в конфигурацию встроена подсистема <code>ПодключаемыеКоманды</code>, рекомендуется очистить типы параметров общей команды <code>СвязанныеДокументы</code>, так как подсистема сама определит объекты, в подменю <code>Отчеты</code> которых будет выводиться команда <code>Связанные документы</code>. <!--Локализация--> ##### Электронная подпись</p></li>
<li><p>Для поддержки удобного заполнения заявления для физического лица, которое будет доступно пользователям с 01.04.2021, рекомендуется реализовать заполнение новых свойств <code>ИНН</code>, <code>АдресРегистрации</code> и <code>Телефон</code> в параметре <code>Параметры</code> процедуры <code>ПриЗаполненииРеквизитовВладельцаВЗаявленииНаСертификат</code>. Смотри пример в демонстрационной конфигурации в общем модуле <code>_ДемоСтандартныеПодсистемы</code>.</p></li>
<li><p>Для поддержки срока прекращения доступности заявления для организаций с 01.12.2021, при использовании процедуры <code>ДобавитьСертификат</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с целью создания нового заявления на сертификат для организации, требуется обеспечить управление видимостью этой команды с помощью функции <code>ДоступностьСозданияЗаявления</code> общего модуля <code>ЭлектроннаяПодпись</code>. Кроме того, следует реализовать команду добавления заявления для физического лица (также с управлением видимостью, для поддержки срока начала доступности заявления для физических лиц с 01.04.2021). Смотри пример в демонстрационной конфигурации в формах списков справочников <code>_ДемоОрганизации</code> и <code>_ДемоФизическиеЛица</code>. <!--Конец локализация--></p></li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.3">Особенности обновления с ранних версий на версию 3.1.3</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.2) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <code>Переход с предыдущих версий</code> для каждой пропущенной версии.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.3">Переход на исправительные релизы 3.1.3</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.3.<strong>1</strong>, 3.1.3.<strong>20</strong>, 3.1.3.<strong>300</strong> из т.п. Для обновления на исправительные релизы предназначена внешняя обработка <strong>ОбновлениеНаИсправительнуюВерсиюБСП.epf</strong> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <strong>Обновить на исправительную версию</strong>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <strong>Сформировать файл настроек</strong> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <strong>ПроверкаВнедренияБСП.erf</strong>. <!--Локализация--> #### С версии 3.1.3.453 и меньше</p>
<h5 id="электронная-подпись-16">Электронная подпись</h5>
<ul>
<li>Для поддержки удобного заполнения заявления для физического лица, которое будет доступно пользователям с 01.04.2021, рекомендуется реализовать заполнение новых свойств <code>ИНН</code>, <code>АдресРегистрации</code> и <code>Телефон</code> в параметре <code>Параметры</code> процедуры <code>ПриЗаполненииРеквизитовВладельцаВЗаявленииНаСертификат</code>. Смотри пример в демонстрационной конфигурации в общем модуле <code>_ДемоСтандартныеПодсистемы</code>.</li>
<li>Для поддержки срока прекращения доступности заявления для организаций с 01.12.2021, при использовании процедуры <code>ДобавитьСертификат</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с целью создания нового заявления на сертификат для организации, требуется обеспечить управление видимостью этой команды с помощью функции <code>ДоступностьСозданияЗаявления</code> общего модуля <code>ЭлектроннаяПодпись</code>. Кроме того, следует реализовать команду добавления заявления для физического лица (также с управлением видимостью, для поддержки срока начала доступности заявления для физических лиц с 01.04.2021). Смотри пример в демонстрационной конфигурации в формах списков справочников <code>_ДемоОрганизации</code> и <code>_ДемоФизическиеЛица</code>. <!--Конец локализация--></li>
</ul>
<h4 id="с-версии-3.1.3.303-и-меньше">С версии 3.1.3.303 и меньше</h4>
<h5 id="базовая-функциональность-16">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения подсистемы <code>Обновление версии ИБ</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.3.250-и-меньше">С версии 3.1.3.250 и меньше</h4>
<h5 id="базовая-функциональность-17">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, улучшена проверка внедрения подсистемы <code>БазоваяФункциональность</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.3.215-и-меньше">С версии 3.1.3.215 и меньше</h4>
<h5 id="базовая-функциональность-18">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, обновлен макет с эталонными значениями прав для роли <code>ПолныеПрава</code>, а также улучшена диагностика внедрения подсистемы <code>Заметки пользователя</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.3.187-и-меньше">С версии 3.1.3.187 и меньше</h4>
<h5 id="базовая-функциональность-19">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, обновлен макет с эталонным значением прав для роли <code>ПолныеПрава</code> для справочника <code>ПоставляемыеДополнительныеОтчетыИОбработки</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h2 id="версия-3.1.2">Версия 3.1.2</h2>
<p>Версия 3.1.2 предназначена для разработки на платформе <strong>1С:Предприятие</strong> в режиме совместимости с версиями 8.3.14, 8.3.15 или 8.3.16, т.е.:</p>
<ul>
<li>8.3.14, если в свойстве <code>Режим совместимости</code> установлено значение <code>Не использовать</code>;</li>
<li>8.3.15, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code> или <code>Не использовать</code>;</li>
<li>8.3.16, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Не использовать</code>;</li>
<li>8.3.17 и выше, если в свойстве <code>Режим совместимости</code> установлено значение <code>Версия 8.3.14</code>, <code>Версия 8.3.15</code> или <code>Версия 8.3.16</code>.</li>
</ul>
<p>Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.2</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.2">Новые возможности и изменения в версии 3.1.2</h3>
<h4 id="базовая-функциональность-20">Базовая функциональность</h4>
<ul>
<li>Для удобства управления большим количеством расширений конфигурации в форме <strong>Расширения</strong> (раздел <strong>Администрирование – Печатные формы, отчеты и обработки - Расширения</strong>) можно обновлять, а также выгружать в папку сразу несколько выбранных расширений за одно действие.</li>
<li>Для упрощения анализа ошибок в журнале регистрации информация о блокировке запуска регламентных заданий записывается с уровнем критичности <strong>Предупреждение</strong> вместо <strong>Ошибка</strong> (раздел <strong>Администрирование – Обслуживание – Журнал регистрации</strong>).</li>
<li>Предложение о перезапуске для применения обновления программы сделано менее навязчивым и более информативным: блокирующее окно заменено на всплывающее оповещение, по нажатию на которое можно узнать подробности. Например, какие именно установленные исправления ошибок (патчи) потребовали перезапуска.
<ul>
<li>Кроме того, можно совсем отключить такие уведомления. Включить их обратно можно в персональных настройках – см. флажок <strong>Показывать предупреждение об установленных обновлениях программы</strong>.</li>
<li>Сообщения о перезапуске теперь также выводится в панели <strong>Текущие дела</strong> на начальной странице.</li>
</ul></li>
</ul>
<h4 id="варианты-отчетов-12">Варианты отчетов</h4>
<ul>
<li>При сохранении нового варианта отчета можно указать конкретного пользователя, список пользователей или группы пользователей, для которых он предназначен: например, сохранить вариант отчета по продажам только для менеджеров Иванова и Сидорова, либо для всего отдела продаж.
<ul>
<li>Ранее предоставлялась возможность сохранять варианты отчетов сразу для всех пользователей, которые имеют права доступа на отчет. В некоторых случаях это могло быть избыточным.</li>
<li>Теперь автор может управлять тем, чтобы его вариант отчета появлялся в панелях отчетов только у тех пользователей, кому он действительно необходим (например, по должностным обязанностям) и при этом не «замусоривать» панели отчетов остальных пользователей, которые также имеют права доступа на отчет. Однако при необходимости они смогут разместить вариант отчета в своих панелях отчетов самостоятельно, воспользовавшись режимом настройки (кнопка <strong>Настроить</strong> в панели отчета).</li>
<li>Автор варианта отчета также может пересмотреть список пользователей в любой другой момент времени, перезаписав варианта отчета, либо открыв его карточку из списка <strong>Отчеты</strong>.</li>
<li>Если в программе включены внешние пользователи и группы пользователей (раздел <strong>Администрирование – Настройки пользователей и прав</strong>), то автор варианта отчета также может указать группы внешних пользователей, для которых он предназначен.</li>
<li>В тех случаях, когда действительно необходимо сохранить вариант отчета сразу для всех пользователей, которые имеют права доступа на отчет, следует указать предопределенную группу <strong>Все пользователи</strong> (<strong>Все внешние пользователи</strong>).</li>
</ul></li>
<li>С помощью команды <strong>Поделиться настройками</strong> в меню <strong>Еще – Прочее</strong> можно поделиться настройками варианта отчета с коллегами, работающими в программе. Также можно обмениваться вариантами и настройками отчетов между однотипными программами (информационные базы с одинаковыми отчетами). См. в форме отчета меню <strong>Еще – Варианты отчета – Обновить из файла</strong> и <strong>Сохранить в файл</strong>.</li>
<li>Если включены обсуждения (раздел <strong>Администрирование – Интернет-поддержка и сервисы – Обсуждения</strong>), то при предоставлении доступа к варианту отчета или передаче настроек отчета адрес получает мгновенные уведомления.</li>
</ul>
<h4 id="контактная-информация-5">Контактная информация</h4>
<ul>
<li>Если для адресов и телефонов не требуется ввод по полям, например при вводе иностранных адресов, то в настройках вида контактной информации (раздел <strong>Администрирование – Общие настройки – Виды контактной информации</strong>) у свойства <strong>Редактировать</strong> предусмотрен вариант <strong>В поле ввода</strong>, позволяющие отключить ввод в диалоге.</li>
</ul>
<h4 id="контроль-ведения-учета-2">Контроль ведения учета</h4>
<ul>
<li>При каждом запуске программа сообщает о выявленных проблемах ведения учета с помощью всплывающего уведомления (примечание для разработчиков: в том случае, если в конфигурации отсутствует подсистема <strong>Текущие дела</strong>).</li>
<li>В панели <strong>Текущие дела</strong> на начальной странице, а также в отчете <strong>Контроль ведения учета</strong> теперь выводится персонализированный список проблем. В подсчет количества и список не включаются документы (справочники и другие объекты программы), за которые явно назначен ответственным другой пользователь.</li>
<li>В отчете <strong>Контроль ведения учета</strong> предусмотрены быстрые отборы по периоду, проверкам и ответственному. Улучшено сообщение о наличии проблем ведения учета в карточке проблемного документа (объекта): выводится дата и время последней проверки. Если в документе выявлена только одна проблема, то сразу выводится ее описание. После записи документа оперативно выполняется перепроверка для подтверждения устранения проблемы.</li>
<li>Для повышения удобства в списках и карточке объекта картинка индикатора проблем теперь соответствует самой критичной из найденных проблем.</li>
<li>Для администраторов: информация о критичных проблемах записывается в журнал регистрации со статусом <strong>Ошибка</strong>.</li>
</ul>
<h4 id="обновление-версии-иб-12">Обновление версии ИБ</h4>
<ul>
<li>Для повышения удобства обновления больших информационных баз приоритет выполнения дополнительных процедур обработки данных сохраняется и применяется при переходе на следующие версии программы.
<ul>
<li>По умолчанию установлен приоритет обработки данных, а изменить это значение можно в разделе <strong>Администрирование – Обслуживание</strong>, группа <strong>Обновление программы</strong>.</li>
</ul></li>
<li>Для пакетного запуска сеанса для обновления на новую версию программы с приоритетом обработки данных можно использовать параметр запуска <strong>/C ФорсироватьОтложенноеОбновление</strong>.</li>
<li>При работе через Интернет для уменьшения времени недоступности сервиса после обновления на новую версию приложения, вход любого пользователя форсирует завершение обновления приложения (области данных).</li>
</ul>
<h4 id="обновление-конфигурации">Обновление конфигурации</h4>
<ul>
<li>Для оперативного устранения различных проблем в работе программы в базовых версиях конфигураций добавлена возможность установки исправлений (патчей) в разделе <strong>Администрирование – Обслуживание</strong> по ссылке <strong>Установка обновлений и исправлений (патчей)</strong>.
<ul>
<li>Необходима технологическая платформа <strong>1С:Предприятие</strong> версии:
<ul>
<li>8.3.15.1958 или выше</li>
<li>8.3.16.1359 или выше</li>
<li>8.3.17.1386 или выше</li>
</ul></li>
</ul></li>
</ul>
<h4 id="подключаемые-команды-1">Подключаемые команды</h4>
<ul>
<li>Некоторые редко используемые команды в формах, такие как просмотр отчета <strong>Движения документа</strong>, теперь отображаются только в меню <strong>Еще</strong>.</li>
</ul>
<h4 id="работа-в-модели-сервиса">Работа в модели сервиса</h4>
<ul>
<li>Для приложений в модели сервиса в комплект поставки в папке <strong>ExtFilesданные</strong> размещена внешняя обработка <strong>ЗагрузкаКлассификатораОшибокКриптографии.epf</strong>, предназначенная для загрузки информации о типичных проблемах, возникающих при работе с электронной подписью и способах их решения. Подключаются в <strong>Менеджере сервиса</strong>, см. <a href="https://its.1c.ru/db/freshpub#content:303:hdoc">https://its.1c.ru/db/freshpub#content:303:hdoc</a>.</li>
</ul>
<h4 id="работа-с-файлами-7">Работа с файлами</h4>
<ul>
<li>Улучшено хранение файлов в томах на диске для более точной настройки правил резервного копирования. Файлы в томах размещаются в подкаталогах с именами справочников (документов и т.д.), к которым присоединены. При этом если тома уже были настроены, то размещение файлов остается прежним, а включить размещение файлов в подкаталогах дополнительно потребуется в разделе <strong>Администрирование – Настройка работы с файлами</strong>.</li>
<li>Теперь можно раздельно хранить наиболее важные файлы в информационной базе, а менее важные – в томах на диске. Настроить расширения файлов, которые должны храниться в информационной базе, а также установить ограничение на их максимальный размер можно в разделе <strong>Администрирование – Настройка работы с файлами</strong>.</li>
<li>Для переноса файлов в том хранения большего размера или для создания тома хранения архивных файлов предусмотрена команда <strong>Перенос файлов</strong> (раздел <strong>Администрирование – Настройка работы с файлами</strong>).Для редких случаев, когда необходимо отказаться от хранения файлов в томах на диске, с помощью этой же команды можно перенести файлы из томов на диске в информационную базу.</li>
<li>При переносе файлов можно указать дополнительные условия, например, чтобы перенести только часть файлов из тома хранения в архив, или перенести из информационной базы в тома только файлы большого объема.</li>
<li>Для повышения безопасности и организации хранения файлов при работе приложения в Интернете (технология <a href="http://v8.1c.ru/fresh/whatis.htm">1cFresh</a>) возможно настроить раздельное хранение файлов каждого абонента (области данных) в подкаталогах. Для этого в полном пути тома необходимо указать <strong>%z</strong> (раздел <strong>Администрирование – Настройка работы с файлами – Тома хранения файлов</strong>). Например, <strong>\server%z</strong>.</li>
<li>Если в программу ошибочно был присоединен файл, содержащий конфиденциальные данные, его можно самостоятельно удалить без возможности восстановления (в списке или карточке файла см. меню <strong>Еще – Удалить</strong>).</li>
</ul>
<h4 id="свойства-3">Свойства</h4>
<ul>
<li>Упрощена настройка дополнительных реквизитов и сведений в разделе <strong>Администрирование – Обслуживание</strong>. Удалены избыточные опции:
<ul>
<li><strong>Реквизиты и сведения с общим списком значений</strong> - добавление реквизитов данного типа теперь доступно всегда;</li>
<li><strong>Общие реквизиты и сведения</strong> – все реквизиты теперь считаются общими и работа с ними в программе ведется единообразно.</li>
</ul></li>
<li>В списке дополнительных реквизитов (<strong>Администрирование – Общие настройки</strong>, ссылка <strong>Дополнительные реквизиты</strong>) теперь можно установить флаг <strong>Показать неиспользуемые реквизиты</strong>, посмотреть список реквизитов и сведений, которые больше не используются в программе и принять решении об их удалении или использовании.</li>
</ul>
<h4 id="управление-доступом-9">Управление доступом</h4>
<ul>
<li>Повышено удобство настройки прав доступа для подразделений, складов и других иерархических справочников. При настройке разрешенных значений в группах доступа (раздел <strong>Администрирование – Настройки пользователей и прав – Группы доступа</strong>) можно указать признак <strong>Включая нижестоящие (с иерархией)</strong> вместо подбора всех подчиненных элементов справочника. Данная возможность недоступна в случае, когда уже предусмотрен выбор группы значений, например, групп доступа партнеров.</li>
</ul>
<h4 id="шаблоны-сообщений-3">Шаблоны сообщений</h4>
<ul>
<li><p>При подготовке нового письма по предмету (заказу покупателя и т. п.) без использования шаблона можно приложить к письму печатные формы этого предмета. <!--Локализация--> #### Электронная подпись</p></li>
<li><p>В настройках электронной подписи и шифрования (раздел <strong>Администрирование – Общие настройки – Электронная подпись и шифрование</strong>) существенно упрощена отправка заявления на выпуск нового квалифицированного сертификата электронной подписи:</p>
<ul>
<li>Заявление формируется и отправляется в одном окне;</li>
<li>Если требуется получить новый сертификат взамен сертификата с истекающим сроком действия, сформировать новое заявление можно путем копирования информации из сертификата, полученного ранее;</li>
<li>Часто возникающие вопросы о назначении электронной подписи, цене сертификата и др. размещены на странице портала ИТС 1С:Подпись <a href="https://portal.1c.ru/applications/31">https://portal.1c.ru/applications/31</a></li>
</ul></li>
<li><p>Улучшена диагностика проблем, возникающих при работе с электронной подписью:</p>
<ul>
<li>выводятся причины и рекомендации по устранению типичных проблем, возникающих при настройке программ электронной подписи и шифрования (<strong>Администрирование – Общие настройки – Настройки электронной подписи и шифрования – Программы</strong>), при подписании, шифровании и проверке сертификатов; с их полным перечнем также можно ознакомиться на портале 1С:ИТС: https://its.1c.ru/db/metod81#content:5784:hdoc;</li>
<li>В некоторых случаях снижено количество возникающих проблем;</li>
<li>При возникновении иных затруднений при работе с электронной подписью рекомендуется собирать все необходимые сведения для отправки в техническую поддержку по гиперссылке <strong>Требуется помощь?</strong>. Эти сведения включают: информацию об используемой программе, программах электронной подписи другие данные, которые можно просмотреть перед отправкой. <!--Конец локализация--> ### Новые возможности для разработчиков в версии 3.1.2</li>
</ul></li>
</ul>
<h4 id="базовая-функциональность-21">Базовая функциональность</h4>
<ul>
<li>Упрощена разработка мультиязычных конфигураций, в которых отдельные реквизиты должны вводиться и храниться сразу на нескольких языках (помимо основного языка возможны максимум два дополнительных). Например, для хранения значений реквизита <code>Наименования</code> справочника <code>РолиИсполнителей</code> на двух дополнительных языках необходимо:
<ul>
<li>В свойстве <code>Состав</code> общих реквизитов <code>НаименованиеЯзык1</code> и <code>НаименованиеЯзык2</code> у справочника <code>РолиИсполнителей</code> в поле <code>Использование</code> установить значение <code>Использовать</code>.</li>
<li>Затем выполнить вставки в форму списка, элемента, модуль объекта и модуль менеджера согласно документации к подсистеме <code>Базовая функциональность</code> (см. раздел <code>Мультиязычные данные</code>).</li>
<li>Администратору при первом запуске информационной базы будет предложено выбрать основной и дополнительные языки ввода данных. Кроме того, эти языки можно перевыбрать позднее из раздела <code>Администрирование</code>.</li>
<li>Подробнее см. документацию к библиотеке и программный интерфейс общих модулей <code>МультиязычностьСервер</code>, <code>МультиязычностьКлиент</code> и <code>МультиязычностьПереопределяемый</code>.</li>
</ul></li>
<li>Для интерактивного выбора формата вложений при подготовке нового письма в программный интерфейс модуля <code>ОбщегоНазначенияКлиент</code> добавлена процедура <code>ПоказатьВыборФорматаВложений</code>.</li>
<li>Для выборки значений одинаковых реквизитов объектов разных типов снято ограничение в функциях <code>ЗначенияРеквизитовОбъектов</code> и <code>ЗначенияРеквизитаОбъектов</code> в общем модуле <code>ОбщегоНазначения</code>. Например, это удобно для выборки значений реквизитов из журнала документов.</li>
<li>При выборе каталога с помощью функции <code>ВыбратьКаталог</code> общего модуля <code>ФайловаяСистемаКлиент</code> можно указать начальное значение, которое будет показано при открытии диалога выбора. Для этого в функцию добавлен необязательный параметр <code>Каталог</code>.</li>
<li>Упрощен программный интерфейс для запуска длительных операций – в качестве фонового задания можно вызывать функции без необходимости переделки состава параметров. Таким же образом можно выполнять в фоне процедуры, не использующие параметры с возвращаемыми значениями. Для этого в общем модуле <code>ДлительныеОперации</code> предусмотрены функции <code>ВыполнитьФункцию</code> и <code>ВыполнитьПроцедуру</code>, а также вспомогательные функции <code>ПараметрыВыполненияФункции</code> и <code>ПараметрыВыполненияПроцедуры</code>. Описание параметров см. в комментарии к этим функциям.</li>
<li>Для получения представления объекта или его списка из метаданных предусмотрены функции <code>ПредставлениеОбъекта</code> и <code>ПредставлениеСписка</code> в общем модуле <code>ОбщегоНазначения</code>. В зависимости от того, какие свойства объекта метаданных заполнены, функции возвращают одно из них в указанном порядке: <code>Расширенное представление объекта/списка</code>, <code>Представление объекта/списка</code>, <code>Синоним</code> или <code>Имя</code>.</li>
<li>Предложение о перезапуске для применения обновления программы сделано менее навязчивым: блокирующее окно заменено на всплывающее оповещение. Кроме того, можно полностью отключить уведомления. Включить их обратно можно в персональных настройках – см. флажок <code>Показывать предупреждение об установленных обновлениях программы</code>.
<ul>
<li>Управление этой настройкой рекомендуется добавить в форме персональных настроек пользователя.</li>
<li>Для размещения нового флажка в формах персональных настроек следует использовать процедуры <code>ПоказыватьПредупреждениеОбУстановленныхОбновленияхПрограммы</code> общего модуля <code>СтандартныеПодсистемыСервер</code> (для чтения значения настройки) и <code>СохранитьПерсональныеНастройки</code> общего модуля <code>ОбщегоНазначения</code> (для сохранения значения).</li>
</ul></li>
</ul>
<h4 id="варианты-отчетов-13">Варианты отчетов</h4>
<ul>
<li>Настройка колонтитулов отчетов теперь включена по умолчанию (общие настройки см. в разделе <code>Администрирование – Печатные формы, отчеты и обработки – Настройка колонтитулов</code>, а индивидуальные настройки колонтитулов для выбранного отчета устанавливаются в расширенном режиме настройки на закладке <code>Оформление</code>). Если же требуется выключить, то в процедуре <code>ПриОпределенииНастроек</code> общего модуля <code>ВариантыОтчетовПереопределяемый</code> необходимо:
<ul>
<li><p>Для выключения общей настройки вставить строку:</p>
<pre class="1c"><code>Настройки.ВыводитьОбщиеНастройкиКолонтитулов = Ложь;</code></pre></li>
<li><p>Для выключения индивидуальной настройки вставить строку:</p>
<pre class="1c"><code>Настройки.ВыводитьИндивидуальныеНастройкиКолонтитулов = Ложь;</code></pre></li>
</ul></li>
<li>С помощью события модуля отчета <code>ПриОпределенииСвойствЭлементовФормыНастроек</code> общего модуля <code>ОтчетыСервер</code> можно переопределить внешний вид элементов шапки отчета, связанных с пользовательскими настройками:
<ul>
<li>Группа элементов (обычная группа);</li>
<li>Группировка группы элементов;</li>
<li>Отображение группы элементов;</li>
<li>Положение заголовка элемента;</li>
<li>Признак <code>РастягиватьПоГоризонтали</code> элемента;</li>
<li>Ширина элемента.</li>
</ul></li>
<li>Значения по умолчанию см. в функции <code>СвойстваГруппыЭлементовФормы</code> общего модуля <code>ОтчетыСервер</code>. Например, чтобы разместить горизонтально поля параметров <code>Период</code>, <code>Имя таблицы</code> и скрыть их заголовки:</li>
</ul>
<pre class="1c"><code>Процедура ПриОпределенииСвойствЭлементовФормыНастроек(ТипФормы, СвойстваЭлементов, ПользовательскиеНастройки) Экспорт
  СвойстваГруппы = ОтчетыСервер.СвойстваГруппыЭлементовФормы();  
  СвойстваГруппы.Группировка = ГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяВсегда;  
  СвойстваЭлементов.Группы.Вставить(&quot;ОбщиеПараметры&quot;, СвойстваГруппы);
  ОбщиеПараметры = Новый Структура(&quot;Период, ИмяТаблицы&quot;);
  Для Каждого Элемент Из ПользовательскиеНастройки Цикл   
    СвойстваПоля = СвойстваЭлементов.Поля.Найти(  
    Элемент.ИдентификаторПользовательскойНастройки, &quot;ИдентификаторНастройки&quot;);  
    СвойстваПоля.ИдентификаторГруппы = &quot;ОбщиеПараметры&quot;;
    СвойстваПоля.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Нет;  
  КонецЦикла;
КонецПроцедуры</code></pre>
<ul>
<li>В некоторых случаях возникает необходимость в переформировании схемы компоновки данных (СКД) при редактировании значения параметра пользователем. Например, в универсальном отчете - подменять запрос и другие свойства набора данных при изменении типа или имени объекта. Для того чтобы определить, что изменение параметра требует переформирования СКД (при вызове обработчика <code>ПередЗагрузкойВариантаНаСервере</code>), добавлено свойство настроек отчета <code>ЗагрузитьНастройкиПриИзмененииПараметров</code> – массив элементов типа <code>ЗначениеПараметраНастроекКомпоновкиДанных</code>.<br />
Например, в модуле объекта отчета в процедуре <code>ОпределитьНастройкиФормы</code> описывается следующий код:</li>
</ul>
<pre class="1c"><code>Процедура ОпределитьНастройкиФормы(Форма, КлючВарианта, Настройки) Экспорт
    Параметры = Новый Массив;  
    Параметры.Добавить(Новый ПараметрКомпоновкиДанных(&quot;ИмяТаблицыНабораДанных&quot;));
    Настройки.ЗагрузитьНастройкиПриИзмененииПараметров = Параметры;
КонецПроцедуры</code></pre>
<ul>
<li>Для улучшения диагностики предусмотрена процедура <code>ИнициализироватьКомпоновщикНастроек</code> общего модуля <code>ОтчетыСервер</code>. С ее помощью возникающие ошибки СКД при инициализации компоновщика настроек записываются в журнал регистрации с уровнем <code>Ошибка</code>.
<ul>
<li><p>Например, вместо:</p>
<pre class="1c"><code>КомпоновщикНастроек.Инициализировать(Новый ИсточникДоступныхНастроекКомпоновкиДанных(Схема));</code></pre></li>
<li><p>рекомендуется вызывать:</p>
<pre class="1c"><code>
ИнициализироватьКомпоновщикНастроек(Отчет.КомпоновщикНастроек, АдресСхемы, Отчет, ВариантОтчета);</code></pre></li>
</ul></li>
</ul>
<h4 id="версионирование-объектов">Версионирование объектов</h4>
<ul>
<li>Изменено размещение и внешний вид общей команды <code>ИсторияИзменений</code>. Теперь команда по умолчанию размещается не в панели навигации, а в командной панели формы.</li>
</ul>
<h4 id="внешние-компоненты">Внешние компоненты</h4>
<ul>
<li>Для подключения сторонних внешних компонент, одобренных администратором, на сервере 1С:Предприятия программный интерфейс общего модуля <code>ВнешниеКомпонентыСервер</code> расширен функциями <code>ПодключитьКомпоненту</code> и <code>ПараметрыПодключения</code>. Подробнее см. в комментариям к ним.</li>
</ul>
<h4 id="даты-запрета-изменения-2">Даты запрета изменения</h4>
<ul>
<li>Предусмотрена возможность предопределения собственных правил проверки даты запрета. Например, когда один документ метаданных для пользователя выступает как два документа, у которого доступность редактирования определяется по разным реквизитам в зависимости от типа документа. Для этого в программном интерфейсе общего модуля <code>ДатыЗапретаИзмененияПереопределяемый</code> добавлены две процедуры <code>ПередПроверкойСтаройВерсииДанных</code> для существующей версии данных и <code>ПередПроверкойНовойВерсииДанных</code> для новой (будущей) версии данных. Подробнее см. в комментарии к этим процедурам.</li>
</ul>
<h4 id="запрет-редактирования-реквизитов-объектов-2">Запрет редактирования реквизитов объектов</h4>
<ul>
<li>Для определения реквизитов объекта, по которым установлен запрет редактирования, в программный интерфейс общего модуля <code>ЗапретРедактированияРеквизитовОбъектов</code> добавлена функция <code>БлокируемыеРеквизитыОбъекта</code>.</li>
</ul>
<h4 id="календарные-графики-2">Календарные графики</h4>
<ul>
<li>При использовании данных производственного календаря следует дополнительно учитывать периоды нерабочих дней, установленные в соответствии с законодательством. Начиная с версии 3.1.2.343 получить такие периоды можно с помощью метода <code>ПериодыНерабочихДней</code> общего модуля <code>КалендарныеГрафики</code>.</li>
<li>Начиная с версии 3.1.2.360 метод <code>ДатыБлижайшихРабочихДней</code> устарел, вместо него рекомендуется использовать: метод <code>БлижайшиеРабочиеДаты</code> для производственного календаря и метод <code>БлижайшиеДатыВключенныеВГрафик</code> общего модуля <code>ГрафикиРаботы</code> для графика работы соответственно.<br />
Для метода <code>БлижайшиеРабочиеДаты</code> реализован параметр <code>УчитыватьНерабочиеПериоды</code>, позволяющий по-разному интерпретировать периоды нерабочих дней в календарях РФ в 2020 году.</li>
<li>Начиная с версии 3.1.2.378 для метода <code>БлижайшиеРабочиеДаты</code> реализован параметр <code>НерабочиеПериоды</code>, позволяющий уточнить, какие именно нерабочие периоды нужно учитывать.</li>
</ul>
<h4 id="контроль-ведения-учета-3">Контроль ведения учета</h4>
<ul>
<li>Для актуализации состава проверок при изменении значений функциональных опций, различных настроек и режимов работы информационной базы программный интерфейс общего модуля <code>КонтрольВеденияУчета</code> расширен процедурой <code>ОбновитьПараметрыПроверокУчета</code>. Подробнее см. в описании к ней.</li>
<li>Состав свойств проверок ведения учета расширен свойством <code>ПоддерживаетВыборочнуюПроверку</code>. Оно определяет, допускается ли выполнять проверку конкретных указанных объектов. Подробнее см. в комментарии к процедуре <code>ПриОпределенииПроверок</code> общего модуля <code>КонтрольВеденияУчетаПереопределяемый</code>.
<ul>
<li>В процедуре <code>ВыполнитьПроверку</code> общего модуля <code>КонтрольВеденияУчета</code> добавлен необязательный параметр <code>ПроверяемыеОбъекты</code> для вызова «точечной» проверки только определенных объектов.</li>
</ul></li>
<li>Для получения информации о наличии и количестве ошибок по всем проверкам в процедуре <code>СводнаяИнформацияПоВидамПроверок</code> общего модуля <code>КонтрольВеденияУчета</code> первый параметр <code>ВидПроверок</code> сделан необязательным.</li>
</ul>
<h4 id="настройка-порядка-элементов">Настройка порядка элементов</h4>
<ul>
<li>Для установки значения реквизита упорядочивания добавлена процедура <code>УстановитьЗначениеРеквизитаУпорядочивания</code> в общем модуле <code>НастройкаПорядкаЭлементов</code>. Вызов этой процедуры может понадобиться в сценариях, в которых объект с упорядочиванием записывается в режиме <code>ОбменДанными.Загрузка = Истина</code> и штатная подписка на событие <code>ПередЗаписью</code> не срабатывает.</li>
</ul>
<h4 id="напоминания-пользователя-1">Напоминания пользователя</h4>
<ul>
<li><p>Для принудительного обновления времени напоминаний, привязанных ко времени в предметах предусмотрена процедура <code>ОбновитьНапоминанияПоПредметам</code> в общем модуле <code>НапоминанияПользователя</code>. Принудительное обновление может понадобиться в сценариях, в которых предметы записываются в режиме <code>ОбменДанными.Загрузка = Истина</code> и штатная подписка на событие <code>ПриЗаписи</code> не срабатывает. <!--Локализация--> #### Обмен данными</p></li>
<li><p>Начиная с версии 3.1.2.331, включена новая версия 1.8 формата <code>EnterpriseData</code>. В ней предусмотрены объекты для реализации обмена ЗУП 3.1 и БП 3.0, а также для обмена с сервисом <code>1С:Номенклатура</code>. <!--Конец локализация--></p></li>
</ul>
<h4 id="обновление-версии-иб-13">Обновление версии ИБ</h4>
<ul>
<li>Упрощена и унифицирована разработка начального заполнения данных при первом запуске информационной базы. Как правило, такая необходимость возникает для предопределенных элементов, формирования классификаторов, предварительного создания элементов различных справочников, содержащих типовые операции. Теперь для этого необходимо:
<ul>
<li><p>В процедуре <code>ПриОпределенииНастроек</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code> определить список объектов метаданных, для которых требуется начальным заполнением данных. Например:</p>
<pre class="1c"><code>Параметры.ОбъектыСНачальнымЗаполнением.Добавить(Метаданные.Справочники.РассылкиОтчетов);</code></pre></li>
<li><p>В модуле менеджере объекта добавить процедуры-обработчики <code>ПриНастройкеНачальногоЗаполненияЭлементов</code>, <code>ПриНачальномЗаполненииЭлементов</code>, <code>ПриНачальномЗаполненииЭлемента</code> и реализовать в них код заполнения. Например,</p>
<pre class="1c"><code>Процедура ПриНастройкеНачальногоЗаполненияЭлементов(Настройки) Экспорт

    Настройки.ПриНачальномЗаполненииЭлемента = Ложь;

КонецПроцедуры
Процедура ПриНачальномЗаполненииЭлементов(КодыЯзыков, Элементы, ТабличныеЧасти) Экспорт

    Элемент = Элементы.Добавить();
    Элемент.ИмяПредопределенныхДанных = &quot;ЛичныеРассылки&quot;;
    Элемент.Наименование              = НСтр(&quot;ru=&#39;Личные рассылки&#39;&quot;, ОбщегоНазначения.КодЯзыкаИнформационнойБазы());

КонецПроцедуры
Процедура ПриНачальномЗаполненииЭлемента(Объект, Данные, ДополнительныеПараметры) Экспорт

КонецПроцедуры</code></pre>
<blockquote>
<p>Пример реализации см. в справочнике <code>РолиИсполнителей</code> демонстрационной конфигурации.</p>
</blockquote></li>
<li><p>Для автоматической генерации кода заполнения данных предусмотрен инструмент <code>Начальное заполнение данных</code>, входящий в состав дистрибутива библиотеки в виде внешней обработки.</p></li>
</ul></li>
<li>Программный интерфейс общего модуля <code>ОбновлениеИнформационнойБазы</code> расширен процедурами и функциями:
<ul>
<li><code>КоличествоПотоковОбновления</code>;</li>
<li><code>ОтложенноеОбновлениеЗавершено</code>;</li>
<li><code>ПриоритетОтложеннойОбработки</code>;</li>
<li><code>РазрешеноМногопоточноеОбновление</code>;</li>
<li><code>УстановитьКоличествоПотоковОбновления</code>;</li>
<li><code>УстановитьПриоритетОтложеннойОбработки</code>.</li>
</ul></li>
</ul>
<blockquote>
<p>Подробности см. в описании к ним.</p>
</blockquote>
<h4 id="обновление-конфигурации-1">Обновление конфигурации</h4>
<ul>
<li>Для проверки возможности установки обновлений добавлена функция <code>ПоддерживаетсяУстановкаОбновлений</code> в общий модуль <code>ОбновлениеКонфигурацииКлиент</code>.</li>
<li>Для проверки наличия устаревших исправлений без их удаления в процедуре <code>ИсправленияИзменены</code> общего модуля <code>ОбновлениеКонфигурации</code> добавлен необязательный параметр <code>ТолькоПроверка</code>.</li>
</ul>
<h4 id="печать-8">Печать</h4>
<ul>
<li>Для переопределения заголовка формы <code>ПечатьДокументов</code> расширен программный интерфейс:
<ul>
<li>процедуры <code>ПриПечати</code> общего модуля <code>УправлениеПечатьюПереопределяемый</code> и процедуры <code>Печать</code> модуля менеджера объектов;</li>
<li>процедуры <code>ПечатьДокументов</code> общего модуля <code>УправлениеПечатьюКлиент</code>.</li>
</ul></li>
<li>Для использования в процедуре <code>ПечатьДокументов</code> предусмотрен конструктор параметра <code>ДополнительныеПараметры</code> в виде функции <code>ПараметрыПечати</code> в модуле <code>УправлениеПечатьюКлиент</code>.</li>
</ul>
<blockquote>
<p>Подробности см. в описании этих процедур. - Для пакетного формирования нескольких печатных форм объекта расширен программный интерфейс функции <code>НапечатальВФайл</code> общего модуля <code>УправлениеПечатью</code> – добавлена возможность указания сразу нескольких команд печати. - Для переопределения режима работы механизма размещения подписей и печатей в печатных формах расширен программный интерфейс модуля <code>УправлениеПечатьюПереопределяемый</code> процедурой <code>ПриОпределенииНастроекПечати</code>. Новые возможности: - отключать автоматическую вставку печатей и подписей в печатных формах, - при отключении флажка <code>Подпись и печать</code> на форме <code>Печать</code> <code>документов</code> удалять картинки подписей и печатей для того, чтобы эти картинки не мешали редактировать печатную форму. - Для расширения возможностей формы <code>ПечатьДокументов</code> обработчик события <code>ОбработкаОповещения</code> вынесен в переопределяемый модуль <code>УправлениеПечатьюКлиентПереопределяемый</code>.</p>
</blockquote>
<h4 id="подключаемые-команды-2">Подключаемые команды</h4>
<ul>
<li>Для выполнения подключаемой команды для указанных ссылок на объекты расширен программный интерфейс процедуры <code>ВыполнитьКоманду</code> общего модуля <code>ПодключаемыеКомандыКлиент</code>.</li>
<li>Список видов поставляемых команд расширен командами создания на основании. Инструкцию по подключению см. в документации. В дополнение к имеющимся возможностям стандартных команд ввода на основании подключаемые команды предоставляют следующие возможности:
<ul>
<li>подменю <code>Создать на основании</code> отображается в виде картинки, занимает меньше места, оставляя его для других важных команд;</li>
<li>в конфигураторе не требуется настройка флажков видимости и настройка порядка команд в форме;</li>
<li>есть возможность управления составом, порядком и представлением команд со стороны объекта-основания;</li>
<li>есть возможность динамического изменения состава команд в подменю в зависимости от выделенных элементов в списке и в зависимости от значений реквизитов объекта;</li>
<li>есть возможность группировки команд внутри подменю;</li>
<li>есть возможность использовать горячие клавиши и устанавливать картинки команд ввода на основании.</li>
</ul></li>
</ul>
<blockquote>
<p>Подробнее см. в документации к библиотеке и в описании программного интерфейса модулей <code>СозданиеНаОсновании</code> и <code>СозданиеНаОснованииПереопределяемый</code>. - Для расстановки фрагментов кода команд ввода на основании можно воспользоваться обработкой <code>ПереходНаВерсию312</code>, входящей в состав дистрибутива. - В состав подсистемы перенесены объекты подсистемы <code>Заполнение объектов</code>. - Редко используемые команды в формах, такие как просмотр отчета <code>Движения документа</code>, можно скрыть из командной панели, отображать только в меню <code>Еще</code>. Для управления этой возможностью добавлено свойство команды <code>ТолькоВоВсехДействиях</code>. См. <code>ПодключаемыеКомандыПереопределяемый.ПриОпределенииКомандПодключенныхКОбъекту</code>.</p>
</blockquote>
<h4 id="поиск-и-удаление-дублей-2">Поиск и удаление дублей</h4>
<ul>
<li>Для программного определения прикладных правил поиска дублей для произвольных объектов конфигурации в переопределяемом модуле <code>ПоискИУдалениеДублейПереопределяемый</code> предусмотрены процедуры, которые полностью соответствуют аналогичным обработчикам модуля менеджера объекта <code>ВозможностьЗаменыЭлементов</code>, <code>ПараметрыПоискаДублей</code>, <code>ПриПоискеДублей</code>:
<ul>
<li><code>ПриОпределенииВозможностиЗаменыЭлементов</code>,</li>
<li><code>ПриОпределенииПараметровПоискаДублей</code>,</li>
<li><code>ПриПоискеДублей</code>.</li>
</ul></li>
</ul>
<blockquote>
<p>Подробнее см. в комментариях к ним. - Состав параметра <code>ПараметрыПоиска</code> процедуры-обработчика <code>ПараметрыПоискаДублей</code> модуля менеджера расширен новым свойством <code>СравнениеСтрокНаПодобие</code> для управления нечетким поиском строк при поиске подобных строк. Для разных объектов конфигурации возможно задавать разные значения параметров <code>ПроцентСовпаденияСтрок</code>, <code>ПроцентСовпаденияНебольшихСтрок</code>, <code>ДлинаНебольшихСтрок</code>, а также <code>СловаИсключения</code>. В последнем параметре указывается список слов, которые следует пропускать при сравнении на подобие. Например, для организаций и контрагентов это могут быть: ИП, ГУП, ООО, ОАО и т.д. В таком случае, наименования “Ромашка” и “ООО Ромашка” будут считаться дублями.</p>
</blockquote>
<h4 id="пользователи-9">Пользователи</h4>
<ul>
<li>Для программной регистрации пользователей в общий модуль <code>Пользователи</code> добавлена функция <code>СоздатьПароль</code>, которая позволяет автоматически сгенерировать пароль с учетом действующих требований к сложности пароля.</li>
</ul>
<h4 id="работа-с-почтовыми-сообщениями-5">Работа с почтовыми сообщениями</h4>
<ul>
<li>Для оптимизации пакетной отправки нескольких писем добавлена функция <code>ОтправитьПисьма</code> в модуле <code>РаботаСПочтовымиСообщениями</code>.</li>
<li>Для упрощения программного интерфейса на замену функции <code>ОтправитьПочтовоеСообщение</code> предусмотрена функция <code>ОтправитьПисьмо</code>.</li>
<li>Новая роль <code>ЧтениеУчетныхЗаписейЭлектроннойПочты</code> может использоваться вместо имеющейся роли <code>ДобавлениеИзменениеУчетныхЗаписейЭлектроннойПочты</code> в случае, когда требуется ограничить пользователям добавление персональных учетных записей электронной почты.</li>
</ul>
<h4 id="работа-с-файлами-8">Работа с файлами</h4>
<ul>
<li>В процедуре <code>СохранитьФайлКак</code> общего модуля <code>РаботаСФайламиКлиент</code> предусмотрен необязательный параметр <code>ОбработчикЗавершения</code>, с помощью которого можно получить имя файла после сохранения его на диск.</li>
<li>Для программного копирования присоединенных файлов между однотипными владельцами в общем модуле <code>РаботаСФайлами</code> размещена процедура <code>СкопироватьПрисоединенныеФайлы</code>.</li>
</ul>
<h4 id="управление-доступом-10">Управление доступом</h4>
<ul>
<li>Функции <code>ЧтениеРазрешено</code> и <code>ИзменениеРазрешено</code> общего модуля <code>УправлениеДоступом</code> теперь поддерживают проверку объекта и набора записей до записи в базу данных.</li>
</ul>
<h4 id="центр-мониторинга-3">Центр мониторинга</h4>
<ul>
<li>Для программной проверки состояния отправки статистики реализована функция <code>ЦентрМониторингаВключен</code> общего модуля <code>ЦентрМониторинга</code>.</li>
</ul>
<h4 id="электронная-подпись-17">Электронная подпись</h4>
<ul>
<li>Для упрощения разработки прикладных форм (рабочих мест), предоставляющих возможность интерактивного добавления сертификатов электронной подписи в программу, в общий модуль <code>ЭлектроннаяПодписьКлиент</code> добавлена процедура <code>ДобавитьСертификат</code>. Для инициализации параметра <code>ПараметрыДобавления</code> этой процедуры предусмотрена функция <code>ПараметрыДобавленияСертификата</code>, расположенная в этом же модуле.</li>
<li>Для программного добавления сертификата электронной подписи в справочник <code>СертификатыКлючейЭлектроннойПодписиИШифрования</code> в общий модуль <code>ЭлектроннаяПодписьКлиент</code> добавлена процедура <code>ЗаписатьСертификатВСправочник</code>. Для инициализации параметра <code>ДополнительныеПараметры</code> этой процедуры предусмотрена функция <code>ПараметрыЗаписиСертификата</code>, расположенная в этом же общем модуле.</li>
<li>Для программной обработки и диагностики ошибок, возникающих в процессе работы с электронной подписью, расширен программный интерфейс общего модуля <code>ЭлектроннаяПодписьКлиент</code>:
<ul>
<li>в параметр <code>ДополнительныеПараметры</code> (тип <code>Структура</code>) процедуры <code>ПроверитьСертификатСправочника</code> включены новые свойства <code>КонтекстОперации</code> и <code>НеПоказыватьРезультаты</code>. Подробнее см. комментарий к процедуре;</li>
<li>возвращаемое значение <code>Результат</code> (тип <code>Структура</code>) процедуры <code>ПроверитьСертификатСправочника</code> расширено свойствами, содержащими сообщения об ошибках для каждой выполненной проверки. Подробнее см. комментарий к процедуре;</li>
<li>в процедуру <code>ПроверитьПодпись</code> добавлен необязательный параметр <code>ПоказатьОшибку</code>;</li>
<li>состав свойств параметра <code>ОписаниеДанных</code> (тип <code>Структура</code>) процедур <code>Подписать</code>, <code>Зашифровать</code> и <code>Расшифровать</code> расширен новым свойством <code>ПрекратитьВыполнение</code>. Подробнее см. комментарий к процедурам;</li>
<li>в возвращаемое значение (тип <code>Структура</code>) процедур <code>Подписать</code>, <code>Зашифровать</code> и <code>Расшифровать</code> добавлено новое свойство <code>Отказ</code>. Подробнее см. комментарий к процедурам.</li>
</ul></li>
<li>При вызове процедуры <code>Подписать</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> с параметром <code>Данные</code>, принимающим значение <code>Структура</code> со свойством <code>ПараметрыCMS</code>, теперь по умолчанию возвращаются данные подписи, содержащие полную цепочку сертификатов. Для других вариантов возвращаемое значение функций <code>ПараметрыCMS</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> расширено новым свойством <code>ВключениеСертификатовВПодпись</code>. Подробнее см. комментарий к функциям.</li>
<li>В процедуру <code>ОткрытьИнструкциюПоТипичнымПроблемамПриРаботеСПрограммами</code> общего модуля <code>ЭлектроннаяПодписьКлиент</code> добавлен необязательный параметр <code>ИмяОшибки</code> для перехода непосредственно к нужной проблеме в инструкции.</li>
</ul>
<h3 id="переход-на-версию-3.1.2-с-версии-3.1.1">Переход на версию 3.1.2 с версии 3.1.1</h3>
<h4 id="обязательные-действия-по-переходу-5">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области <code>ПрограммныйИнтерфейс</code>;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки.</p>
<p>По каждой подсистеме приведены дополнительные инструкции, когда такая совместимость в силу исключительных причин не поддерживается, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <code>Проверка внедрения БСП</code>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>. В этой версии состав проверок был дополнительно расширен, чтобы выявлять больше типовых проблем внедрения.</p>
<h5 id="базовая-функциональность-22">Базовая функциональность</h5>
<ul>
<li>Константы <code>ДополнительныйЯзык1</code>, <code>ДополнительныйЯзык2</code>, <code>ИспользоватьДополнительныйЯзык1</code>, <code>ИспользоватьДополнительныйЯзык2</code> и <code>ОсновнойЯзык</code> рекомендуется включать в планы обмена распределенной информационной базы (РИБ).</li>
</ul>
<h5 id="версионирование-объектов-1">Версионирование объектов</h5>
<ul>
<li>Изменено размещение и внешний вид общей команды <code>ИсторияИзменений</code>. Теперь команда по умолчанию размещается не в панели навигации, а в командной панели формы, в связи с чем, команда стала доступной не только в форме объекта, но и в форме списка. Для возможности скрытия этой команды из форм списков необходимо в процедуре <code>ПриСозданииНаСервере</code> модулей форм списков версионируемых объектов разместить следующий код:</li>
</ul>
<pre class="1c"><code>&amp;НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
    // СтандартныеПодсистемы.ВерсионированиеОбъектов
    ВерсионированиеОбъектов.ПриСозданииНаСервере(ЭтотОбъект);
    // Конец СтандартныеПодсистемы.ВерсионированиеОбъектов
КонецПроцедуры</code></pre>
<h5 id="графики-работы">Графики работы</h5>
<ul>
<li>Тип реквизита <code>ВладелецГрафика</code> в справочнике <code>Календари</code> был изменен на определяемый тип <code>ВладелецГрафикаРаботы</code>. Необходимо перечислить в определяемом типе <code>ВладелецГрафикаРаботы</code> типы тех справочников, которые раньше фактически использовались в качестве значений реквизита <code>ВладелецГрафика</code>.</li>
</ul>
<h5 id="календарные-графики-3">Календарные графики</h5>
<ul>
<li>В общем модуле <code>КалендарныеГрафикиПереопределяемый</code> добавлен метод <code>ПриЗаполненииИзменяемыхОбъектовЗависимыхОтПроизводственныхКалендарей</code>. В том случае, если в обработчике <code>ПриОбновленииДанныхЗависимыхОтПроизводственныхКалендарей</code> обрабатываются какие-то объекты, зависимые от производственных календарей, следует перечислить имена метаданных этих объектов.</li>
<li>Регистр сведений <code>ПериодыНерабочихДнейКалендаря</code> рекомендуется включать в состав планов обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
</ul>
<h5 id="контроль-ведения-учета-4">Контроль ведения учета</h5>
<ul>
<li>Регистр сведений <code>СостоянияПроверокВеденияУчета</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ), т.к. в проверка ведения учета выполняется в каждом узле независимо.</li>
</ul>
<h5 id="работа-с-файлами-9">Работа с файлами</h5>
<ul>
<li>Константы <code>ПараметрыХраненияФайловВИБ</code>, <code>СоздаватьПодкаталогиСИменамиВладельцев</code> и <code>СпособХраненияФайлов</code> не следует включать в состав планов обмена РИБ и автономного рабочего места (АРМ), т.к. настройки хранения файлов индивидуальны для каждого узла информационной базы, в частности, тома хранения файлов располагаются на разных сетевых ресурсах.</li>
</ul>
<h5 id="управление-доступом-11">Управление доступом</h5>
<ul>
<li>Обновить стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code>. Требуется взять их из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Инструкцию см. в документации к подсистеме <code>Управление доступом</code> в подразделе <code>Обновление шаблонов ограничения доступа в ролях</code>.</li>
</ul>
<h5 id="электронная-подпись-18">Электронная подпись</h5>
<ul>
<li>Константы <code>ДатаПоследнегоОбновленияКлассификатораОшибок</code> и <code>КлассификаторОшибокКриптографии</code> рекомендуется исключить из планов обмена РИБ.</li>
</ul>
<h4 id="необязательные-действия-по-переходу-5">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="базовая-функциональность-23">Базовая функциональность</h5>
<ul>
<li>Процедура <code>УстановитьОтображениеЗаголовковГрупп</code> общего модуля <code>СтандартныеПодсистемыСервер</code> отмечена как устаревшая и оставлена для обратной совместимости. Рекомендуется удалить ее вызовы.</li>
<li>Для повышения надежности клиентского и серверного кода:
<ul>
<li>вместо функции <code>СтрокаЛатиницей</code> общего модуля <code>СтроковыеФункцииКлиентСервер</code> следует использовать одноименные функции модулей <code>СтроковыеФункции</code> или <code>СтроковыеФункцииКлиент</code>;</li>
<li>вместо функции <code>ФорматированнаяСтрока</code> общего модуля <code>СтроковыеФункцииКлиентСервер</code> следует использовать одноименные функции модулей <code>СтроковыеФункции</code> или <code>СтроковыеФункцииКлиент</code>;</li>
<li>Рекомендуется произвести соответствующие замены в местах использования.</li>
</ul></li>
<li>Для упрощения вызова функции <code>ЗаменитьСсылки</code> общего модуля <code>ОбщегоНазначения</code> для параметра <code>ПараметрыЗамены</code> (тип <code>Структура</code>) предусмотрена функция-конструктор <code>ПараметрыЗаменыСсылок</code> в этом же модуле. Для усиления контроля типизации, в частности, при появлении новых обязательных свойств данной структуры, рекомендуется провести замену всех мест «ручной» инициализации структуры на вызов функции-конструктора.</li>
<li>Для упрощения разработки прикладных решений с несколькими языками интерфейса изменено поведение функции <code>КодОсновногоЯзыка</code> общего модуля <code>ОбщегоНазначения</code>. Теперь функция возвращает код основного языка конфигурации или языка, явно заданного администратором при первом запуске программы.</li>
</ul>
<h5 id="бизнес-процессы-и-задачи-1">Бизнес-процессы и задачи</h5>
<ul>
<li>В целях унификации начального заполнения ролей исполнителей и объектов адресации задач программный интерфейс общего модуля <code>БизнесПроцессыИЗадачиПереопределяемый</code> расширен процедурами: <code>ПриНачальномЗаполненииРолейИсполнителей</code>, <code>ПриНачальномЗаполненииРолиИсполнителя</code> для заполнения ролей исполнителей, <code>ПриНачальномЗаполненииОбъектовАдресацииЗадач</code>, <code>ПриНачальномЗаполненииЭлементаОбъектаАдресацииЗадачи</code> для заполнения объектов адресации задач, следует перенести код заполнения элементов из обработчиков начального заполнения в эти процедуры.</li>
</ul>
<h5 id="версионирование-объектов-2">Версионирование объектов</h5>
<ul>
<li>Процедура <code>ОбновитьНастройкиВерсионированияОбъектов</code> общего модуля <code>ВерсионированиеОбъектов</code> удалена как невостребованная.</li>
</ul>
<h5 id="контактная-информация-6">Контактная информация</h5>
<ul>
<li>Для исключения избыточных серверных экспортных процедур в модулях форм изменен порядок встраивания подсистемы (подробнее см. документацию). Его следует применять для новых форм, а перевстраивание в существующие формы не обязательно. Новые вставки кода задействуют процедуры <code>НачатьИзменение</code>, <code>НачатьВыбор</code>, <code>НачатьОчистку</code>, <code>НачатьОбработкуНавигационнойСсылки</code> и <code>НачатьВыполнениеКоманды</code> общего модуля <code>ПодключаемыеКомандыКлиент</code> вместо аналогичных <code>ПриИзменении</code>, <code>НачалоВыбора</code>, <code>Очистка</code>, <code>ОбработкаНавигационнойСсылки</code>, <code>ВыполнитьКоманду</code> и выглядят следующим образом:
<ul>
<li><p>Было:</p>
<pre class="1c"><code>&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриИзменении(Элемент)
    УправлениеКонтактнойИнформациейКлиент.ПриИзменении(ЭтотОбъект, Элемент);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачалоВыбора(ЭтотОбъект, Элемент, , СтандартнаяОбработка);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриНажатии(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачалоВыбора(ЭтотОбъект, Элемент, , СтандартнаяОбработка);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОчистка(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.Очистка(ЭтотОбъект, Элемент.Имя);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияВыполнитьКоманду(Команда)
    УправлениеКонтактнойИнформациейКлиент.ВыполнитьКоманду(ЭтотОбъект, Команда.Имя);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияАвтоПодбор(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка)

    УправлениеКонтактнойИнформациейКлиент.АвтоПодборАдреса(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка);

КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)

    УправлениеКонтактнойИнформациейКлиент.ОбработкаВыбора(ЭтотОбъект, ВыбранноеЗначение, Элемент.Имя, СтандартнаяОбработка);

КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОбработкаНавигационнойСсылки(Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.ОбработкаНавигационнойСсылки(ЭтотОбъект, Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка);
КонецПроцедуры
&amp;НаСервере
Процедура Подключаемый_ОбновитьКонтактнуюИнформацию(Результат) Экспорт
    УправлениеКонтактнойИнформацией.ОбновитьКонтактнуюИнформацию(ЭтотОбъект, Объект, Результат);
КонецПроцедуры</code></pre></li>
<li><p>Стало:</p>
<pre class="1c"><code>&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриИзменении(Элемент)
    УправлениеКонтактнойИнформациейКлиент.НачатьИзменение(ЭтотОбъект, Элемент);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачатьВыбор(ЭтотОбъект, Элемент, , СтандартнаяОбработка);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияПриНажатии(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачатьВыбор(ЭтотОбъект, Элемент, , СтандартнаяОбработка);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОчистка(Элемент, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачатьОчистку(ЭтотОбъект, Элемент.Имя);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияВыполнитьКоманду(Команда)
    УправлениеКонтактнойИнформациейКлиент.НачатьВыполнениеКоманды(ЭтотОбъект, Команда.Имя);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияАвтоПодбор(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка)

    УправлениеКонтактнойИнформациейКлиент.АвтоПодборАдреса(Элемент, Текст, ДанныеВыбора, ПараметрыПолученияДанных, Ожидание, СтандартнаяОбработка);

КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)

    УправлениеКонтактнойИнформациейКлиент.ОбработкаВыбора(ЭтотОбъект, ВыбранноеЗначение, Элемент.Имя, СтандартнаяОбработка);

КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_КонтактнаяИнформацияОбработкаНавигационнойСсылки(Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка)
    УправлениеКонтактнойИнформациейКлиент.НачатьОбработкуНавигационнойСсылки(ЭтотОбъект, Элемент, НавигационнаяСсылкаФорматированнойСтроки, СтандартнаяОбработка);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_ПродолжитьОбновлениеКонтактнойИнформации(Результат, ДополнительныеПараметры) Экспорт
    ОбновитьКонтактнуюИнформацию(Результат);
КонецПроцедуры
&amp;НаСервере
Процедура ОбновитьКонтактнуюИнформацию(Результат)
    УправлениеКонтактнойИнформацией.ОбновитьКонтактнуюИнформацию(ЭтотОбъект, Объект, Результат);
КонецПроцедуры</code></pre></li>
</ul></li>
<li>В справочнике <code>ВидыКонтактнойИнформации</code> реквизит <code>РедактированиеТолькоВДиалоге</code> (Булево) отмечен как устаревший, вместо него используется реквизит <code>ВидРедактирования</code> (Строка). Поэтому для планов обмена по правилам конвертации с версиями БСП 3.1.1 и ниже следует предусмотреть преобразование значений из одного реквизита в другой. Пример см. в демонстрационной конфигурации в макетах плана обмена <code>_ДемоОбменСБиблиотекойСтандартныхПодсистем225</code>.</li>
</ul>
<h5 id="контроль-ведения-учета-5">Контроль ведения учета</h5>
<ul>
<li>Во всех модулях форм объектов, к которым подключена подсистема, рекомендуется реализовать обработчик события <code>ПослеЗаписиОбъекта</code> для оперативной перепроверки объекта после записи формы. Для этого в обработчике события <code>ПослеЗаписиНаСервере</code> вставить вызов процедуры:</li>
</ul>
<pre class="1c"><code>КонтрольВеденияУчета.ПослеЗаписиНаСервере(ТекущийОбъект);</code></pre>
<h5 id="настройка-порядка-элементов-1">Настройка порядка элементов</h5>
<ul>
<li>Процедура <code>ЗаполнитьЗначениеРеквизитаУпорядочивания</code> общего модуля <code>НастройкаПорядкаЭлементов</code> исключена из программного интерфейса, вместо нее следует использовать процедуру <code>УстановитьЗначениеРеквизитаУпорядочивания</code> в этом же модуле. Рекомендуется произвести соответствующие замены в местах использования.</li>
</ul>
<h5 id="настройки-программы">Настройки программы</h5>
<ul>
<li>В панелях администрирования (см. формы обработки <code>ПанельАдминистрированияБСП</code>) внесен ряд изменений, которые необходимости перенести в конфигурацию. Если в эти формы также вносились изменения в конфигурации, то потребуется их объединить с изменениями в библиотеке.</li>
</ul>
<h5 id="печать-9">Печать</h5>
<ul>
<li>Новый регистр сведений <code>ОбщиеПоставляемыеМакетыПечати</code> не требуется включать в планы обменов.</li>
</ul>
<h5 id="подключаемые-команды-3">Подключаемые команды</h5>
<ul>
<li>Для исключения избыточных серверных экспортных процедур в модулях форм изменен порядок встраивания подсистемы (подробнее см. документацию). Его следует применять для новых форм, а перевстраивание в существующие формы не обязательно. Новые вставки кода задействуют процедуру <code>НачатьВыполнениеКоманды</code> вместо <code>ВыполнитьКоманду</code> общего модуля <code>ПодключаемыеКомандыКлиент</code> и выглядят следующим образом:
<ul>
<li><p>Было:</p>
<pre class="1c"><code>&amp;НаКлиенте
Процедура Подключаемый_ВыполнитьКоманду(Команда)
    ПодключаемыеКомандыКлиент.ВыполнитьКоманду(ЭтотОбъект, Команда, Объект);
КонецПроцедуры
&amp;НаСервере
Процедура Подключаемый_ВыполнитьКомандуНаСервере(Контекст, Результат) Экспорт
    ПодключаемыеКоманды.ВыполнитьКоманду(ЭтотОбъект, Контекст, Объект, Результат);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_ОбновитьКоманды()
    ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды(ЭтотОбъект, Объект);
КонецПроцедуры</code></pre></li>
<li><p>Стало:</p>
<pre class="1c"><code>&amp;НаКлиенте
Процедура Подключаемый_ВыполнитьКоманду(Команда)
    ПодключаемыеКомандыКлиент.НачатьВыполнениеКоманды(ЭтотОбъект, Команда, Объект);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_ПродолжитьВыполнениеКомандыНаСервере(ПараметрыВыполнения, ДополнительныеПараметры) Экспорт
    ВыполнитьКомандуНаСервере(ПараметрыВыполнения);
КонецПроцедуры
&amp;НаСервере
Процедура ВыполнитьКомандуНаСервере(ПараметрыВыполнения)
    ПодключаемыеКоманды.ВыполнитьКоманду(ЭтотОбъект, ПараметрыВыполнения, Объект);
КонецПроцедуры
&amp;НаКлиенте
Процедура Подключаемый_ОбновитьКоманды()
    ПодключаемыеКомандыКлиентСервер.ОбновитьКоманды(ЭтотОбъект, Объект);
КонецПроцедуры</code></pre></li>
</ul></li>
</ul>
<h5 id="работа-с-почтовыми-сообщениями-6">Работа с почтовыми сообщениями</h5>
<ul>
<li>Функция <code>ОтправитьПочтовоеСообщение</code> отмечена как устаревшая, вместо нее следует использовать функции <code>ОтправитьПисьмо</code>, если выполняется отправка одного письма, и <code>ОтправитьПисьма</code>, если функция <code>ОтправитьПочтовоеСообщение</code> вызывалась в цикле. Для упрощения перехода на новые функции предусмотрена вспомогательная функция <code>ПодготовитьПисьмо</code>, параметры которой повторяют параметры функции <code>ОтправитьПочтовоеСообщение</code> в части подготовки письма. Рекомендуется произвести соответствующие замены.</li>
</ul>
<h5 id="работа-с-файлами-10">Работа с файлами</h5>
<ul>
<li>Для поддержки работы толстого клиента управляемого приложения в режиме клиент-сервер процедура <code>ОпределитьФормуПрисоединенногоФайла</code> общего модуля <code>РаботаСФайлами</code> отмечена как устаревшая, вместо нее рекомендуется использовать одноименную процедуру общего модуля <code>РаботаСФайламиКлиентСервер</code>. Рекомендуется пересмотреть места использования этой процедуры.</li>
<li>Для упрощения вызова функции <code>ДобавитьФайл</code> общего модуля <code>РаботаСФайлами</code> для параметра <code>ПараметрыФайла</code> (тип <code>Структура</code>) предусмотрена функция-конструктор <code>ПараметрыДобавленияФайла</code> в этом же модуле. Для усиления контроля типизации, в частности, при появлении новых обязательных свойств данной структуры, рекомендуется провести замену всех мест «ручной» инициализации структуры на вызов функции-конструктора.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.2">Переход на исправительные релизы 3.1.2</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.2.<code>1</code>, 3.1.2.<code>20</code>, 3.1.2.<code>300</code> и т.п. Для обновления на исправительные релизы предназначена внешняя обработка <code>ОбновлениеНаИсправительнуюВерсиюБСП.epf</code> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <code>Обновить на исправительную версию</code>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <code>Сформировать файл настроек</code> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <code>Проверка внедрения БСП</code>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h4 id="с-версии-3.1.2.430-и-меньше">С версии 3.1.2.430 и меньше</h4>
<h5 id="базовая-функциональность-24">Базовая функциональность</h5>
<ul>
<li>В инструменте <code>Проверка внедрения БСП</code>, входящем в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>, обновлен макет с эталонным значением прав для роли <code>ПолныеПрава</code> для справочника <code>ПоставляемыеДополнительныеОтчетыИОбработки</code>. Для корректного выявления и исправления проблем рекомендуется использовать актуальную версию отчета.</li>
</ul>
<h4 id="с-версии-3.1.2.352-и-меньше">С версии 3.1.2.352 и меньше</h4>
<h5 id="календарные-графики-4">Календарные графики</h5>
<ul>
<li>Регистр сведений <code>ПериодыНерабочихДнейКалендаря</code> рекомендуется включать в состав планов обмена распределенной информационной базы (РИБ) и автономного рабочего места (АРМ).</li>
</ul>
<h4 id="с-версии-3.1.2.306-и-меньше">С версии 3.1.2.306 и меньше</h4>
<h5 id="управление-доступом-12">Управление доступом</h5>
<ul>
<li>Обновить стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code>. Требуется взять их из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Инструкцию см. в документации к подсистеме <code>Управление доступом</code> в подразделе <code>Обновление шаблонов ограничения доступа в ролях</code>.</li>
</ul>
<h4 id="с-версии-3.1.2.166-и-меньше">С версии 3.1.2.166 и меньше</h4>
<h5 id="контактная-информация-7">Контактная информация</h5>
<ul>
<li>Для выявления случаев ошибочного включения служебных реквизитов табличной части <code>КонтактнаяИнформация</code> в полнотекстовый поиск был улучшен инструмент <code>Проверка внедрения БСП</code>, входящий в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>. Выявленные ошибки рекомендуется исправлять в плановом порядке.</li>
</ul>
<h4 id="с-версии-3.1.2.196-и-меньше">С версии 3.1.2.196 и меньше</h4>
<h5 id="обновление-версии-иб-14">Обновление версии ИБ</h5>
<ul>
<li>У процедур-обработчиков начального заполнения данных <code>ПриНастройкеНачальногоЗаполненияЭлементов</code>, находящихся в модулях менеджеров объектов, добавлен третий обязательный параметр <code>ТабличныеЧасти</code> с типом <code>Структура</code>, необходимый для заполнения табличных частей объекта. Следует добавить параметр у всех ранее размещенных одноименных процедур-обработчиков начального заполнения.</li>
</ul>
<h4 id="с-версии-3.1.2.202-и-меньше">С версии 3.1.2.202 и меньше</h4>
<h5 id="печать-10">Печать</h5>
<ul>
<li>Новый регистр сведений <code>ОбщиеПоставляемыеМакетыПечати</code> не требуется включать в планы обменов.</li>
</ul>
<h4 id="с-версии-3.1.2.229-и-меньше">С версии 3.1.2.229 и меньше</h4>
<h5 id="базовая-функциональность-25">Базовая функциональность</h5>
<ul>
<li>Для выявления ошибочных различий прав в ролях <code>ПолныеПрава</code> и <code>АдминистраторСистемы</code> на объекты библиотеки улучшен инструмент <code>Проверка внедрения БСП</code>, входящий в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>. Выявленные ошибки рекомендуется исправлять в ускоренном порядке, т.к. связаны с правами доступа.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.2">Особенности обновления с ранних версий на версию 3.1.2</h3>
<p>При обновлении с ранних версий библиотеки (до 3.1.1) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <code>Переход с предыдущих версий</code> для каждой пропущенной версии.</li>
</ul>
<h2 id="версия-3.1.1">Версия 3.1.1</h2>
<p>Версия 3.1.1 является новой редакцией продукта <strong>1С:Библиотека стандартных подсистем</strong>. Версия 3.1.1 предназначена для разработки на платформе <strong>1С:Предприятие</strong> версии 8.3.14 и выше с отключенным режимом совместимости с версией 8.3.14. Полный перечень нововведений см. ниже в разделе <strong>Новые возможности и изменения в версии 3.1.1</strong>.</p>
<h3 id="новые-возможности-и-изменения-в-версии-3.1.1">Новые возможности и изменения в версии 3.1.1</h3>
<p>В состав библиотеки включена новая подсистема <strong>Интерфейс OData</strong>. Она позволяет настроить автоматический REST-сервис, с помощью которого сторонние приложения могут читать и изменять данные в информационной базе. Подробнее см. документацию. Для настройки сервиса можно воспользоваться командой в разделе <strong>Администрирование – Настройка синхронизации – Настройки стандартного интерфейса OData</strong>. <!--Локализация--> #### Банки</p>
<ul>
<li>Загрузка классификатора банков выполняется через единый механизм загрузки классификаторов – через Интернет-поддержку (раздел <strong>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</strong>).</li>
<li>Предоставляется возможность скачивания файла обновления классификаторов с портала <strong>1C:Обновление программ</strong> (<a href="https://releases.1c.ru/">https://releases.1c.ru/</a>) и загрузки на другом компьютере, не имеющего доступа в Интернет.</li>
<li>Для администраторов:
<ul>
<li>вместо регламентного задания <strong>Загрузка классификатора банков</strong> предусмотрено регламентное задание <strong>Обновление классификаторов</strong>;</li>
<li>для загрузки классификатора вручную предусмотрена отдельная роль – <strong>Получение обновлений классификаторов</strong>.</li>
</ul></li>
</ul>
<h4 id="валюты-2">Валюты</h4>
<ul>
<li>Предусмотрено оперативное обновление классификатора валют через Интернет. Возможность предоставляется при наличии подключения к Интернет-поддержке (раздел <strong>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</strong>).</li>
<li>Предоставляется возможность скачивания файла обновления классификаторов с портала <strong>1C:Обновление программ</strong> (<a href="https://releases.1c.ru/">https://releases.1c.ru/</a>) и загрузки на другом компьютере, не имеющего доступа в Интернет. <!--Конец локализация--></li>
</ul>
<h4 id="контактная-информация-8">Контактная информация</h4>
<!--Локализация-->
<ul>
<li>Предусмотрено оперативное обновление классификатора стран мира через Интернет. Возможность предоставляется при наличии подключения к Интернет-поддержке (раздел <strong>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</strong>).</li>
<li>Предоставляется возможность скачивания файла обновления классификаторов с портала <strong>1C:Обновление программ</strong> (<a href="https://releases.1c.ru/">https://releases.1c.ru/</a>) и загрузки на другом компьютере, не имеющего доступа в Интернет.<!--Конец локализация--></li>
<li>Если у международного адреса включен флажок <strong>Включать страну в представление</strong> (раздел <strong>Администрирование – Общие настройки – Виды контактной информации</strong>), то в международный адрес автоматически включается наименование страны на английском языке. Для этого в карточке страны (раздел <strong>Справочники – Страны мира</strong>) предусмотрено поле для ввода международного наименования. Например, для России следует ввести Russia.</li>
</ul>
<h3 id="новые-возможности-для-разработчиков-в-версии-3.1.1">Новые возможности для разработчиков в версии 3.1.1</h3>
<h4 id="базовая-функциональность-26">Базовая функциональность</h4>
<ul>
<li>В платформе <code>1С:Предприятие</code> версии 8.3.13 появилась возможность проверять на клиенте некоторые свойства загружаемых файлов до их помещения на сервер. С целью поддержки новых возможностей для процедур <code>ЗагрузитьФайл</code> и <code>ЗагрузитьФайлы</code> общего модуля <code>ФайловаяСистемаКлиент</code> в состав свойств параметра <code>ПараметрыЗагрузки</code> добавлено свойство <code>ДействиеПередНачаломПомещенияФайлов</code>.</li>
<li>В связи с появлением объекта <code>ОписаниеПереданногоФайла</code> в платформе <code>1С:Предприятие</code> версии 8.3.13 в состав значения, возвращаемого асинхронной процедурой <code>ФайловаяСистемаКлиент.ЗагрузитьФайлы</code>, добавлены свойства <code>ПолноеИмя</code> и <code>ИмяФайла</code>.</li>
<li>Для упрощения обработки ошибок при получении идентификаторов объектов метаданных по полному имени (когда полное имя может быть некорректным, например, получено из внешних источников), в функции <code>ИдентификаторОбъектаМетаданных</code> и <code>ИдентификаторыОбъектовМетаданных</code> общего модуля <code>ОбщегоНазначения</code> добавлен необязательный параметр <code>ВызыватьИсключение</code> (значение по умолчанию <code>Истина</code>).</li>
<li>Функция <code>СтрокаВДату</code> программного интерфейса общего модуля <code>СтроковыеФункцииКлиентСервер</code> для преобразования дат со временем теперь поддерживает распознавание времени. Для этого добавлен второй необязательный параметр <code>ЧастьДаты</code>, который определяет возвращаемый вариант даты: дата, время, дата и время. По умолчанию, если этот параметр не задан, будет возвращена только дата.</li>
<li>Для упрощения локализации и наглядного создания форматированных строк в программный интерфейс общих модулей <code>СтроковыеФункции</code> и <code>СтроковыеФункцииКлиент</code> добавлена функция <code>ФорматированнаяСтрока</code>. Оформление текста выполняется HTML подобным языком разметки и позволяет менять цвет, шрифт, выводить картинки и создавать гиперссылки. Например, “Цена &lt;span style=‘color: ПоясняющийТекст’&gt;некорректная&lt;/span&gt;”. Подробнее см. комментарий к функции.</li>
</ul>
<h4 id="взаимодействия-4">Взаимодействия</h4>
<ul>
<li>Для передачи параметров в процедуру <code>ОткрытьФормуОтправкиSMS</code> общего модуля <code>ВзаимодействияКлиент</code> предусмотрена функция-конструктор <code>ПараметрыФормыОтправкиSMS</code> в этом же модуле.</li>
</ul>
<h4 id="работа-с-почтовыми-сообщениями-7">Работа с почтовыми сообщениями</h4>
<ul>
<li>Для фильтрации небезопасного содержимого письма, в частности, скриптов и картинок, загружаемых из Интернета, предусмотрена процедура <code>ОтключитьНебезопасноеСодержимое</code> в общем модуле <code>РаботаСПочтовымиСообщениями</code>.
<ul>
<li>Для обнаружения картинок письма, загружаемых из Интернета, предусмотрена функция <code>ЕстьВнешниеРесурсы</code> в общем модуле <code>РаботаСПочтовымиСообщениями</code>.</li>
</ul></li>
</ul>
<h4 id="шаблоны-сообщений-4">Шаблоны сообщений</h4>
<ul>
<li>Для отправки письма, сформированного по шаблону, от произвольной учетной записи электронной почты в функции <code>СформироватьСообщениеИОтправить</code> программного интерфейса общего модуля <code>ШаблоныСообщений</code> в четвертом параметре <code>ДополнительныеПараметры</code> предусмотрено свойство <code>УчетнаяЗапись</code>.</li>
</ul>
<h3 id="переход-на-версию-3.1.1-с-версии-3.0.3">Переход на версию 3.1.1 с версии 3.0.3</h3>
<p>Версия 3.1.1 предназначена для разработки на платформе <strong>1С:Предприятие</strong> версии 8.3.14 и выше с отключенным режимом совместимости с версией 8.3.14. Поэтому предварительно необходимо адаптировать конфигурацию согласно списку изменений и порядку обновления технологической платформы версий 8.3.13 и 8.3.14. Минимальные требования к адаптации описаны в <a href="https://its.1c.ru/db/metod8dev#content:5293:hdoc">методике перевода конфигураций на платформу 1С:Предприятие 8.3</a>.</p>
<p>В данной версии удалены объекты метаданных, которые были отмечены устаревшими более двух лет назад (в версии 2.3.3 и раньше), а также программный интерфейс, отмеченный устаревшим до версии 2.4.2.</p>
<p>Если ранее в конфигурации нерегулярно выполнялся переход с устаревшего программного интерфейса на актуальный, то перед обновлением следует найти и заменить все вызовы, указанные ниже в разделе <strong>Обязательные действия по переходу</strong>. Замены следует выполнять согласно инструкциям в документирующих комментариях к устаревшим процедурам и функциям. Для быстрого выявления нерекомендуемых вызовов устаревшего программного интерфейса также рекомендуется воспользоваться инструментом <strong>1С:Автоматизированная проверка конфигурации</strong> (<a href="https://v8.1c.ru/acc/">https://v8.1c.ru/acc/</a>).</p>
<h4 id="порядок-обновления-конфигураций-включающих-1cбиблиотека-технологии-сервиса">Порядок обновления конфигураций, включающих 1C:Библиотека технологии сервиса</h4>
<p>Если в конфигурации используется <strong>1С:Библиотека стандартных подсистем</strong> (БСП) совместно с <strong>1C:Библиотека технологии сервиса</strong> (БТС), то порядок перехода следующий: для перехода на версию 3.1.1 необходимо также взять БТС версии 1.2 и в конфигураторе выполнить 5 шагов.</p>
<ol type="1">
<li>Выполнить команду <strong>Конфигурация – Поддержка – Обновить конфигурацию</strong>, указав в варианте <strong>Выбор файла обновления</strong> путь к файлу поставки <strong>БСП</strong>. В открывшемся окне сравнения и объединения конфигураций перейти к параметрам с помощью команды <strong>Действия – Параметры</strong>, снять флажок <strong>Разрешить удаление основной конфигурации</strong> и нажать на кнопку <strong>ОК</strong>. В окне сравнения и объединения конфигураций снять все флажки и отметить переносимые объекты с помощью команды <strong>Действия – Отметить по подсистемам новой конфигурации поставщика</strong>. Из группы <strong>Стандартные подсистемы</strong> выбрать:</li>
</ol>
<ul>
<li><p>обязательные подсистемы согласно таблице 2.1 документации;</p></li>
<li><p>дополнительные подсистемы, обязательные к переносу в конфигурацию для работы в модели сервиса, согласно таблице 2.2 документации;</p></li>
<li><p>все ранее внедренные подсистемы, а также подсистемы, которые дополнительно требуется внедрить в вашу конфигурацию;</p></li>
<li><p>подсистемы, от которых зависят отмеченные выше подсистемы, согласно таблицам 2.1–2.3 документации (<a href="https://its.1c.ru/db/bspdoc">https://its.1c.ru/db/bspdoc</a>).</p>
<p>Далее нажать кнопку <strong>Установить</strong>.</p>
<p><strong>Важно!</strong></p>
<blockquote>
<p>Необходимо убедиться, что в список отмеченных подсистем включены все обязательные подсистемы из таблицы 2.1 документации (вместе с относящимися к ним объектами метаданных). Если предполагается работа конфигурации в модели сервиса, то обязательными также являются подсистемы из таблицы 2.2 документации. В противном случае конфигурация окажется неработоспособной. Если подсистема ‘Администрирование’ была внедрена ранее или планируется ее внедрение, то отметить ее флажком в окне сравнения и объединения конфигураций (объект метаданных «подсистема»).</p>
</blockquote>
<p>Выбрать режим объединения <strong>Взять из новой конфигурации поставщика</strong> (<strong>Действия – Установить режим для всех…</strong>). Дополнительно нужно установить или снять флажки для отдельных объектов библиотеки и их свойств согласно инструкциям в таблице 2.6 документации. В зависимости от числа обновляемых и дополнительно устанавливаемых подсистем этот шаг может занять от 15 минут до одного часа.</p></li>
</ul>
<ol start="2" type="1">
<li><p>Выполнить команду <strong>Конфигурация – Поддержка – Обновить конфигурацию</strong>, указав в варианте <strong>Выбор файла обновления</strong> путь к файлу поставки <strong>БТС</strong>. В открывшемся окне сравнения и объединения конфигураций перейти к параметрам с помощью команды <strong>Действия – Параметры</strong>, снять флажок <strong>Разрешить удаление основной конфигурации</strong> и нажать на кнопку <strong>ОК</strong>. В окне сравнения и объединения конфигураций снять все флажки и с помощью команды <strong>Действия – Отметить по подсистемам новой конфигурации поставщика</strong> отметить все объекты подсистемы ‘ТехнологияСервиса’. Далее нажать кнопку <strong>Установить</strong>.</p></li>
<li><p>Выполнить команду <strong>Конфигурация – Поддержка – Настройка поддержки</strong>. В открывшейся форме <strong>Настройка поддержки</strong> выбрать значение ‘БиблиотекаСтандартныхПодсистем’ в выпадающем списке <strong>Конфигурация поставщика</strong> и нажать на кнопку <strong>Сравнить, объединить</strong>. В открывшемся окне сравнения и объединения конфигураций перейти к параметрам с помощью команды <strong>Действия – Параметры</strong>, установить флажок <strong>Разрешить удаление основной конфигурации</strong> и нажать на кнопку <strong>ОК</strong>. В окне сравнения и объединения конфигураций снять все флажки и отметить все подсистемы, которые внедрены в конфигурацию и относятся к подсистеме ‘СтандартныеПодсистемы’. Далее нажать кнопку <strong>Выполнить</strong>.</p></li>
<li><p>Выполнить команду <strong>Конфигурация – Поддержка – Настройка поддержки</strong>. В открывшейся форме <strong>Настройка поддержки</strong> выбрать значение ‘БиблиотекаТехнологииСервиса’ в выпадающем списке <strong>Конфигурация поставщика</strong> и нажать на кнопку <strong>Сравнить, объединить</strong>. В открывшемся окне сравнения и объединения конфигураций перейти к параметрам с помощью команды <strong>Действия – Параметры</strong>, установить флажок <strong>Разрешить удаление основной конфигурации</strong> и нажать на кнопку <strong>ОК</strong>. В окне сравнения и объединения конфигураций снять все флажки и отметить подсистему ‘ТехнологияСервиса’. Далее нажать кнопку <strong>Выполнить</strong>.</p></li>
<li><p>В дереве конфигурации выполнить команду <strong>По подсистемам</strong>. В открывшемся окне <strong>Отбор по подсистемам</strong> снять все флажки в дереве подсистем, установить флажок напротив значения <strong><Не входящие в подсистемы></strong> и нажать кнопку <strong>Установить</strong>. Удалить из конфигурации все объекты метаданных, которые не входят ни в одну подсистему и не стоят на поддержке ни одной из библиотек.</p></li>
</ol>
<h4 id="обязательные-действия-по-переходу-6">Обязательные действия по переходу</h4>
<p>В этом разделе для каждой подсистемы даны дополнительные инструкции по переходу, которые необходимо выполнить в конфигураторе после завершения сравнения/объединения.</p>
<p>Для совместимости с предыдущими версиями библиотеки во всех подсистемах предусмотрен программный интерфейс. К нему относятся те объекты метаданных библиотеки, которые предназначены для использования в прикладном коде:</p>
<ul>
<li>имена и состав параметров экспортных процедур и функций общих модулей, модулей объектов, менеджеров, наборов записей и т.п., которые размещены в области ‘ПрограммныйИнтерфейс’;</li>
<li>имена и состав параметров всех экспортных процедур и функций переопределяемых общих модулей;</li>
<li>имена объектов метаданных (включая их реквизиты, табличные части и пр.), к которым допускается непосредственное обращение из прикладного кода или из запросов.</li>
</ul>
<p>В случае использования программного интерфейса существенно снижается необходимость в переработках кода конфигурации при обновлении на новые версии библиотеки.</p>
<p>По каждой подсистеме приведены дополнительные инструкции, когда такая совместимость в силу исключительных причин не поддерживается, и требуется адаптировать конфигурацию к новому программному интерфейсу библиотеки. При этом не документируются изменения в служебных процедурах и функциях библиотеки (даже если они являются экспортными), которые не относятся к программному интерфейсу. При непосредственном вызове их из конфигурации следует учитывать, что они могут быть изменены, перемещены или удалены в следующей версии библиотеки, поскольку являются ее внутренней реализацией.</p>
<p>После выполнения инструкций по переходу рекомендуется воспользоваться инструментом <strong>Проверка внедрения БСП</strong>, входящим в состав дистрибутива библиотеки в виде внешнего отчета ‘ПроверкаВнедренияБСП.erf’. В этой версии состав проверок был дополнительно расширен, чтобы выявлять больше типовых проблем внедрения.</p>
<h5 id="адресный-классификатор-1">Адресный классификатор</h5>
<ul>
<li>Удален устаревший программный интерфейс общих модулей:
<ul>
<li><code>АдресныйКлассификатор</code>:
<ul>
<li><code>КлассификаторЗагружен</code>.</li>
</ul></li>
<li><code>АдресныйКлассификаторКлиент</code>:
<ul>
<li><code>ОткрытьФормуПроверкиОбновления</code>;</li>
<li><code>ОткрытьФормуЗагрузкиАдресногоКлассификатора</code>.</li>
</ul></li>
</ul></li>
</ul>
<h5 id="базовая-функциональность-27">Базовая функциональность</h5>
<ul>
<li>Удален устаревший программный интерфейс общих модулей:
<ul>
<li><code>ОбщегоНазначения</code>:
<ul>
<li><code>ПолучитьКартинкуКомментария</code>;</li>
<li><code>ЗаполнитьМассивУникальнымиЗначениями</code>;</li>
<li><code>Просклонять</code>;</li>
<li><code>WSПрокси</code>;</li>
<li><code>ПолучитьТаблицуОписанияСвойствОбъекта</code>;</li>
<li><code>ПолучитьОбщийСписокИсключенийПоискаСсылок</code>;</li>
<li><code>СкопироватьXDTO</code>;</li>
<li><code>ПредставлениеТипаXDTO</code>;</li>
<li><code>ХранилищеОбщихНастроекСохранитьМассивИОбновитьПовторноИспользуемыеЗначения</code>;</li>
<li><code>ХранилищеОбщихНастроекСохранитьИОбновитьПовторноИспользуемыеЗначения</code>;</li>
<li><code>ЗаблокироватьИБ</code>;</li>
<li><code>РазблокироватьИБ</code>;</li>
<li><code>ИмяТипаРегистрыСведений</code>;</li>
<li><code>ИмяТипаРегистрыНакопления</code>;</li>
<li><code>ИмяТипаРегистрыБухгалтерии</code>;</li>
<li><code>ИмяТипаРегистрыРасчета</code>;</li>
<li><code>ИмяТипаДокументы</code>;</li>
<li><code>ИмяТипаСправочники</code>;</li>
<li><code>ИмяТипаПеречисления</code>;</li>
<li><code>ИмяТипаОтчеты</code>;</li>
<li><code>ИмяТипаОбработки</code>;</li>
<li><code>ИмяТипаПланыОбмена</code>;</li>
<li><code>ИмяТипаПланыВидовХарактеристик</code>;</li>
<li><code>ИмяТипаБизнесПроцессы</code>;</li>
<li><code>ИмяТипаЗадачи</code>;</li>
<li><code>ИмяТипаПланыСчетов</code>;</li>
<li><code>ИмяТипаПланыВидовРасчета</code>;</li>
<li><code>ИмяТипаКонстанты</code>;</li>
<li><code>ИмяТипаЖурналыДокументов</code>;</li>
<li><code>ИмяТипаПоследовательности</code>;</li>
<li><code>ИмяТипаРегламентныеЗадания</code>;</li>
<li><code>ИмяТипаПерерасчеты</code>;</li>
<li><code>УстановитьРазделениеСеанса</code>;</li>
<li><code>ЗначениеРазделителяСеанса</code>;</li>
<li><code>УстановитьПараметрыРазделенияИнформационнойБазы</code>;</li>
<li><code>ЗаписатьВспомогательныеДанные</code>;</li>
<li><code>УдалитьВспомогательныеДанные</code>;</li>
<li><code>ЭтоРазделенныйОбъектМетаданных</code>.</li>
</ul></li>
<li><code>ОбщегоНазначенияВызовСервера</code>:
<ul>
<li><code>ХранилищеОбщихНастроекСохранитьМассивИОбновитьПовторноИспользуемыеЗначения</code>;</li>
<li><code>ХранилищеОбщихНастроекСохранитьИОбновитьПовторноИспользуемыеЗначения</code>;</li>
<li><code>УстановитьРазделениеСеанса</code>.</li>
</ul></li>
<li><code>ОбщегоНазначенияПереопределяемый</code>:
<ul>
<li><code>ПараметрыРаботыКлиентаПриЗапуске</code>;</li>
<li><code>ПараметрыРаботыКлиента</code>.</li>
</ul></li>
<li><code>ОбщегоНазначенияПовтИсп</code>:
<ul>
<li><code>ЭтоРазделеннаяКонфигурация</code>;</li>
<li><code>РазделителиКонфигурации</code>;</li>
<li><code>СоставОбщегоРеквизита</code>;</li>
<li><code>ЭтоРазделенныйОбъектМетаданных</code>;</li>
<li><code>РазделительОсновныхДанных</code>;</li>
<li><code>РазделительВспомогательныхДанных</code>;</li>
<li><code>РазделениеВключено</code>;</li>
<li><code>ДоступноИспользованиеРазделенныхДанных</code>;</li>
<li><code>ПолучитьПреобразованиеXSLИзОбщегоМакета</code>;</li>
<li><code>СеансЗапущенБезРазделителей</code>;</li>
<li><code>РежимРаботыПрограммы</code>.</li>
</ul></li>
<li><code>СтандартныеПодсистемыСервер</code>:
<ul>
<li><code>ЭтоОбъектНачальногоОбразаУзлаРИБ</code>;</li>
<li><code>ПроверитьСоставПланаОбмена</code>.</li>
</ul></li>
<li><code>СтроковыеФункцииКлиентСервер</code>:
<ul>
<li><code>СтрокаИзМассиваПодстрок</code>;</li>
<li><code>НайтиСимволСКонца</code>;</li>
<li><code>ПолучитьПараметрыИзСтроки</code>.</li>
</ul></li>
</ul></li>
</ul>
<!--Локализация-->
<h5 id="банки-1">Банки</h5>
<ul>
<li>Загрузка классификатора банков выполняется средствами библиотеки Интернет-поддержки пользователей (раздел <code>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</code>).
<ul>
<li>Если она отсутствует в конфигурации, рекомендуется запланировать ее внедрение.</li>
<li>Для возможности получения обновлений классификаторов предусмотрена отдельная роль <code>ПолучениеОбновленийКлассификаторов</code> в <code>Библиотеке интернет-поддержки пользователей</code>. Роль <code>ДобавлениеИзменениеБанков</code> не предоставляет доступ к обновлению классификатора банков. Необходимо учесть это изменение в имеющихся профилях групп доступа. Рекомендуется включить роль <code>ПолучениеОбновленийКлассификаторов</code> в профили, имеющие роль <code>ДобавлениеИзменениеБанков</code>.</li>
</ul></li>
<li>Удалена устаревшая функция <code>ПолучитьДанныеКлассификатораРФ</code> общего модуля <code>РаботаСБанками</code>.</li>
<li>При наличии в конфигурации <code>Библиотеки интернет-поддержки пользователей</code> необходимо удалить ранее выполненные вставки кода подсистемы <code>Банки</code> из процедур <code>ПриСохраненииДанныхАутентификацииПользователяИнтернетПоддержки</code> и <code>ПриУдаленииДанныхАутентификацииПользователяИнтернетПоддержки</code> общего модуля <code>ИнтернетПоддержкаПользователейПереопределяемый</code>. <!--Конец локализация--></li>
</ul>
<h5 id="бизнес-процессы-и-задачи-2">Бизнес-процессы и задачи</h5>
<ul>
<li>Удален устаревший программный интерфейс общего модуля <code>БизнесПроцессыИЗадачиВызовСервера</code>:
<ul>
<li><code>УведомитьИсполнителейОНовыхЗадачах</code>;</li>
<li><code>ПроконтролироватьЗадачи</code>.</li>
</ul></li>
</ul>
<h5 id="валюты-3">Валюты</h5>
<ul>
<li>Удалена устаревшая функция <code>ПересчитатьИзВалютыВВалюту</code> общего модуля <code>РаботаСКурсамиВалютКлиентСервер</code>. <!--Локализация-->- При наличии в конфигурации <code>Библиотеки интернет-поддержки пользователей</code> необходимо удалить ранее выполненные вставки кода подсистемы <code>Валюты</code> из процедур <code>ПриСохраненииДанныхАутентификацииПользователяИнтернетПоддержки</code> и <code>ПриУдаленииДанныхАутентификацииПользователяИнтернетПоддержки</code> общего модуля <code>ИнтернетПоддержкаПользователейПереопределяемый</code>.<!--Конец локализация--></li>
</ul>
<h5 id="варианты-отчетов-14">Варианты отчетов</h5>
<ul>
<li>Удален устаревший программный интерфейс общего модуля <code>ВариантыОтчетов</code>:
<ul>
<li><code>ИспользуемыеРазделы</code>;</li>
<li><code>ДобавитьОбработчикиПолногоОбновления</code>;</li>
<li><code>ПолучитьСсылку</code>.</li>
</ul></li>
</ul>
<h5 id="взаимодействия-5">Взаимодействия</h5>
<ul>
<li>Удалена устаревшая процедура <code>ОткрытьФормуОтправкиПочтовогоСообщения</code> общего модуля <code>ВзаимодействияКлиент</code>.</li>
</ul>
<h5 id="дополнительные-отчеты-и-обработки-1">Дополнительные отчеты и обработки</h5>
<ul>
<li>Удален устаревший программный интерфейс общих модулей:
<ul>
<li><code>ДополнительныеОтчетыИОбработки</code>:
<ul>
<li><code>ПолучитьОбъектВнешнейОбработки</code>;</li>
<li><code>ПриСозданииНаСервере</code>;</li>
<li><code>ВыполнитьНазначаемуюКомандуНаСервере</code>.</li>
</ul></li>
<li><code>ДополнительныеОтчетыИОбработкиВызовСервера</code>:
<ul>
<li><code>ПолучитьОбъектВнешнейОбработки</code>.</li>
</ul></li>
<li><code>ДополнительныеОтчетыИОбработкиКлиент</code>:
<ul>
<li><code>ПоказатьРезультатВыполненияКоманды</code>;</li>
<li><code>ВыполнитьНазначаемуюКомандуНаКлиенте</code>.</li>
</ul></li>
<li><code>ДополнительныеОтчетыИОбработкиКлиентСервер</code>:
<ul>
<li><code>ТипКомандыСценарийВБезопасномРежиме</code>.</li>
</ul></li>
</ul></li>
<li>Удалены общие модули, содержавшие устаревший программный интерфейс:
<ul>
<li><code>ДополнительныеОтчетыИОбработкиВБезопасномРежимеИнтерфейс</code>;</li>
<li><code>ДополнительныеОтчетыИОбработкиРегламентныеЗадания</code>.</li>
</ul></li>
</ul>
<h5 id="защита-персональных-данных">Защита персональных данных</h5>
<ul>
<li>Удалена устаревшая функция <code>ПолучитьИспользованиеСобытияДоступ</code> общего модуля <code>ЗащитаПерсональныхДанных</code>.</li>
</ul>
<h5 id="контактная-информация-9">Контактная информация</h5>
<ul>
<li>Удален устаревший программный интерфейс общего модуля <code>УправлениеКонтактнойИнформацией</code>:
<ul>
<li><code>ЗначенияКонтактнойИнформацииОбъекта</code>;</li>
<li><code>ТаблицаКонтактнойИнформацииОбъекта</code>;</li>
<li><code>ЗаполнитьКонтактнуюИнформациюОбъектов</code>;</li>
<li><code>ЗаполнитьКонтактнуюИнформациюОбъекта</code>;</li>
<li><code>ПредыдущийФорматКонтактнойИнформацииXML</code>;</li>
<li><code>ПредыдущаяСтруктураКонтактнойИнформацииXML</code>;</li>
<li><code>АдресВФорматеКЛАДР</code>;</li>
<li><code>СведенияОбАдресах</code>;</li>
<li><code>СведенияОбАдресе</code>;</li>
<li><code>РегионАдресаКонтактнойИнформации</code>;</li>
<li><code>ГородАдресаКонтактнойИнформации</code>;</li>
<li><code>ПроверитьАдрес</code>;</li>
<li><code>ПараметрыКонтактнойИнформацией</code>.</li>
</ul></li>
<li>В связи с изменением поведения платформы <code>1С:Предприятие</code> версии 8.3.13 в модулях форм c внедренной контактной информацией у ранее размещенных процедур <code>Подключаемый_ОбновитьКонтактнуюИнформацию</code> необходимо добавить ключевое слово <code>Экспорт</code>:
<ul>
<li><p>Было:</p>
<pre class="1c"><code>Процедура Подключаемый_ОбновитьКонтактнуюИнформацию(Результат)</code></pre></li>
<li><p>Стало:</p>
<pre class="1c"><code>Процедура Подключаемый_ОбновитьКонтактнуюИнформацию(Результат) Экспорт</code></pre>
<h5 id="календарные-графики-5">Календарные графики</h5></li>
</ul></li>
<li>Удален устаревший программный интерфейс общего модуля <code>КалендарныеГрафики</code>:
<ul>
<li><code>ПолучитьМассивДатПоКалендарю</code>;</li>
<li><code>ПолучитьДатуПоКалендарю</code>;</li>
<li><code>ПолучитьРазностьДатПоКалендарю</code>;</li>
<li><code>ПроизводственныйКалендарьРоссийскойФедерации</code>;</li>
<li><code>ПолучитьДатыРабочихДней</code>.</li>
</ul></li>
<li>При наличии в конфигурации <code>Библиотеки технологии сервиса</code> необходимо удалить ранее выполненные вставки кода подсистемы <code>Календарные графики</code> из процедуры <code>ПриОбработкеОбластиДанных</code> общего модуля <code>РаботаСКлассификаторамиВМоделиСервисаПереопределяемый</code>.</li>
</ul>
<h5 id="напоминания-пользователя-2">Напоминания пользователя</h5>
<ul>
<li>Удален общий модуль <code>НапоминанияПользователяКлиентСерверПереопределяемый</code>, содержавший устаревший программный интерфейс.</li>
</ul>
<h5 id="обмен-данными-в-модели-сервиса">Обмен данными в модели сервиса</h5>
<ul>
<li>В состав определяемого типа <code>КонечнаяТочкаОбменаСообщениями</code> необходимо включить план обмена <code>ОбменСообщениями</code> из Библиотеки технологии сервиса, и исключить все другие типы.</li>
</ul>
<h5 id="обновление-версии-иб-15">Обновление версии ИБ</h5>
<ul>
<li>Удалена устаревшая процедура <code>ПриОтключенииОбработчиковОбновления</code> общего модуля <code>ОбновлениеИнформационнойБазыПереопределяемый</code>.</li>
</ul>
<h5 id="печать-11">Печать</h5>
<ul>
<li>Удален устаревший программный интерфейс общих модулей:
<ul>
<li><code>УправлениеПечатью</code>:
<ul>
<li><code>ПолучитьЛокальныйКаталогФайловПечати</code>;</li>
<li><code>ПриСозданииНаСервере</code>.</li>
</ul></li>
<li><code>УправлениеПечатьюКлиент</code>:
<ul>
<li><code>ВыполнитьПодключаемуюКомандуПечати</code>;</li>
<li><code>НачатьОбновлениеКоманд</code>.</li>
</ul></li>
<li><code>УправлениеПечатьюКлиентСервер</code>:
<ul>
<li><code>ОбновитьКоманды</code>.</li>
</ul></li>
</ul></li>
</ul>
<h5 id="подключаемые-команды-4">Подключаемые команды</h5>
<p>В связи с изменением поведения платформы <code>1C:Предприятие</code> 8.3.13, у ранее размещенных в модулях форм процедур <code>Подключаемый_ВыполнитьКомандуНаСервере</code> необходимо добавить ключевое слово <code>Экспорт</code>:</p>
<ul>
<li><p>Было: <code>1C     Процедура Подключаемый_ВыполнитьКомандуНаСервере(Контекст, Результат)</code></p></li>
<li><p>Стало: <code>1C     Процедура Подключаемый_ВыполнитьКомандуНаСервере(Контекст, Результат) Экспорт</code> ##### Пользователи</p></li>
<li><p>Удален устаревший программный интерфейс общего модуля <code>Пользователи</code>:</p>
<ul>
<li><code>ПрочитатьПользователяИБ</code>;</li>
<li><code>ЗаписатьПользователяИБ</code>;</li>
<li><code>РольАдминистратораСистемы</code>.</li>
</ul></li>
</ul>
<h5 id="префиксация-объектов">Префиксация объектов</h5>
<ul>
<li>Удален устаревший программный интерфейс общего модуля <code>ПрефиксацияОбъектовКлиентСервер</code>:
<ul>
<li><code>ПолучитьПользовательскийПрефикс</code>;</li>
<li><code>ПолучитьНомерНаПечать</code>.</li>
</ul></li>
</ul>
<h5 id="профили-безопасности">Профили безопасности</h5>
<ul>
<li>Удален устаревший программный интерфейс общего модуля <code>РаботаВБезопасномРежиме</code>:
<ul>
<li><code>ВыполнитьМетодКонфигурации</code>;</li>
<li><code>ВыполнитьМетодОбъекта</code>;</li>
<li><code>ВыполнитьВБезопасномРежиме</code>;</li>
<li><code>ВычислитьВБезопасномРежиме</code>.</li>
</ul></li>
</ul>
<h5 id="работа-с-файлами-11">Работа с файлами</h5>
<ul>
<li>Удалены общие модули, содержавшие устаревший программный интерфейс:
<ul>
<li><code>ПрисоединенныеФайлы</code>;</li>
<li><code>ПрисоединенныеФайлыКлиент</code>;</li>
<li><code>ПрисоединенныеФайлыКлиентСервер</code>;</li>
<li><code>ФайловыеФункции</code>.</li>
</ul></li>
</ul>
<h5 id="склонение-представлений-объектов">Склонение представлений объектов</h5>
<ul>
<li>Процедура <code>ПриИзмененииПредставления</code> общего модуля <code>СклонениеПредставленийОбъектовКлиент</code> более не поддерживается. В модулях форм объектов склонений, где она вызывается, необходимо:
<ul>
<li>заменить ее вызов вызовом процедуры <code>ПросклонятьПредставление</code> общего модуля <code>СклонениеПредставленийОбъектовКлиент</code>,</li>
<li>удалить процедуру <code>Подключаемый_ПросклонятьПредставлениеПоВсемПадежам</code>.</li>
</ul></li>
</ul>
<h5 id="физические-лица">Физические лица</h5>
<ul>
<li>Удален программный интерфейс общего модуля <code>ФизическиеЛицаКлиентСервер</code>:
<ul>
<li><code>ФамилияИмяОтчество</code>;</li>
<li><code>ФамилияИнициалыФизЛица</code>.</li>
</ul></li>
</ul>
<h5 id="управление-доступом-13">Управление доступом</h5>
<ul>
<li>Обновить стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code> во всех ролях. Стандартные шаблоны взять из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Для массового обновления удобно использовать вкладку <code>Шаблоны ограничений</code> в форме <code>Все ограничения доступа</code> (включить отбор по наименованию шаблона, выделить все строки и использовать команду <code>Изменить</code>), либо использовать отчет <code>ПроверкаВнедренияБСП.erf</code> в режиме исправления ошибок.</li>
</ul>
<h4 id="необязательные-действия-по-переходу-6">Необязательные действия по переходу</h4>
<p>Действия, указанные далее, не являются обязательными для перехода, но рекомендуются запланировать их отработку в будущем.</p>
<h5 id="базовая-функциональность-28">Базовая функциональность</h5>
<ul>
<li>Процедуры <code>ЭтоOSXКлиент</code> общих модулей <code>ОбщегоНазначения</code> и <code>ОбщегоНазначенияКлиент</code> устарели, вместо них рекомендуется использовать <code>ЭтоMacOSКлиент</code> этих же общих модулей. Рекомендуется пересмотреть места вызовов этой процедуры.</li>
</ul>
<h5 id="валюты-4">Валюты</h5>
<ul>
<li>Предусмотрено оперативное обновление классификатора валют через Интернет. Возможность предоставляется при наличии в конфигурации библиотеки Интернет-поддержки пользователей (раздел <code>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</code>). Если она отсутствует в конфигурации, рекомендуется запланировать ее внедрение.</li>
</ul>
<h5 id="контактная-информация-10">Контактная информация</h5>
<ul>
<li>Предусмотрено оперативное обновление классификатора стран мира через Интернет. Возможность предоставляется при наличии в конфигурации библиотеки Интернет-поддержки пользователей (раздел <code>Администрирование – Интернет-поддержка и сервисы – Классификаторы и курсы валют – Обновление классификаторов</code>). Если она отсутствует в конфигурации, рекомендуется запланировать ее внедрение.</li>
</ul>
<h5 id="настройки-программы-1">Настройки программы</h5>
<ul>
<li>Рекомендуется перенести в конфигурацию код модулей форм всех панелей администрирования, объединив его с собственными изменениями этих форм.</li>
</ul>
<h5 id="склонение-представлений-объектов-1">Склонение представлений объектов</h5>
<ul>
<li>Процедура <code>ПриЗаписиНаСервере</code> общего модуля <code>СклонениеПредставленийОбъектов</code> устарела, вместо нее рекомендуется использовать <code>ПриЗаписиФормыОбъектаСклонения</code> этого же общего модуля. Рекомендуется пересмотреть места вызовов этой процедуры.</li>
<li>Процедура <code>ПросклонятьФИОСПомощьюКомпоненты</code> общего модуля <code>СклонениеПредставленийОбъектов</code> устарела, вместо нее рекомендуется использовать <code>ПросклонятьФИО</code> этого же общего модуля. Рекомендуется пересмотреть места вызовов этой процедуры.</li>
<li>Процедура <code>ПросклонятьПредставлениеПоВсемПадежам</code> общего модуля <code>СклонениеПредставленийОбъектовКлиент</code> устарела, вместо нее рекомендуется использовать <code>ПросклонятьПредставление</code> этого же общего модуля. Рекомендуется пересмотреть места вызовов этой процедуры.</li>
<li>Процедура <code>ОбработатьКомандуСклонения</code> общего модуля <code>СклонениеПредставленийОбъектовКлиент</code> устарела, вместо нее рекомендуется использовать <code>ПоказатьСклонение</code> этого же общего модуля. Рекомендуется пересмотреть места вызовов этой процедуры.</li>
</ul>
<h5 id="управление-доступом-14">Управление доступом</h5>
<ul>
<li>Упрощен программный интерфейс процедуры <code>ПриСозданииФормыЗначенияДоступа</code> общего модуля <code>УправлениеДоступом</code>.
<ul>
<li>Теперь вместо пяти параметров используется только два, где второй параметр это структура, содержащая редко используемые параметры.</li>
<li>Параметры <code>Реквизит</code>, <code>Элементы</code>, <code>ТипЗначения</code>, <code>СозданиеНового</code> отмечены как устаревшие и оставлены для обратной совместимости. Вместо них следует использовать структуру <code>ДополнительныеПараметры</code> передаваемую вторым параметром. Следует проверить все места использования.</li>
<li>Для параметра <code>ДополнительныеПараметры</code> предусмотрена функция-конструктор <code>ПараметрыПриСозданииФормыЗначенияДоступа</code> в общем модуле <code>УправлениеДоступом</code>.</li>
</ul></li>
<li>Рекомендуется добавлять в справочник <code>ИдентификаторыОбъектовМетаданных</code> предопределенные элементы всех регистров, чтобы при изменении ограничений доступа в модулях менеджеров не требовалось добавления предопределенных элементов при доработке конфигурации на внедрении, а также использовании расширений конфигурации.<br />
Отчет <code>ПроверкаВнедренияБСП.epf</code> в режиме исправления теперь добавляет в справочник <code>ИдентификаторыОбъектовМетаданных</code> предопределенные элементы всех регистров. Рекомендуется выполнить запуск отчета в режиме исправления.</li>
</ul>
<h3 id="переход-на-исправительные-релизы-3.1.1">Переход на исправительные релизы 3.1.1</h3>
<p>Исправительные релизы библиотеки отличаются только четвертой цифрой в полном номере версии, например: 3.1.1.<code>1</code>, 3.1.1.<code>20</code>, 3.1.1.<code>300</code> и т.п. Для обновления на исправительные релизы предназначена внешняя обработка <code>ОбновлениеНаИсправительнуюВерсиюБСП.epf</code> из комплекта поставки, которая позволяет существенно сэкономить время при регулярных обновлениях (например, еженедельных).</p>
<p>Необходимо запустить обработку в информационной базе с конфигурацией, содержащей предыдущий релиз библиотеки, указать cf-файл поставки новой версии библиотек и нажать на кнопку <code>Обновить на исправительную версию</code>. При этом выполняется автоматическое сравнение/объединение с новой конфигурацией библиотеки согласно настройкам, которые соответствуют документации: будут перенесены все поставляемые объекты библиотеки, а переопределяемые при внедрении – объединены с приоритетом конфигурации поставщика (например, определяемые типы) или пропущены (как например, переопределяемые модули). После сравнения/объединения конфигурация базы данных не будет обновлена автоматически, что позволяет выполнить сравнение с конфигурацией базы данных и внести правки в измененные объекты: переопределяемые модули, различные локальные исправления и доработки.</p>
<p>Кроме того, в качестве альтернативного варианта, по кнопке <code>Сформировать файл настроек</code> предусмотрена возможность сформировать файл настроек сравнения/объединения, который затем можно загрузить в конфигураторе для ручного сравнения/объединения.</p>
<p>После завершения сравнения/объединения настоятельно рекомендуется также воспользоваться инструментом <code>Проверка внедрения БСП</code>, входящим в состав дистрибутива библиотеки в виде внешнего отчета <code>ПроверкаВнедренияБСП.erf</code>.</p>
<h4 id="с-версии-3.1.1.99-и-меньше">С версии 3.1.1.99 и меньше</h4>
<h5 id="управление-доступом-15">Управление доступом</h5>
<ul>
<li>Улучшены стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code>. Требуется взять их из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Для массового обновления удобно использовать вкладку <code>Шаблоны ограничений</code> в форме <code>Все ограничения доступа</code> (включить отбор по наименованию шаблона, выделить все строки и использовать команду <code>Изменить</code>). Либо использовать отчет <code>ПроверкаВнедренияБСП.epf</code> в режиме исправления ошибок.</li>
</ul>
<h4 id="с-версии-3.1.1.120-и-меньше">С версии 3.1.1.120 и меньше</h4>
<h5 id="управление-доступом-16">Управление доступом</h5>
<ul>
<li>Для объектов метаданных, указанных в процедуре <code>ПриЗаполненииСписковСОграничениемДоступа</code> общего модуля <code>УправлениеДоступомПереопределяемый</code>, в обработчик события <code>ПослеЗаписиНаСервере</code> формы объекта (все формы с основным реквизитом объекта) сделать вставку:</li>
</ul>
<pre class="1c"><code>// СтандартныеПодсистемы.УправлениеДоступом  
УправлениеДоступом.ПослеЗаписиНаСервере(ЭтотОбъект, ТекущийОбъект, ПараметрыЗаписи);  
// Конец СтандартныеПодсистемы.УправлениеДоступом </code></pre>
<ul>
<li>Для автоматизированного выполнения указанного выше действия следует запустить обработку <code>ПереходНаВерсию303.epf</code>, входящую в состав дистрибутива (запускать только на файловой ИБ).</li>
<li>Обновить стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code> во всех ролях. Стандартные шаблоны взять из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Для массового обновления удобно использовать вкладку <code>Шаблоны ограничений</code> в форме <code>Все ограничения доступа</code> (включить отбор по наименованию шаблона, выделить все строки и использовать команду <code>Изменить</code>), либо использовать отчет <code>ПроверкаВнедренияБСП.erf</code> в режиме исправления ошибок.</li>
<li>Перенести изменения в коде формы <code>НастройкиПользователейИПрав</code> обработки <code>ПанельАдминистрированияБСП</code>, если используется.</li>
<li>В планы обмена РИБ включить константу <code>ПервоеОбновлениеДоступаЗавершилось</code> только для создания начального узла (то есть не включать в подписки регистрации изменений).</li>
</ul>
<h4 id="с-версии-3.1.1.136-и-меньше">С версии 3.1.1.136 и меньше</h4>
<h5 id="управление-доступом-17">Управление доступом</h5>
<ul>
<li>Исправлены стандартные шаблоны ограничения доступа к данным <code>ДляОбъекта</code> и <code>ДляРегистра</code> для работы на версии платформы 8.3.15. Требуется взять их из роли <code>ИзменениеУчастниковГруппДоступа</code> и скопировать во все роли. Для массового обновления удобно использовать вкладку <code>Шаблоны ограничений</code> в форме <code>Все ограничения доступа</code> (включить отбор по наименованию шаблона, выделить все строки и использовать команду <code>Изменить</code>). Либо использовать отчет <code>ПроверкаВнедренияБСП.epf</code> в режиме исправления ошибок.</li>
</ul>
<h4 id="с-версии-3.1.1.151-и-меньше">С версии 3.1.1.151 и меньше</h4>
<h5 id="управление-доступом-18">Управление доступом</h5>
<ul>
<li>Перенести изменения формы <code>НастройкиПользователейИПрав</code> обработки <code>ПанельАдминистрированияБСП</code>, если используется.</li>
</ul>
<h3 id="особенности-обновления-с-ранних-версий-на-версию-3.1.1">Особенности обновления с ранних версий на версию 3.1.1</h3>
<h4 id="ограничение-обновления-с-версий-меньше-2.3.3">Ограничение обновления с версий меньше 2.3.3</h4>
<p>Обновление на версию 3.1.1 допустимо с версии 2.3.3 и больше. Если в конфигурацию встроена более старая версия библиотеки, то разработчику необходимо запретить прямой переход на новую версию конфигурации (на базе версии 3.1.1 библиотеки) и организовать его через промежуточную версию с обязательным запуском для выполнения обработчиков обновления (включая отложенные).</p>
<p>Например, в конфигурации версии 1.1.1 и больше используется версия БСП 2.3.3, а в новую версию 1.2.1 встраивается версия БСП 3.1.1, тогда:</p>
<ol type="1">
<li>Если релизы конфигурации публикуются на портале <code>1С:Обновление программ</code> (<a href="https://releases.1c.ru/">https://releases.1c.ru</a>), то при публикации новой версии 1.2.1 в свойстве <code>Минимальная версия для запуска обработчиков</code> указать тот номер версии, в которой используется БСП 2.3.3 (в данном примере – 1.1.1). Тогда при обновлении конфигурации в режиме предприятия автоматически будет выполнен требуемый обязательный запуск.</li>
<li>Дополнительно для случаев, когда обновление выполняется через конфигуратор, в целях предотвращения некорректной ситуации также следует предусмотреть вывод предупреждения в процедуре <code>ПриОпределенииВозможностиОбновления</code> общего модуля <code>ОбновлениеИнформационнойБазыКлиентПереопределяемый</code>:</li>
</ol>
<pre class="1c"><code>Процедура ПриОпределенииВозможностиОбновления(Знач ВерсияДанных) Экспорт
    
    ДопустимаяВерсия = &quot;1.1.1&quot;;
    
    ВерсияДанныхБезНомераСборки = ОбщегоНазначенияКлиентСервер.ВерсияКонфигурацииБезНомераСборки(ВерсияДанных);
    Результат = ОбщегоНазначенияКлиентСервер.СравнитьВерсииБезНомераСборки(ВерсияДанныхБезНомераСборки, ДопустимаяВерсия);
    Если ВерсияДанных &lt;&gt; &quot;0.0.0.0&quot; И Результат &lt; 0 Тогда
        Сообщение = НСтр(&quot;ru = &#39;Недопустимая попытка обновления с версии %2. 
            |Обновление допустимо только с версии %1 и выше.
            |Необходимо восстановить информационную базу из резервной копии
            |и повторить обновление согласно файлу 1cv8upd.htm&#39;&quot;);
        Сообщение = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(Сообщение, ДопустимаяВерсия, ВерсияДанных);
        ВызватьИсключение Сообщение;
    КонецЕсли;
    
КонецПроцедуры</code></pre>
<h4 id="порядок-обновления-с-версий-2.3.3-3.0.1">Порядок обновления с версий 2.3.3 – 3.0.1</h4>
<p>При обновлении с ранних версий библиотеки (до 3.0.1) следует:</p>
<ul>
<li>выполнить в конфигураторе сравнение/объединение с файлов поставки последней версии библиотеки (на которую выполняется переход);</li>
<li>и затем последовательно выполнить инструкции из всех разделов <code>Переход с предыдущих версий</code> для каждой пропущенной версии.</li>
</ul>
<p>Например, если выполняется обновление с версии 3.0.1.1 сразу на версию 3.1.1.123, то следует последовательно выполнить инструкции всех разделов:</p>
<ul>
<li>Переход на версию 3.0.1 с предыдущих версий 3.0.1;</li>
<li>Переход на версию 3.0.2 с версии 3.0.1;</li>
<li>Переход на версию 3.1.1 с версии 3.0.2.</li>
</ul>
</body>
</html>